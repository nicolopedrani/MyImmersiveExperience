(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const A=[[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,5,0,0,0,0,0,0],[0,0,0,0,0,2,0,0,0,0,0,0],[0,0,0,0,0,2,0,0,0,0,0,0],[0,3,2,2,2,2,2,2,2,4,0,0],[0,0,0,0,0,2,0,0,0,0,0,0],[0,0,0,0,0,2,0,0,0,0,0,0],[0,0,0,0,0,2,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0]],U=A[0].length,L=A.length,i={down_idle:[],down_walk:[],up_idle:[],up_walk:[],left_idle:[],left_walk:[],right_idle:[],right_walk:[]},r={x:Math.floor(U/2),y:L-2,direction:"down",animationState:"idle",currentAnimation:[],frameIndex:0,animationTimer:0,animationSpeed:.15};r.currentAnimation=i.down_idle;function _(e){r.animationTimer+=e,r.animationTimer>=r.animationSpeed&&(r.animationTimer=0,r.frameIndex=(r.frameIndex+1)%r.currentAnimation.length)}function S(e,o){const t=r.currentAnimation[r.frameIndex];if(!t)return;const a=r.x*o,n=r.y*o;if(e.save(),r.direction==="left"){const s=t.width;e.translate(a,n),e.scale(-1,1),e.drawImage(t,-s,0)}else e.drawImage(t,a,n);e.restore()}const F="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAB1JREFUOI1jtOv0+M9AAWCiRPOoAaMGjBowmAwAAJhEAi4/QQzBAAAAAElFTkSuQmCC",Q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAB1JREFUOI1jfLKs6D8DBYCJEs2jBowaMGrAYDIAAFnyAxuTOlahAAAAAElFTkSuQmCC",I="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABQCAYAAACpv3NFAAAAAXNSR0IArs4c6QAABZFJREFUeJztW09PG0cU/zk1ogZFvbBFCjgXDgYipAYJRzKHXCLlGkeIT9EvkAMnH/oJ+iUsFM6VcokESBipiYRi44MPjUGVte6BVmDRWNCDmeXteHa9M/Nm6WF/Esrszuzse7/3Z97MOkCGDBkyZMiQIUOGdFFY8G4LC97tQ8uRczEpVWxw7ufE9eDcz4n+1Z0yAKBZa4COdSFPHPKckwlFhXIA0Kw1qLJj/fS6WWvcqghzCbYXCKs2aw1U6xUAQPtkCGBkZVnp0lo+NKa0lkf7ZBga26w1nJPwiGMS6vKrO2XsbR8CuFeyWq8EbXpfvlYR5TpXWLNbWPBuq/VKyHqyggLtk2Fkn2rM3vZh4E1724dOvIGNANcQXgXw5garEEh7GVvdKWN1p8z6XmMCRNITMd8+GQYJzQXk0OLKDSxJUE5y3FDlDi5vsCJAFDF0KXMBOq9YZrneZUQAdX9ayQFwGgrtkyG4E65RNqWlrAouw4GCY2UwXk4oCbSqS0t5OexM6wSrEKACuFwBVOB6rzYBctaVY56biLj5qPVNoeUy8jaWrs3U/blCIek8dNOlGwbGyyBdimRBOfNAlAdweZp20lDFPxcEkSrl6LtU/aZbZy0PUMV/EiQdR5WXyRW5hs5Ft9Gmy6B2CFTrlaD40fGApAVSaS0fzKs6N4g6SzAtibUJ2K/nxg4t4hQzLZPjCJPnqtYrqNYrRiRoETA493P+7kHonhBSJaysvA4JqqQqv4MjERolQWD8YDPuFCiuPykm1QOmlaCWVIUF79bb2oS38m3i2ElhoZs/gGhPsDkuM6oD/NZUaBeoUiaqLogKlUkx76rkNsoB/u4BvK1N5ZgkCVFuJ80RUeu/DbQ9QLiaKgxoQpSVpW48yZqTiBJo1hrwtjbhbW0aL4MspZxOoSOPj2tP2ltEeaEOjFYBkQj91tRIkJik6LemEiXNpJDn81tT8HcPjJOgsQeolJfvcSlP5xHEeyvfgvi3+U5glAPkYkgIKQRU3ZfbUfBbU8pn5Gc5lAcszgRFW45Dan0ZsrdEeYrKk1S47Axx9enIigSjEBCfsGeevwgJM7uUT2xlCurWceMuO/zHbtYfRi47Q/i7B5hdyo/dlxHl3lH9l53h2DxXn46Cf22tD1h+HBWhMPP8RUCAcEv5nkxQFOSxKiI5FBew8gAqhLBWnPJUmaj27FI+0uouwMIiTYoiLyQlQu6nJFJQEjg/j7P/4ICGhUCUQnFjhMKUUBc/kGD5OkwhCxmlfPlxMZTQ6DWdiyvZRcHZD5CiwgIAyo+LAIDGP93QNb2X1k/mnH3IIwosA0ct4F7Rjfnpu65i6JnR/SI+nv6+MnoOAHDqSkbAQQjcYZn8YXDurwzO/RUAePusEBq4MT8dEFKcU4oTmosb3ARMFLS06AWKbsxPRyltPL8uOEMgsWClRQ+Aj27/JmgD0+j2b3TexRIaXB6gZZX2ma9U1sAbrMFBgJYgHz73gvarn+ZTfbcKrpJgLIT122d+6PohYEuAtgWEmx/3rgHce4Sm+1vJQJGaB7xcXm+9e/0UwL2ywvLHveug/e71U7xcXm+lJZcNAUbMj7L+CMW5R4EnHPeuQ31pyAIA35k+CGAu6UBh/faZj7/+vsL7LwNszE/jh5kc3qw/wX7nAgCw37nAj9//izfrT9C9mPn5j/6fv2rI09dVAEg5CXb7N3j/ZRBcU4vflb/o9m/QPvNTCwWbQugUCVxPWP/D5x6Oe9eBosB6q3jmj5Hw0ay8MS6KbHdcxrEnrPv2WQGlRQ+//PaVkKONByMAcLRJ0YBVSfwghdD/CVyHDg/lBdYbIs5Tl7RJYNkNch87pUUC2ymRq3M3V0SwH4+lcfBoS4bTM8HU/7MyJhPiVOEMGTJkyJAhQwaB/wCcF1ybPAOXlAAAAABJRU5ErkJggg==",G="/MyImmersiveExperience/assets/Player-LaRVoEvR.png",D={};let k=0;const J=5;let h=null;function w(e){h=e,d("grass",F),d("path",Q),d("oak_tree",I),d("player_sprite_sheet",G),d("temp_boss",I)}function d(e,o){const t=new Image;t.onload=()=>{D[e]=t,k++,k===J&&h&&h()},t.onerror=()=>{console.error(`Error loading image: ${o}`)},t.src=o}w.getAssets=()=>D;const v=32,C=32,m=64;function O(){const e=w.getAssets().player_sprite_sheet;function o(t,a){const n=document.createElement("canvas");n.width=m,n.height=m;const s=n.getContext("2d");if(!s)throw new Error("Failed to get 2D context");return s.drawImage(e,a*v,t*C,v,C,0,0,m,m),n}i.down_walk.push(o(0,0)),i.right_walk.push(o(1,1)),i.up_walk.push(o(2,1)),i.down_idle.push(i.down_walk[0]),i.right_idle.push(i.right_walk[0]),i.up_idle.push(i.up_walk[0])}let p=!1;function W(){document.addEventListener("keydown",H),document.addEventListener("keyup",x)}function H(e){if(p)return;let o=null;switch(e.key){case"ArrowUp":case"w":case"W":o="up";break;case"ArrowDown":case"s":case"S":o="down";break;case"ArrowLeft":case"a":case"A":o="left";break;case"ArrowRight":case"d":case"D":o="right";break;case" ":console.log("Action button pressed!");return}o&&(p=!0,K(o),e.preventDefault())}function x(e){if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","w","a","s","d","W","A","S","D"].includes(e.key)){p=!1,r.animationState="idle";const o=r.direction==="left"?"right":r.direction;r.currentAnimation=i[`${o}_idle`],r.frameIndex=0,r.animationTimer=0}}function K(e){if(e!==r.direction){r.direction=e,r.animationState="idle";const t=r.direction==="left"?"right":r.direction;r.currentAnimation=i[`${t}_idle`],r.frameIndex=0,r.animationTimer=0}else{let t=r.x,a=r.y;if(e==="up"?a--:e==="down"?a++:e==="left"?t--:e==="right"&&t++,t>=0&&t<U&&a>=0&&a<L){const n=A[a][t];[0,2,3,4,5].includes(n)?(r.x=t,r.y=a,r.animationState="walk"):r.animationState="idle"}else r.animationState="idle"}const o=r.direction==="left"?"right":r.direction;r.currentAnimation=i[`${o}_${r.animationState}`],r.frameIndex=0,r.animationTimer=0}function N(){const e={"btn-up":"ArrowUp","btn-down":"ArrowDown","btn-left":"ArrowLeft","btn-right":"ArrowRight","btn-action":" "};for(const[o,t]of Object.entries(e)){const a=document.getElementById(o);a&&(a.addEventListener("touchstart",n=>{n.preventDefault(),R(t)},{passive:!1}),a.addEventListener("touchend",n=>{n.preventDefault(),P(t)},{passive:!1}),a.addEventListener("mousedown",n=>{n.preventDefault(),R(t)}),a.addEventListener("mouseup",n=>{n.preventDefault(),P(t)}))}}function R(e){const o=new KeyboardEvent("keydown",{key:e,bubbles:!0,cancelable:!0});document.dispatchEvent(o)}function P(e){const o=new KeyboardEvent("keyup",{key:e,bubbles:!0,cancelable:!0});document.dispatchEvent(o)}function Y(e){const o=document.getElementById("gameCanvas"),t=o?o.getContext("2d"):null,a=64,n=e[0].length,s=e.length,l=n*a,c=s*a;return{canvas:o,ctx:t,TILE_SIZE:a,GAME_WIDTH:l,GAME_HEIGHT:c}}function M(e){e.style.transform="",e.style.position="",e.style.left="",e.style.top="",e.width=e.width,e.height=e.height}const{canvas:g,ctx:E,TILE_SIZE:j,GAME_WIDTH:u,GAME_HEIGHT:f}=Y(A);if(!g)throw console.error("Canvas element not found! Make sure there's a canvas with id='gameCanvas'"),new Error("Canvas not found");if(!E)throw console.error("Could not get 2D context from canvas"),new Error("Canvas context not available");g.width=u;g.height=f;console.log(`Canvas initialized: ${u}x${f} (${A[0].length}x${A.length} tiles)`);M(g);window.addEventListener("resize",()=>M(g));let B=0,y=!1;function Z(){y||(y=!0,console.log("Game started!"),requestAnimationFrame(T))}function T(e){if(!y)return;const o=(e-B)/1e3;B=e,_(o),E&&X(E,A,j),requestAnimationFrame(T)}function X(e,o,t){e.clearRect(0,0,u,f);const a=w.getAssets();if(!a.grass){e.fillStyle="#333",e.fillRect(0,0,u,f),e.fillStyle="#fff",e.font="20px Arial",e.textAlign="center",e.fillText("Loading assets...",u/2,f/2);return}for(let n=0;n<o.length;n++)for(let s=0;s<o[0].length;s++){const l=o[n][s];let c=null;switch(l){case 0:c=a.grass;break;case 1:c=a.oak_tree;break;case 2:case 3:case 4:case 5:c=a.path;break}if(c?e.drawImage(c,s*t,n*t,t,t):(e.fillStyle=l===1?"#8B4513":"#90EE90",e.fillRect(s*t,n*t,t,t)),l===1&&a.oak_tree){const b=a.oak_tree.height;e.drawImage(a.oak_tree,s*t,n*t-(b-t),t,b)}}S(e,t)}console.log("Loading assets...");w(()=>{console.log("Assets loaded, initializing sprites..."),O(),console.log("Setting up input listeners..."),W(),N(),console.log("Starting game..."),Z()});
