(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();const f=[[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,5,0,0,0,0,0,0],[0,0,0,0,0,2,0,0,0,0,0,0],[0,0,0,0,0,2,0,0,0,0,0,0],[0,3,2,2,2,2,2,2,2,4,0,0],[0,0,0,0,0,2,0,0,0,0,0,0],[0,0,0,0,0,2,0,0,0,0,0,0],[0,0,0,0,0,2,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0]],T=f[0].length,b=f.length,s={down_idle:[],down_walk:[],up_idle:[],up_walk:[],left_idle:[],left_walk:[],right_idle:[],right_walk:[]},e={x:Math.floor(T/2),y:b-2,direction:"down",animationState:"idle",currentAnimation:[],frameIndex:0,animationTimer:0,animationSpeed:.15};e.currentAnimation=s.down_idle;function x(r){e.animationTimer+=r,e.animationTimer>=e.animationSpeed&&(e.animationTimer=0,e.frameIndex=(e.frameIndex+1)%e.currentAnimation.length)}function v(r,t){const i=e.currentAnimation[e.frameIndex];if(!i)return;const a=e.x*t,n=e.y*t;if(r.save(),e.direction==="left"){const o=i.width;r.translate(a,n),r.scale(-1,1),r.drawImage(i,-o,0)}else r.drawImage(i,a,n);r.restore()}let w=0,A=0,g=0;function D(r){g++,r-A>1e3&&(w=g,g=0,A=r);const t=document.getElementById("debug-panel");t&&(t.innerHTML=`
      x: ${e.x}<br>
      y: ${e.y}<br>
      dir: ${e.direction}<br>
      state: ${e.animationState}<br>
      frame: ${e.frameIndex}<br>
      FPS: ${w}
    `)}const L={};let I=0;const G=5;let h=null;function m(r){h=r,d("grass","assets/Grass_Middle.png"),d("path","assets/Path_Middle.png"),d("oak_tree","assets/Oak_Tree.png"),d("player_sprite_sheet","assets/Player.png"),d("temp_boss","assets/Oak_Tree.png")}function d(r,t){const i=new Image;i.onload=()=>{L[r]=i,I++,I===G&&h&&h()},i.onerror=()=>{console.error(`Error loading image: ${t}`)},i.src=t}m.getAssets=()=>L;const E=32,y=32,u=64;function S(){const r=m.getAssets().player_sprite_sheet;function t(i,a){const n=document.createElement("canvas");n.width=u,n.height=u;const o=n.getContext("2d");if(!o)throw new Error("Failed to get 2D context");return o.drawImage(r,a*E,i*y,E,y,0,0,u,u),n}s.down_walk.push(t(0,0)),s.right_walk.push(t(1,1)),s.up_walk.push(t(2,1)),s.down_idle.push(s.down_walk[0]),s.right_idle.push(s.right_walk[0]),s.up_idle.push(s.up_walk[0])}function $(){document.addEventListener("keydown",r=>{let t=null;switch(r.key){case"ArrowUp":t="up";break;case"ArrowDown":t="down";break;case"ArrowLeft":t="left";break;case"ArrowRight":t="right";break}if(!t)return;if(t!==e.direction){e.direction=t,e.animationState="idle";const a=e.direction==="left"?"right":e.direction;e.currentAnimation=s[`${a}_idle`],e.frameIndex=0,e.animationTimer=0}else{let a=e.x,n=e.y;if(t==="up"?n--:t==="down"?n++:t==="left"?a--:t==="right"&&a++,a>=0&&a<T&&n>=0&&n<b){const o=f[n][a];[0,2,3,4,5].includes(o)?(e.x=a,e.y=n,e.animationState="walk"):e.animationState="idle"}}const i=e.direction==="left"?"right":e.direction;e.currentAnimation=s[`${i}_${e.animationState}`],e.frameIndex=0,e.animationTimer=0,r.preventDefault()}),document.addEventListener("keyup",r=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(r.key)){e.animationState="idle";const t=e.direction==="left"?"right":e.direction;e.currentAnimation=s[`${t}_idle`],e.frameIndex=0,e.animationTimer=0}})}function R(r){const t=document.getElementById("gameCanvas"),i=t?t.getContext("2d"):null,a=64,n=r[0].length,o=r.length,l=n*a,c=o*a;return{canvas:t,ctx:i,TILE_SIZE:a,GAME_WIDTH:l,GAME_HEIGHT:c}}const{canvas:p,ctx:_,TILE_SIZE:F,GAME_WIDTH:P,GAME_HEIGHT:H}=R(f);if(p&&_)p.width=P,p.height=H;else throw new Error("Canvas or context not initialized");let k=0;function O(){requestAnimationFrame(M)}function M(r){const t=(r-k)/1e3;k=r,x(t),_&&W(_,f,F),requestAnimationFrame(M),D(r)}function W(r,t,i){r.clearRect(0,0,P,H);const a=m.getAssets();for(let n=0;n<t.length;n++)for(let o=0;o<t[0].length;o++){const l=t[n][o];let c=null;switch(l){case 0:c=a.grass??null;break;case 1:c=a.oak_tree??null;break;case 2:case 3:case 4:case 5:c=a.path??null;break}c&&r.drawImage(c,o*i,n*i,i,i),l===1&&a.oak_tree&&r.drawImage(a.oak_tree,o*i,n*i-(a.oak_tree.height-i))}v(r,i)}m(()=>{S(),$(),O()});
