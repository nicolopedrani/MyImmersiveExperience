import{p as m,g as ee,u as me,a as h,b as pe,c as Te,W as Ie,M as ye,d as be,s as Re,e as xe,i as Me,f as Pe,h as Ee}from"./game-CudpEz85.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function o(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=o(a);fetch(a.href,i)}})();const Ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAB1JREFUOI1jtOv0+M9AAWCiRPOoAaMGjBowmAwAAJhEAi4/QQzBAAAAAElFTkSuQmCC",De="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAB1JREFUOI1jfLKs6D8DBYCJEs2jBowaMGrAYDIAAFnyAxuTOlahAAAAAElFTkSuQmCC",_e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABQCAYAAACpv3NFAAAAAXNSR0IArs4c6QAABZFJREFUeJztW09PG0cU/zk1ogZFvbBFCjgXDgYipAYJRzKHXCLlGkeIT9EvkAMnH/oJ+iUsFM6VcokESBipiYRi44MPjUGVte6BVmDRWNCDmeXteHa9M/Nm6WF/Esrszuzse7/3Z97MOkCGDBkyZMiQIUOGdFFY8G4LC97tQ8uRczEpVWxw7ufE9eDcz4n+1Z0yAKBZa4COdSFPHPKckwlFhXIA0Kw1qLJj/fS6WWvcqghzCbYXCKs2aw1U6xUAQPtkCGBkZVnp0lo+NKa0lkf7ZBga26w1nJPwiGMS6vKrO2XsbR8CuFeyWq8EbXpfvlYR5TpXWLNbWPBuq/VKyHqyggLtk2Fkn2rM3vZh4E1724dOvIGNANcQXgXw5garEEh7GVvdKWN1p8z6XmMCRNITMd8+GQYJzQXk0OLKDSxJUE5y3FDlDi5vsCJAFDF0KXMBOq9YZrneZUQAdX9ayQFwGgrtkyG4E65RNqWlrAouw4GCY2UwXk4oCbSqS0t5OexM6wSrEKACuFwBVOB6rzYBctaVY56biLj5qPVNoeUy8jaWrs3U/blCIek8dNOlGwbGyyBdimRBOfNAlAdweZp20lDFPxcEkSrl6LtU/aZbZy0PUMV/EiQdR5WXyRW5hs5Ft9Gmy6B2CFTrlaD40fGApAVSaS0fzKs6N4g6SzAtibUJ2K/nxg4t4hQzLZPjCJPnqtYrqNYrRiRoETA493P+7kHonhBSJaysvA4JqqQqv4MjERolQWD8YDPuFCiuPykm1QOmlaCWVIUF79bb2oS38m3i2ElhoZs/gGhPsDkuM6oD/NZUaBeoUiaqLogKlUkx76rkNsoB/u4BvK1N5ZgkCVFuJ80RUeu/DbQ9QLiaKgxoQpSVpW48yZqTiBJo1hrwtjbhbW0aL4MspZxOoSOPj2tP2ltEeaEOjFYBkQj91tRIkJik6LemEiXNpJDn81tT8HcPjJOgsQeolJfvcSlP5xHEeyvfgvi3+U5glAPkYkgIKQRU3ZfbUfBbU8pn5Gc5lAcszgRFW45Dan0ZsrdEeYrKk1S47Axx9enIigSjEBCfsGeevwgJM7uUT2xlCurWceMuO/zHbtYfRi47Q/i7B5hdyo/dlxHl3lH9l53h2DxXn46Cf22tD1h+HBWhMPP8RUCAcEv5nkxQFOSxKiI5FBew8gAqhLBWnPJUmaj27FI+0uouwMIiTYoiLyQlQu6nJFJQEjg/j7P/4ICGhUCUQnFjhMKUUBc/kGD5OkwhCxmlfPlxMZTQ6DWdiyvZRcHZD5CiwgIAyo+LAIDGP93QNb2X1k/mnH3IIwosA0ct4F7Rjfnpu65i6JnR/SI+nv6+MnoOAHDqSkbAQQjcYZn8YXDurwzO/RUAePusEBq4MT8dEFKcU4oTmosb3ARMFLS06AWKbsxPRyltPL8uOEMgsWClRQ+Aj27/JmgD0+j2b3TexRIaXB6gZZX2ma9U1sAbrMFBgJYgHz73gvarn+ZTfbcKrpJgLIT122d+6PohYEuAtgWEmx/3rgHce4Sm+1vJQJGaB7xcXm+9e/0UwL2ywvLHveug/e71U7xcXm+lJZcNAUbMj7L+CMW5R4EnHPeuQ31pyAIA35k+CGAu6UBh/faZj7/+vsL7LwNszE/jh5kc3qw/wX7nAgCw37nAj9//izfrT9C9mPn5j/6fv2rI09dVAEg5CXb7N3j/ZRBcU4vflb/o9m/QPvNTCwWbQugUCVxPWP/D5x6Oe9eBosB6q3jmj5Hw0ay8MS6KbHdcxrEnrPv2WQGlRQ+//PaVkKONByMAcLRJ0YBVSfwghdD/CVyHDg/lBdYbIs5Tl7RJYNkNch87pUUC2ymRq3M3V0SwH4+lcfBoS4bTM8HU/7MyJhPiVOEMGTJkyJAhQwaB/wCcF1ybPAOXlAAAAABJRU5ErkJggg==",Le="/MyImmersiveExperience/assets/Player-LaRVoEvR.png",Be="/MyImmersiveExperience/assets/MainGuySpriteSheet-A_pLERVz.png",Ue="/MyImmersiveExperience/assets/assets-k1rCfwam.png",Fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABgCAYAAADVenpJAAAHZElEQVR4nO2dXUwUVxTH/zM7u8sCIoqCoKAJEo2FKFpM1VbLR6tNXxqrJSS1SQ1ttDURTW1KYh8aSbYpjaGJaY0hmugDoTW+NW0igta2ttLYWqlVwUSoroVKJVtYYb+mD7DTnWXW7c7eubPsvb9kkrkDnHPunT+79+PcGUGWZRkcZpEA4OClF8yOwxSa1n0FgO36SwBwf/S22bGYCsv1lwDAYZ1ldhymwnL9JQCQ5aDZcZgKy/UXzQ6AYy5cAIzDBcA4XACMwwXAOFwAjMMFwDhcAIzDBcA4XACMwwXAOFwAjCMBgCTaqDjzB71U/Mw0aLW/pm8AePDoLgKy31BHFkFCtj3XUB8zFRrtH4lFkABMCaCm6DVk2XIMdej2DuOnwa8N9TFTodH+kbi9wwCmBPD6CieGHg0Y6jDXUcQFEAUa7R9JrqMIwJQA/EEv9p5fa6jDU5vpVnAmQaP9Izm1eQCSaPuvEzjfUWioQzM7OskOjfbX8glMfQIAoN4J4agxq/35PADjcAEwDhcA43ABMA4XAONwATCOMgwMzQ3rgQ8h6ZHIfdJCsTY87tJlwCJYMIvyPDbLjEwMIiAHiNlTBFC5qE6XgTG/G7cedhMLiPN41uRtQYaURcyeIoC6ZQd1GciwZuPtrnJiAXEez95VxzDmGyFmTxHA7s6VugyceJ7dvfVmEJD9uu9VOCc39wMIE0CWfZ4uQ/F0SiK3YQsC3UFItG3gZscVDxZB0n2vtFDuHo098n7ZpyrbRAe1vfmCIMIXnND8mRlxJSIykrGRHVPE4NPKX1TlnWdLkG3PpZKONjIxhOPP9SZFXKF4kgGqAmj5uV5V/qzqKuo7liM3fbFhCaOSaMOQpx+tNTem+X9nzUnqcYXHkwxQFcC14W9U5babTfjk2cvYd+EpZNvziPuzija4xm7jSOUVtN1smuY/Vlx7ulajIKMYPkIiiIwnRH3px0Ts64GqALJs6s5L1902zElbgH3lx3HieiNRX1bRhnujvfjw6U5cvPc5uu62YW5aflxxOTd04L1vq7Aws4SICAY9A3Bu6FDiCWGmAKh2d4NyQHXkpBXgi95mPJm3hbivIc8AGiva0e/uwRe9zchJK5jmP1Zc/e4eNFa0Y8hDJp+xvvQjVTyhw0xMHe8EZD/y0pcY8v2/reQAAODotQbkpS+Jq0MXiuvotQaVrUSpLtyhiid0mInpA15/0GtIwujWpfvh7K5FQUaxLoH5g14UZBTD2V2LrUv3E4nJN2UzmXZImS4Ao/AFvY/97g4fh0cbk8eyES9W0UbMFilSVgCxGnvcP6p5Hokv6IU1hVPaU1YAsQjPw6edk59MMCsA54YOzXPWYFYAnEm4ABiHWQE0Xd6mec4aKSuAWL33vpErmueRJOPQjSQpK4DQWkA0EcyyzdU8j8dGKpCyAjjTdxiNFe1wjd3WnGmMXAuIRJpauWusaMeZvsOGxmomKSuA073NAIBdZS0Y9NyJK3XNIkgY9NzBrrIWla1ECch+4nn9iWK6AETBovkfmCi56UVwdtdicVYptpccwPC4C6JgUR3hMYQfw+MubC85gMVZpXB21yI3vYhITBZBUuJIFkyVoyCIcHsfGNIgoXn8xu9qcKTyCh6O/4mLrtOav+v2PlCVKxfV4ZmFr2BP12qiawG3HnajclEdLrpOJ81mGqoCECCoyo98/6AsZyPujxmTWu4LepGfUYy959eiteZG1Dy8spyNqnLdsoOo71iOfILZQABw6PLLOFr1K0YmhvD73z8Qs5sIVAXgjcjKLchciobyVrxxbgXSJWNe3eYPejHfUYjdnSujJoU2lLeqyjvPlmC+o5D4su0ce54Sxwc/vkTUtl6oCiA9YkvToXVf4s1zTyDDOtvQNOyA7EeWfR7e6lqlun6s+joATLueZZ9nSKJGeBzHqn8jbl8PdLOCN32vKjdcWA9JsFLZGyDLQUiCVfNnkdeNjCcUR8OF9cq1lk2XDPMXC6oCeP/Si6qyx++mOskSLfGD9k4gQRDh8bup+oyGIgAaz/Fzjfapyg4pEzLYfHm5TbTr/luS90oRgN6eeDy95Mh39LL8yla9wvcFvURHTYoA9CZFxPMRzvINJ4VVtBFNYFEE0O/u0WXg6l+dxILhxOZM32Eij90vnr0KQJgAQjnw8SIJVsxJW5BwQJz/x+ne5mm7mfVQVfgqgDABFGQU6zaWyuvlyQapdYkQigD4TZwZkL5Ppq8GcsyFC4BxuAAYhwuAcbgAGIcLgHGUYWAqpz7PBMxqfwmYHFveG9XOliEFn2eIDo321/JpDb02zira0FjRbqhD/gkTHRrtr+UTmOoDnPvjlOEOafiYqZjRNiGfEgC09rwLf5THqJJCEu2YyxeNNKHR/pFIoh3VhTsmBZBHeIEhGrwfoA2t9tdC6QRyzMPM9ufzAIzDBcA4XACMwwXAOFwAjMMFwDhcAIzDBcA4XACMwwXAOBKQ3C9KpAHL9ZeAyWf1sAzL9ZcAID9T/7awVIDl+guyLLP5hAYOAOBfSQHMHZJk+TkAAAAASUVORK5CYII=",Ne="/MyImmersiveExperience/assets/library-BPiDb9BV.png",We="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAUCAYAAABGUvnzAAAC4ElEQVR4nO2av27bMBDGT4UeoIBSIJUrdGszeWqmCMgSDVliBMiUrRmSN/BDCOgDdMmYyUDgLB3UpYA6pROndiwSux3KoXtQZbBPpihS/CPaTm3/FkukSCn++N2d6Hj3ewdFJ88g6KVAaAbdIAFCM8A2WwjNGvs7eXN/E6M4sR7bhtMjv9b2pf+p1iZ6vm5Qb6PDvtbYdz9+6j5iDb8bJEDiBGiewSjOpOLSYV8oOLbzn20E3OAOH53GrpxRnACB6qqTuVkkLj+fCNkCYMfNc5GI3Cjj6uZhbs8xb/xukAAd9ssvtpNnMIoTYUgBqDvZpYP5RTGKE+N5wkEE45M743sDTMLtfnpoNXaefHv72nqsj+Ji7g16KdA8AzJt4wXlnYzn/Kepg2XX64ocDqLasYnQT1XctvhBLwWYuhVdy7aJ3Mqey2nqc8/45K4isq2LV41KIpIVUgjf16aa5V2JqUF1nQzWteEgMg7V++nhSrq4FBjdqBKZxXURxItsMj8rpq17n6q4bGQypRSYr4J5RH0uHaxqd83/XBmbUAnRJuEZYHFibLDHu987KGwHo8CiTRGsfvk+1Q7XqvLq62dvGffVf9sXgCGaSoRmQWFxUSxru3Hd8Nsk8K2LHQAAIJzQLLywuAiI9V3lsCljs4AmVByM1aeu6LP3YPk7L5+ndcaomJd4p0d+Y/HVVHMU17vgHd/KJ/eWEqFnAnvblwAw2zUqfp8pB6u+6KZ+lwWaaC6TVID70lc3D5VjHYrr3dpxo9AL5hl7Eg6itQxtKKapuMj4w3Pwjm8hPP/r/Nna4v379b4AmORTQjMIBxFsXezAn4/f1YO3L6V9Nj8U6CJbhLY5WNfBsr+HdbHMvZ63nBhdhuiJoBFzrAYLJsyr7C9SPNgn+5XKBNcFGitmk3tfvnijnuxc45oF4rfZlKf5xMG8eJS5plwEU9GJQ6F51jG9qHDyHqwjFi80tPh3oA36PAJWG3h2QapYCQAAAABJRU5ErkJggg==",d={};let E=0;const H=9;let _=null;const ae={objects:[{name:"Bookshelf_A",code:"bsA",x:120,y:360,width:96,height:120},{name:"Bookshelf_B",code:"bsB",x:240,y:360,width:96,height:120},{name:"Bookshelf_C",code:"bsC",x:360,y:360,width:96,height:120},{name:"table",code:"t",x:336,y:192,width:168,height:96},{name:"world_map",code:"wm",x:120,y:192,width:96,height:120},{name:"chair",code:"c",x:648,y:72,width:48,height:72},{name:"rug",code:"r",x:432,y:0,width:168,height:72}],paths:[{name:"path_walk",code:"pw",x:72,y:192,width:24,height:24}]},ze={tilesheet:{columns:4,rows:3,tileWidth:32,tileHeight:32}},ne={flags:[{name:"Australia",code:"au",x:0,y:0,width:15,height:10},{name:"United States",code:"us",x:15,y:0,width:15,height:10},{name:"Japan",code:"jp",x:30,y:0,width:15,height:10},{name:"Vietnam",code:"vn",x:45,y:0,width:15,height:10},{name:"Italy",code:"it",x:75,y:0,width:15,height:10},{name:"France",code:"fr",x:90,y:0,width:15,height:10},{name:"Germany",code:"de",x:105,y:0,width:15,height:10},{name:"Spain",code:"es",x:0,y:10,width:15,height:10},{name:"United Kingdom",code:"gb",x:15,y:10,width:15,height:10}]},je={trees:[{name:"tree_1",code:"t1",x:0,y:0,width:160,height:208},{name:"tree_2",code:"t2",x:176,y:32,width:160,height:176},{name:"tree_3",code:"t3",x:368,y:32,width:128,height:176}]};function te(t){_=t,console.log("🚀 Starting asset loading..."),w("grass",Ce),w("path",De),w("oak_tree_original",_e),w("player_sprite_sheet",Le),w("main_guy_sprite_sheet",Be),w("assets_tilesheet",Ue),w("football_tilesheet",Fe),w("library_tilesheet",Ne),w("travel_flags_tilesheet",We)}function w(t,e){const o=new Image;o.onload=()=>{d[t]=o,E++,console.log(`✅ Loaded: ${t} (${E}/${H})`),E===H&&(console.log("🎯 All images loaded, starting tile extraction..."),Ye(),Je(),_&&_())},o.onerror=()=>{console.error(`❌ Failed to load: ${t} from ${e}`),E++,E===H&&_&&_()},o.src=e}function Ye(){console.log("🔧 Extracting tiles..."),Oe(),Qe(),Ge(),He(),qe(),Ve()}function Oe(){const t=d.library_tilesheet;if(!t){console.error("❌ Library tilesheet not found");return}console.log("📚 Extracting library tiles..."),console.log("Library tilesheet size:",t.width,"x",t.height),ae.objects.forEach(o=>{console.log(`Extracting ${o.name} at (${o.x}, ${o.y}) size ${o.width}x${o.height}`);const n=U(t,o.x,o.y,o.width,o.height);o.name==="world_map"?(d.world_map=n,console.log("✅ World map extracted")):o.name==="chair"?(d.library_chair=n,console.log("✅ Chair extracted")):o.name.includes("Bookshelf")?(d[`library_${o.code}`]=n,console.log(`✅ Bookshelf ${o.code} extracted`)):o.name==="table"?(d.library_table=n,console.log("✅ Table extracted")):o.name==="rug"&&(d.library_rug=n,console.log("✅ Rug extracted"))});const e=ae.paths[0];d.library_floor=U(t,e.x,e.y,e.width,e.height),console.log("✅ Library floor extracted")}function Qe(){const t=d.football_tilesheet;if(!t)return;console.log("⚽ Extracting football tiles...");const{tileWidth:e,tileHeight:o,columns:n,rows:a}=ze.tilesheet;for(let i=0;i<a;i++)for(let l=0;l<n;l++){const c=i*n+l;d[`football_${c}`]=U(t,l*e,i*o,e,o)}console.log(`✅ Extracted ${a*n} football tiles`)}function Ge(){const t=d.travel_flags_tilesheet;t&&(console.log("🏁 Extracting flags..."),ne.flags.forEach(e=>{d[`flag_${e.code}`]=U(t,e.x,e.y,e.width,e.height)}),console.log(`✅ Extracted ${ne.flags.length} flags`))}function He(){const t=d.assets_tilesheet;t&&(console.log("🌳 Extracting trees..."),je.trees.forEach(e=>{d[`tree_${e.code}`]=U(t,e.x,e.y,e.width,e.height),console.log(`✅ Extracted tree ${e.code}`)}))}function U(t,e,o,n,a,i=64,l=64){const c=document.createElement("canvas");c.width=i,c.height=l;const s=c.getContext("2d");if(!s)return console.error("❌ Could not get canvas context"),new Image;s.clearRect(0,0,i,l),s.imageSmoothingEnabled=!1,s.drawImage(t,e,o,n,a,0,0,i,l);const r=new Image;return r.src=c.toDataURL(),r}function Je(){console.log("🎨 Creating backgrounds for trees only...");const t=d.grass;if(!t){console.error("❌ Grass tile not available for backgrounds");return}W("oak_tree_original","oak_tree",t),W("tree_t1","tree_t1",t),W("tree_t2","tree_t2",t),W("tree_t3","tree_t3",t),console.log("✅ Tree backgrounds created, library items left as-is")}function W(t,e,o){const n=d[t];if(!n){console.warn(`⚠️ Source tile ${t} not found, skipping background`);return}const a=document.createElement("canvas");a.width=64,a.height=64;const i=a.getContext("2d");if(!i){console.error(`❌ Could not get canvas context for ${e}`);return}i.drawImage(o,0,0,64,64),i.drawImage(n,0,0,64,64);const l=new Image;l.src=a.toDataURL(),d[e]=l,console.log(`✅ Created background for ${e}`)}function qe(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.strokeStyle="#444",e.lineWidth=3,e.strokeRect(4,4,56,56),e.strokeStyle="#666",e.lineWidth=1,e.strokeRect(8,8,24,24),e.strokeRect(32,8,24,24),e.strokeRect(8,32,24,24),e.strokeRect(32,32,24,24),e.fillStyle="#FFD700",e.beginPath(),e.arc(48,32,3,0,Math.PI*2),e.fill());const o=new Image;o.src=t.toDataURL(),d.door=o,console.log("✅ Door tile created")}function Ve(){console.log("📊 Creating diverse Data Science visualization tiles..."),$e(),Xe(),Ze(),Ke(),et(),tt(),ot(),at(),nt(),it(),lt(),st(),rt(),ct(),ft(),dt(),ht(),console.log("✅ Diverse Data Science and R&D visualization tiles created")}function $e(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("NPS Analysis",5,12),e.strokeStyle="#00d084",e.lineWidth=2,e.beginPath();const n=[45,42,47,38,50,32,55];for(let a=0;a<n.length;a++){const i=8+a*8,l=n[a];a===0?e.moveTo(i,l):e.lineTo(i,l)}e.stroke(),e.fillStyle="#00d084";for(let a=0;a<n.length;a++)e.beginPath(),e.arc(8+a*8,n[a],2,0,Math.PI*2),e.fill();e.fillStyle="#ffd700",e.font="bold 10px Arial",e.fillText("73",45,58)}const o=new Image;o.src=t.toDataURL(),d.nps_chart=o}function Xe(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Energy Cost",5,12),e.fillStyle="rgba(255, 165, 0, 0.3)",e.beginPath(),e.moveTo(8,55);const n=[45,38,42,35,40,30,35];for(let a=0;a<n.length;a++)e.lineTo(8+a*8,n[a]);e.lineTo(56,55),e.closePath(),e.fill(),e.strokeStyle="#ffa500",e.lineWidth=2,e.beginPath();for(let a=0;a<n.length;a++){const i=8+a*8,l=n[a];a===0?e.moveTo(i,l):e.lineTo(i,l)}e.stroke(),e.fillStyle="#00ff88",e.font="bold 8px Arial",e.fillText("-23%",45,58)}const o=new Image;o.src=t.toDataURL(),d.energy_cost_chart=o}function Ze(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Fashion Sales",5,12),e.strokeStyle="#e91e63",e.lineWidth=2,e.beginPath();const n=[35,45,40,25,20,18,22,38,42,50,55,48];for(let a=0;a<n.length;a++){const i=8+a*4.5,l=n[a];a===0?e.moveTo(i,l):e.lineTo(i,l)}e.stroke(),e.fillStyle="#ffc107",e.beginPath(),e.arc(8+10*4.5,55,3,0,Math.PI*2),e.fill(),e.fillStyle="#ffc107",e.font="bold 7px Arial",e.fillText("Peak",38,58)}const o=new Image;o.src=t.toDataURL(),d.fashion_retail_timeseries=o}function Ke(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Supply Chain",5,12);const n=[{x:15,y:25,color:"#00d084"},{x:35,y:20,color:"#ffc107"},{x:50,y:30,color:"#e91e63"},{x:25,y:45,color:"#9c27b0"},{x:45,y:50,color:"#2196f3"}];e.strokeStyle="#4a5568",e.lineWidth=1,e.beginPath(),e.moveTo(15,25),e.lineTo(35,20),e.moveTo(35,20),e.lineTo(50,30),e.moveTo(35,20),e.lineTo(25,45),e.moveTo(50,30),e.lineTo(45,50),e.moveTo(25,45),e.lineTo(45,50),e.stroke(),n.forEach(a=>{e.fillStyle=a.color,e.beginPath(),e.arc(a.x,a.y,4,0,Math.PI*2),e.fill()})}const o=new Image;o.src=t.toDataURL(),d.distribution_network_map=o}function et(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Forecast Dist",5,12),e.fillStyle="#3b82f6";const n=[15,25,35,40,35,25,20,15];for(let a=0;a<n.length;a++){const i=8+a*6,l=n[a];e.fillRect(i,55-l,5,l)}e.strokeStyle="#ef4444",e.lineWidth=2,e.beginPath();for(let a=0;a<50;a++){const i=8+a,l=55-(20+15*Math.exp(-Math.pow((a-25)/8,2)));a===0?e.moveTo(i,l):e.lineTo(i,l)}e.stroke()}const o=new Image;o.src=t.toDataURL(),d.forecast_histogram=o}function tt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Box Plot",5,12),e.strokeStyle="#06b6d4",e.fillStyle="rgba(6, 182, 212, 0.3)",e.lineWidth=2,e.fillRect(20,25,24,15),e.strokeRect(20,25,24,15),e.beginPath(),e.moveTo(30,25),e.lineTo(30,40),e.stroke(),e.beginPath(),e.moveTo(15,32.5),e.lineTo(20,32.5),e.moveTo(44,32.5),e.lineTo(50,32.5),e.moveTo(15,30),e.lineTo(15,35),e.moveTo(50,30),e.lineTo(50,35),e.stroke(),e.fillStyle="#ef4444",e.beginPath(),e.arc(12,20,2,0,Math.PI*2),e.arc(55,45,2,0,Math.PI*2),e.fill());const o=new Image;o.src=t.toDataURL(),d.box_plot=o}function ot(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#f2c811",e.fillRect(0,0,64,64),e.fillStyle="#323130",e.font="bold 10px Arial",e.fillText("Dashboard",8,15);const n=32,a=35,i=15;[{angle:0,size:Math.PI*.6,color:"#0078d4"},{angle:Math.PI*.6,size:Math.PI*.8,color:"#00bcf2"},{angle:Math.PI*1.4,size:Math.PI*.6,color:"#40e0d0"}].forEach(c=>{e.fillStyle=c.color,e.beginPath(),e.moveTo(n,a),e.arc(n,a,i,c.angle,c.angle+c.size),e.closePath(),e.fill()}),e.fillStyle="#fff",e.fillRect(8,52,20,8),e.fillStyle="#323130",e.font="bold 8px Arial",e.fillText("87%",12,58)}const o=new Image;o.src=t.toDataURL(),d.powerbi_dashboard_left=o}function at(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#f2c811",e.fillRect(0,0,64,64),e.strokeStyle="#323130",e.lineWidth=2,e.beginPath();const n=[40,35,38,32,28,25,22];for(let a=0;a<n.length;a++){const i=8+a*8,l=n[a];a===0?e.moveTo(i,l):e.lineTo(i,l)}e.stroke(),e.fillStyle="#0078d4";for(let a=0;a<n.length;a++)e.beginPath(),e.arc(8+a*8,n[a],2,0,Math.PI*2),e.fill();e.fillStyle="#323130",e.font="bold 8px Arial",e.fillText("↑23%",8,55),e.fillText("$2.1M",38,55)}const o=new Image;o.src=t.toDataURL(),d.powerbi_dashboard_right=o}function nt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#3776ab",e.fillRect(0,0,64,32),e.fillStyle="#ffd343",e.fillRect(0,32,64,32),e.fillStyle="#fff",e.font="bold 10px Arial",e.fillText("Python",12,20),e.fillStyle="#000",e.font="bold 8px Arial",e.fillText("scikit",8,45),e.fillText("learn",8,55),e.fillStyle="#666",e.beginPath(),e.arc(50,45,8,0,Math.PI*2),e.fill(),e.fillStyle="#fff",e.fillText("ML",46,49));const o=new Image;o.src=t.toDataURL(),d.python_sklearn=o}function it(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#ee4c2c",e.fillRect(0,0,64,32),e.fillStyle="#1a1a1a",e.fillRect(0,32,64,32),e.fillStyle="#fff",e.font="bold 10px Arial",e.fillText("PyTorch",10,20),e.fillStyle="#00d084",e.font="bold 8px Arial",e.fillText("Lang",8,45),e.fillText("Chain",8,55),e.strokeStyle="#00d084",e.lineWidth=2,e.beginPath(),e.arc(45,45,4,0,Math.PI*2),e.stroke(),e.beginPath(),e.arc(52,45,4,0,Math.PI*2),e.stroke(),e.beginPath(),e.moveTo(49,45),e.lineTo(48,45),e.stroke());const o=new Image;o.src=t.toDataURL(),d.pytorch_langchain=o}function lt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Rec Tree",5,12),e.strokeStyle="#4a5568",e.lineWidth=1,e.fillStyle="#e53e3e",e.fillRect(28,18,8,6),e.fillStyle="#3182ce",e.fillRect(18,30,8,6),e.fillRect(38,30,8,6),e.fillStyle="#38a169",e.fillRect(10,42,6,5),e.fillRect(20,42,6,5),e.fillRect(38,42,6,5),e.fillRect(48,42,6,5),e.beginPath(),e.moveTo(32,24),e.lineTo(22,30),e.moveTo(32,24),e.lineTo(42,30),e.moveTo(22,36),e.lineTo(13,42),e.moveTo(22,36),e.lineTo(23,42),e.moveTo(42,36),e.lineTo(41,42),e.moveTo(42,36),e.lineTo(51,42),e.stroke(),e.fillStyle="#ffd700",e.font="6px Arial",e.fillText("0.89",10,58),e.fillText("0.76",20,58),e.fillText("0.91",38,58),e.fillText("0.82",48,58));const o=new Image;o.src=t.toDataURL(),d.recommendation_tree=o}function st(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#0078d4",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Azure",18,15),e.font="bold 7px Arial",e.fillText("Machine",12,28),e.fillText("Learning",12,38),e.strokeStyle="#fff",e.lineWidth=2,e.beginPath(),e.moveTo(10,50),e.lineTo(25,50),e.lineTo(40,50),e.lineTo(55,50),e.stroke(),e.fillStyle="#fff",e.beginPath(),e.arc(10,50,3,0,Math.PI*2),e.arc(25,50,3,0,Math.PI*2),e.arc(40,50,3,0,Math.PI*2),e.arc(55,50,3,0,Math.PI*2),e.fill());const o=new Image;o.src=t.toDataURL(),d.azure_ml=o}function rt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#0078d4",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Azure",18,15),e.font="bold 7px Arial",e.fillText("Data",20,28),e.fillText("Factory",16,38),e.strokeStyle="#fff",e.lineWidth=2,e.fillStyle="#fff",e.fillRect(8,45,8,6),e.beginPath(),e.moveTo(20,48),e.lineTo(35,48),e.stroke(),e.fillStyle="#ffd700",e.beginPath(),e.arc(35,48,4,0,Math.PI*2),e.fill(),e.strokeStyle="#fff",e.beginPath(),e.moveTo(39,48),e.lineTo(50,48),e.stroke(),e.fillStyle="#fff",e.fillRect(50,45,8,6));const o=new Image;o.src=t.toDataURL(),d.azure_data_factory=o}function ct(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){const n=e.createLinearGradient(0,0,0,64);n.addColorStop(0,"#1a202c"),n.addColorStop(1,"#2d3748"),e.fillStyle=n,e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Chatbot AI",5,12),e.fillStyle="#3182ce",e.fillRect(35,20,24,8),e.fillStyle="#fff",e.font="6px Arial",e.fillText("Hello!",38,26),e.fillStyle="#00d084",e.fillRect(5,32,30,8),e.fillStyle="#fff",e.fillText("How can I help?",7,38),e.fillStyle="#3182ce",e.fillRect(28,44,31,8),e.fillStyle="#fff",e.fillText("Recommend...",30,50),e.fillStyle="#ffd700",e.beginPath(),e.arc(12,58,6,0,Math.PI*2),e.fill(),e.fillStyle="#1a202c",e.beginPath(),e.arc(10,56,1,0,Math.PI*2),e.arc(14,56,1,0,Math.PI*2),e.fill(),e.strokeStyle="#1a202c",e.lineWidth=1,e.beginPath(),e.arc(12,58,3,0,Math.PI),e.stroke(),e.fillStyle="#9ca3af",e.font="6px Arial",e.fillText("●●●",45,58)}const o=new Image;o.src=t.toDataURL(),d.chatbot_ai=o}function ft(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#000000",e.fillRect(0,0,64,64),e.fillStyle="#86bc25",e.font="bold 9px Arial",e.fillText("Deloitte",12,20),e.font="bold 8px Arial",e.fillText("Consulting",8,32),e.fillStyle="#86bc25",e.beginPath(),e.arc(56,16,2,0,Math.PI*2),e.fill(),e.font="6px Arial",e.fillText("2022-2023",15,55));const o=new Image;o.src=t.toDataURL(),d.deloitte_consulting=o}function dt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Gantt Chart",5,12),e.fillStyle="#4a5568",e.fillRect(0,16,64,8),e.fillStyle="#fff",e.font="6px Arial",e.fillText("Q1",8,22),e.fillText("Q2",24,22),e.fillText("Q3",40,22),e.fillText("Q4",56,22),e.fillStyle="#3182ce",e.fillRect(6,28,18,4),e.fillStyle="#10b981",e.fillRect(14,36,24,4),e.fillStyle="#f59e0b",e.fillRect(32,44,20,4),e.fillStyle="#ef4444",e.fillRect(48,52,12,4),e.fillStyle="#86bc25",e.fillRect(6,28,12,4),e.fillRect(14,36,16,4),e.fillRect(32,44,8,4),e.strokeStyle="#dc2626",e.lineWidth=1,e.setLineDash([2,2]),e.beginPath(),e.moveTo(28,25),e.lineTo(28,58),e.stroke(),e.setLineDash([]));const o=new Image;o.src=t.toDataURL(),d.gantt_chart=o}function ht(){console.log("🔴 Creating R&D System Engineer visualization tiles..."),gt(),ut(),mt(),pt(),yt(),bt(),xt(),At(),wt(),vt(),kt(),St(),Tt(),It(),Rt(),Mt(),Pt(),console.log("✅ R&D System Engineer visualization tiles created")}function gt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("IR Spectrum",5,12),e.fillStyle="#ff4444",e.font="6px Arial",e.fillText("Hot",5,22),e.fillStyle="#4444ff",e.fillText("Cold",45,22);const n=e.createLinearGradient(0,25,64,25);n.addColorStop(0,"#000080"),n.addColorStop(.3,"#0080ff"),n.addColorStop(.5,"#00ff00"),n.addColorStop(.7,"#ffff00"),n.addColorStop(.9,"#ff8000"),n.addColorStop(1,"#ff0000"),e.fillStyle=n,e.fillRect(5,25,54,20),e.fillStyle="#fff",e.font="5px Arial",e.fillText("3-5μm",8,52),e.fillText("8-12μm",35,52),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(5,25,20,20),e.strokeRect(35,25,24,20)}const o=new Image;o.src=t.toDataURL(),d.ir_spectrum=o}function ut(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 7px Arial",e.fillText("Atmos Trans",5,12),e.strokeStyle="#666",e.lineWidth=1,e.beginPath(),e.moveTo(10,55),e.lineTo(58,55),e.moveTo(10,55),e.lineTo(10,20),e.stroke(),e.fillStyle="#aaa",e.font="5px Arial",e.fillText("λ(μm)",45,60),e.fillText("T%",2,25),e.strokeStyle="#00ff88",e.lineWidth=2,e.beginPath();const n=[{x:12,y:45},{x:16,y:35},{x:20,y:25},{x:24,y:25},{x:28,y:25},{x:32,y:45},{x:36,y:45},{x:40,y:25},{x:44,y:25},{x:48,y:25},{x:52,y:45},{x:56,y:50}];for(let a=0;a<n.length;a++)a===0?e.moveTo(n[a].x,n[a].y):e.lineTo(n[a].x,n[a].y);e.stroke(),e.fillStyle="rgba(0, 255, 136, 0.2)",e.fillRect(20,20,8,35),e.fillRect(40,20,8,35)}const o=new Image;o.src=t.toDataURL(),d.atmospheric_transmission=o}function mt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Multi-Cam",12,12),e.fillStyle="#444",e.beginPath(),e.arc(32,32,12,0,Math.PI*2),e.fill(),[{angle:0,color:"#ff4444"},{angle:Math.PI/2,color:"#44ff44"},{angle:Math.PI,color:"#4444ff"},{angle:3*Math.PI/2,color:"#ffff44"},{angle:Math.PI/4,color:"#ff44ff"},{angle:3*Math.PI/4,color:"#44ffff"}].forEach(a=>{const i=32+Math.cos(a.angle)*18,l=32+Math.sin(a.angle)*18;e.fillStyle=a.color,e.fillRect(i-3,l-3,6,6),e.strokeStyle=a.color,e.lineWidth=1,e.globalAlpha=.3,e.beginPath(),e.moveTo(i,l),e.arc(i,l,12,a.angle-Math.PI/6,a.angle+Math.PI/6),e.closePath(),e.stroke(),e.globalAlpha=1}),e.fillStyle="#fff",e.font="6px Arial",e.fillText("360°",26,58));const o=new Image;o.src=t.toDataURL(),d.multi_camera_array=o}function pt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#C8102E",e.fillRect(0,0,64,64),e.fillStyle="#ffffff",e.font="bold 12px Arial",e.textAlign="center",e.fillText("Leonardo",32,26),e.font="bold 10px Arial",e.fillText("SpA",32,42),e.font="8px Arial",e.fillText("2024 - present",32,56));const o=new Image;o.src=t.toDataURL(),d.leonardo_spa=o}function yt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Detection",8,12),e.fillStyle="#333",e.fillRect(5,18,54,40),[{x:15,y:25,w:12,h:8,conf:"0.92",color:"#00ff88"},{x:35,y:30,w:10,h:10,conf:"0.87",color:"#ffaa00"},{x:45,y:40,w:8,h:6,conf:"0.76",color:"#ff4444"}].forEach(a=>{e.fillStyle=a.color,e.globalAlpha=.6,e.fillRect(a.x+2,a.y+2,a.w-4,a.h-4),e.globalAlpha=1,e.strokeStyle=a.color,e.lineWidth=1,e.strokeRect(a.x,a.y,a.w,a.h),e.fillStyle=a.color,e.font="5px Arial",e.fillText(a.conf,a.x,a.y-1)}));const o=new Image;o.src=t.toDataURL(),d.object_detection=o}function bt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Kalman",15,12),e.strokeStyle="#4444ff",e.lineWidth=2,e.setLineDash([3,3]),e.beginPath(),e.moveTo(10,50),e.quadraticCurveTo(25,30,50,25),e.stroke(),e.setLineDash([]),e.fillStyle="#ff4444";const n=[{x:12,y:48},{x:20,y:38},{x:30,y:32},{x:42,y:28},{x:48,y:26}];n.forEach(a=>{e.beginPath(),e.arc(a.x,a.y,2,0,Math.PI*2),e.fill()}),e.strokeStyle="#00ff88",e.lineWidth=1,n.forEach((a,i)=>{const l=4+i*1.5;e.beginPath(),e.ellipse(a.x,a.y,l,l*.6,0,0,Math.PI*2),e.stroke()}),e.font="5px Arial",e.fillStyle="#4444ff",e.fillText("Pred",5,20),e.fillStyle="#ff4444",e.fillText("Meas",5,28),e.fillStyle="#00ff88",e.fillText("Uncert",5,36)}const o=new Image;o.src=t.toDataURL(),d.kalman_filter=o}function xt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Opt Flow",12,12),e.strokeStyle="#00ffaa",e.lineWidth=1;for(let n=15;n<55;n+=12)for(let a=20;a<55;a+=12){const i=(n-32)*.1+Math.sin(n*.1)*3,l=(a-35)*.1+Math.cos(a*.1)*2;e.beginPath(),e.moveTo(n,a),e.lineTo(n+i,a+l),e.stroke();const c=Math.atan2(l,i);e.beginPath(),e.moveTo(n+i,a+l),e.lineTo(n+i-3*Math.cos(c-Math.PI/6),a+l-3*Math.sin(c-Math.PI/6)),e.moveTo(n+i,a+l),e.lineTo(n+i-3*Math.cos(c+Math.PI/6),a+l-3*Math.sin(c+Math.PI/6)),e.stroke()}}const o=new Image;o.src=t.toDataURL(),d.optical_flow=o}function At(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("360° Warn",8,12),e.fillStyle="#444",e.beginPath(),e.arc(32,32,8,0,Math.PI*2),e.fill(),[{start:0,end:Math.PI/2,color:"#00ff88"},{start:Math.PI/2,end:Math.PI,color:"#ffaa00"},{start:Math.PI,end:3*Math.PI/2,color:"#ff4444"},{start:3*Math.PI/2,end:2*Math.PI,color:"#4488ff"}].forEach(a=>{e.fillStyle=a.color,e.globalAlpha=.3,e.beginPath(),e.moveTo(32,32),e.arc(32,32,25,a.start,a.end),e.closePath(),e.fill(),e.globalAlpha=1,e.strokeStyle=a.color,e.lineWidth=2,e.beginPath(),e.moveTo(32,32),e.lineTo(32+Math.cos(a.start)*25,32+Math.sin(a.start)*25),e.stroke()}),e.strokeStyle="#666",e.lineWidth=1,e.beginPath(),e.arc(32,32,15,0,Math.PI*2),e.stroke(),e.beginPath(),e.arc(32,32,25,0,Math.PI*2),e.stroke(),e.fillStyle="#aaa",e.font="5px Arial",e.fillText("20km",5,58),e.fillText("40km",45,58));const o=new Image;o.src=t.toDataURL(),d.coverage_360=o}function wt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Threats",15,12),e.strokeStyle="#00ff88",e.lineWidth=1,e.strokeRect(5,16,54,42),[{x:15,y:25,level:"HIGH",color:"#ff4444"},{x:35,y:30,level:"MED",color:"#ffaa00"},{x:45,y:40,level:"LOW",color:"#44ff44"}].forEach((a,i)=>{e.fillStyle=a.color,e.beginPath(),e.moveTo(a.x,a.y-3),e.lineTo(a.x-3,a.y+3),e.lineTo(a.x+3,a.y+3),e.closePath(),e.fill(),e.font="5px Arial",e.fillText(a.level,a.x-6,a.y+8),e.fillStyle="#aaa",e.font="4px Arial",e.fillText(`${15+i*5}km`,a.x-8,a.y+12),e.fillText(`${45+i*30}°`,a.x-6,a.y+16)}),e.fillStyle="#00ff88",e.fillRect(8,52,6,4),e.fillStyle="#fff",e.font="5px Arial",e.fillText("ACTIVE",16,55));const o=new Image;o.src=t.toDataURL(),d.threat_interface=o}function vt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("MTT",25,12),[{x:15,y:25,id:"T1",color:"#ff4444",history:[{x:10,y:30},{x:12,y:28},{x:15,y:25}]},{x:40,y:35,id:"T2",color:"#44ff44",history:[{x:35,y:30},{x:38,y:32},{x:40,y:35}]},{x:25,y:45,id:"T3",color:"#4444ff",history:[{x:20,y:50},{x:22,y:48},{x:25,y:45}]}].forEach(a=>{e.strokeStyle=a.color,e.lineWidth=1,e.globalAlpha=.5,e.beginPath(),a.history.forEach((i,l)=>{l===0?e.moveTo(i.x,i.y):e.lineTo(i.x,i.y)}),e.stroke(),e.globalAlpha=1,e.fillStyle=a.color,e.beginPath(),e.arc(a.x,a.y,3,0,Math.PI*2),e.fill(),e.font="6px Arial",e.fillText(a.id,a.x+5,a.y-2),e.strokeStyle=a.color,e.lineWidth=2,e.beginPath(),e.moveTo(a.x,a.y),e.lineTo(a.x+8,a.y-3),e.stroke()}),e.fillStyle="#fff",e.font="5px Arial",e.fillText("3 TRACKS",5,58));const o=new Image;o.src=t.toDataURL(),d.multi_target_tracking=o}function kt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#e97627",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 10px Arial",e.fillText("MATLAB",8,18),e.font="bold 8px Arial",e.fillText("Simulink",10,30),e.strokeStyle="#fff",e.fillStyle="rgba(255, 255, 255, 0.2)",e.lineWidth=1,e.fillRect(8,38,12,8),e.strokeRect(8,38,12,8),e.fillStyle="#fff",e.font="5px Arial",e.fillText("In",12,44),e.fillStyle="rgba(255, 255, 255, 0.2)",e.fillRect(25,36,14,12),e.strokeRect(25,36,14,12),e.fillStyle="#fff",e.fillText("Filter",27,43),e.fillStyle="rgba(255, 255, 255, 0.2)",e.fillRect(44,38,12,8),e.strokeRect(44,38,12,8),e.fillStyle="#fff",e.fillText("Out",47,44),e.strokeStyle="#fff",e.beginPath(),e.moveTo(20,42),e.lineTo(25,42),e.moveTo(39,42),e.lineTo(44,42),e.stroke(),e.font="6px Arial",e.fillText("R2023b",18,58));const o=new Image;o.src=t.toDataURL(),d.matlab_simulink=o}function St(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("IR System",8,12),[{x:8,y:18,w:16,h:8,label:"IR Sensor",color:"#ff4444"},{x:40,y:18,w:16,h:8,label:"ADC",color:"#44ff44"},{x:8,y:32,w:16,h:8,label:"DSP",color:"#4444ff"},{x:40,y:32,w:16,h:8,label:"CPU",color:"#ffaa00"},{x:24,y:46,w:16,h:8,label:"Display",color:"#aa44ff"}].forEach(a=>{e.fillStyle=a.color,e.globalAlpha=.3,e.fillRect(a.x,a.y,a.w,a.h),e.globalAlpha=1,e.strokeStyle=a.color,e.lineWidth=1,e.strokeRect(a.x,a.y,a.w,a.h),e.fillStyle="#fff",e.font="5px Arial",e.fillText(a.label,a.x+2,a.y+6)}),e.strokeStyle="#666",e.lineWidth=1,e.beginPath(),e.moveTo(24,22),e.lineTo(40,22),e.moveTo(16,26),e.lineTo(16,32),e.moveTo(48,26),e.lineTo(48,32),e.moveTo(24,36),e.lineTo(32,46),e.moveTo(40,36),e.lineTo(32,46),e.stroke());const o=new Image;o.src=t.toDataURL(),d.system_architecture=o}function Tt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Specs",18,12),e.strokeStyle="#666",e.lineWidth=1;const n=5,a=3,i=16,l=7,c=6,s=18;for(let f=0;f<=n;f++)e.beginPath(),e.moveTo(c,s+f*l),e.lineTo(c+a*i,s+f*l),e.stroke();for(let f=0;f<=a;f++)e.beginPath(),e.moveTo(c+f*i,s),e.lineTo(c+f*i,s+n*l),e.stroke();e.fillStyle="#4a5568",e.fillRect(c+1,s+1,a*i-2,l-2),[{r:1,c:0,color:"#00ff88"},{r:1,c:1,color:"#ffaa00"},{r:2,c:0,color:"#00ff88"},{r:2,c:2,color:"#ff4444"},{r:3,c:1,color:"#00ff88"}].forEach(f=>{e.fillStyle=f.color,e.globalAlpha=.6,e.fillRect(c+f.c*i+1,s+f.r*l+1,i-2,l-2),e.globalAlpha=1}),e.font="4px Arial",e.fillStyle="#00ff88",e.fillText("✓ PASS",6,58),e.fillStyle="#ff4444",e.fillText("✗ FAIL",30,58)}const o=new Image;o.src=t.toDataURL(),d.requirements_specs=o}function It(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("IR Detector",8,12),e.fillStyle="#444",e.fillRect(18,20,28,20),e.strokeStyle="#666",e.lineWidth=1,e.strokeRect(18,20,28,20),e.fillStyle="#2a2a2a",e.beginPath(),e.arc(32,30,8,0,Math.PI*2),e.fill(),e.strokeStyle="#888",e.stroke(),e.strokeStyle="#666",e.lineWidth=.5,e.beginPath(),e.arc(32,30,6,0,Math.PI*2),e.stroke(),e.beginPath(),e.arc(32,30,4,0,Math.PI*2),e.stroke(),e.strokeStyle="#666",e.lineWidth=1;for(let n=0;n<5;n++){const a=20+n*5;e.beginPath(),e.moveTo(a,42),e.lineTo(a,48),e.stroke()}e.fillStyle="#aaa",e.font="5px Arial",e.fillText("MWIR/LWIR",15,52),e.fillText("InSb/MCT",18,58),e.fillStyle="#d4af37";for(let n=0;n<3;n++)e.fillRect(46+n*2,35,1,4)}const o=new Image;o.src=t.toDataURL(),d.ir_detector=o}function Rt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#6e6e6e",e.fillRect(0,0,64,64);const n=16,a=8,i=1;e.fillStyle="#5a5a5a";for(let l=0;l<64;l+=a+i)e.fillRect(0,l,64,i);for(let l=0;l<Math.ceil(64/(a+i));l++){const c=l*(a+i),s=l%2*(n/2);for(let r=s;r<64+n;r+=n+i)e.fillRect(r,c,i,a+i)}e.globalAlpha=.1;for(let l=0;l<Math.ceil(64/(a+i));l++)for(let c=0;c<Math.ceil(64/(n+i));c++){const s=c*(n+i)+l%2*(n/2),r=l*(a+i),f=Math.random()*.3-.15;e.fillStyle=f>0?"#ffffff":"#000000",e.fillRect(s+i,r+i,n-i,a-i)}e.globalAlpha=1,e.fillStyle="rgba(0, 0, 0, 0.1)",e.fillRect(62,0,2,64),e.fillRect(0,62,64,2)}const o=new Image;o.src=t.toDataURL(),d.brick_wall=o}function Mt(){[{name:"flag_au",code:"AU",colors:["#012169","#ffffff","#ff0000"]},{name:"flag_us",code:"US",colors:["#b22234","#ffffff","#3c3b6e"]},{name:"flag_jp",code:"JP",colors:["#ffffff","#bc002d"]},{name:"flag_vn",code:"VN",colors:["#da251d","#ffff00"]},{name:"flag_mv",code:"MV",colors:["#d21034","#007e3a","#ffffff"]},{name:"flag_it",code:"IT",colors:["#009246","#ffffff","#ce2b37"]},{name:"flag_fr",code:"FR",colors:["#0055a4","#ffffff","#ef4135"]},{name:"flag_de",code:"DE",colors:["#000000","#dd0000","#ffce00"]},{name:"flag_es",code:"ES",colors:["#aa151b","#f1bf00","#aa151b"]},{name:"flag_gb",code:"GB",colors:["#012169","#ffffff","#c8102e"]},{name:"flag_nl",code:"NL",colors:["#21468b","#ffffff","#ae1c28"]},{name:"flag_ch",code:"CH",colors:["#ff0000","#ffffff"]},{name:"flag_ma",code:"MA",colors:["#c1272d","#006233"]},{name:"flag_eg",code:"EG",colors:["#ce1126","#ffffff","#000000"]}].forEach(e=>{const o=document.createElement("canvas");o.width=64,o.height=64;const n=o.getContext("2d");if(n){if(n.fillStyle=e.colors[0],n.fillRect(0,0,64,64),e.colors.length>=2)if(e.code==="IT"||e.code==="FR"||e.code==="NL")n.fillStyle=e.colors[1],n.fillRect(21,0,22,64),e.colors[2]&&(n.fillStyle=e.colors[2],n.fillRect(43,0,21,64));else if(e.code==="DE"||e.code==="EG")n.fillStyle=e.colors[1],n.fillRect(0,21,64,22),e.colors[2]&&(n.fillStyle=e.colors[2],n.fillRect(0,43,64,21));else if(e.code==="US"){n.fillStyle=e.colors[1],n.fillRect(0,0,64,64),n.fillStyle=e.colors[0];for(let i=0;i<7;i++)n.fillRect(0,i*10+2,64,5);n.fillStyle=e.colors[2],n.fillRect(0,0,28,36),n.fillStyle=e.colors[1],n.font="4px Arial";for(let i=0;i<5;i++)for(let l=0;l<6;l++)(i+l)%2===0&&n.fillText("★",3+l*4,6+i*6)}else if(e.code==="AU"){n.fillStyle=e.colors[0],n.fillRect(0,0,64,64);const i=32,l=32;n.fillStyle=e.colors[1],n.fillRect(0,0,i,l),n.fillStyle=e.colors[0],n.fillRect(0,0,i,l),n.fillStyle=e.colors[1],n.lineWidth=4,n.beginPath(),n.moveTo(0,0),n.lineTo(i,l),n.moveTo(0,l),n.lineTo(i,0),n.stroke(),n.fillStyle=e.colors[1],n.fillRect(0,l/2-2,i,4),n.fillRect(i/2-2,0,4,l),n.fillStyle=e.colors[2],n.fillRect(0,l/2-1,i,2),n.fillRect(i/2-1,0,2,l),n.strokeStyle=e.colors[2],n.lineWidth=2,n.beginPath(),n.moveTo(2,0),n.lineTo(i,l-2),n.moveTo(0,2),n.lineTo(i-2,l),n.moveTo(i-2,0),n.lineTo(0,l-2),n.moveTo(i,2),n.lineTo(2,l),n.stroke(),n.fillStyle=e.colors[1],n.font="6px Arial",n.fillText("★",40,20),n.fillText("★",50,30),n.fillText("★",45,40),n.fillText("★",55,50),n.fillText("★",35,55)}else e.code==="GB"?(n.fillStyle=e.colors[0],n.fillRect(0,0,64,64),n.fillStyle=e.colors[1],n.fillRect(0,28,64,8),n.fillRect(28,0,8,64),n.fillStyle=e.colors[2],n.fillRect(0,30,64,4),n.fillRect(30,0,4,64)):e.code==="JP"?(n.fillStyle=e.colors[0],n.fillRect(0,0,64,64),n.fillStyle=e.colors[1],n.beginPath(),n.arc(32,32,16,0,Math.PI*2),n.fill()):e.code==="ES"?(n.fillStyle=e.colors[0],n.fillRect(0,0,64,16),n.fillStyle=e.colors[1],n.fillRect(0,16,64,32),n.fillStyle=e.colors[2],n.fillRect(0,48,64,16)):e.code==="CH"?(n.fillStyle=e.colors[0],n.fillRect(0,0,64,64),n.fillStyle=e.colors[1],n.fillRect(0,24,64,16),n.fillRect(24,0,16,64)):(n.fillStyle=e.colors[1],n.fillRect(0,32,64,32));n.fillStyle="#000000",n.font="bold 8px Arial",n.textAlign="center",n.strokeStyle="#ffffff",n.lineWidth=2,n.strokeText(e.code,32,58),n.fillText(e.code,32,58)}const a=new Image;a.src=o.toDataURL(),d[e.name]=a})}function Pt(){console.log("🎯 Creating Boss Room tiles..."),Et(),Ct(),console.log("✅ Boss Room tiles created")}function Et(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#228B22",e.fillRect(0,0,64,64);const n=d.main_guy_sprite_sheet;n?e.drawImage(n,0,0,36,36,5,5,54,54):(e.fillStyle="#fff",e.font="12px Arial",e.textAlign="center",e.fillText("BOSS",32,35))}const o=new Image;o.src=t.toDataURL(),d.main_guy=o}function Ct(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#228B22",e.fillRect(0,0,64,64),[{x:15,y:20,color:"#ff69b4",size:4},{x:35,y:15,color:"#ffd700",size:3},{x:45,y:35,color:"#ff6347",size:4},{x:20,y:45,color:"#9370db",size:3},{x:50,y:50,color:"#00ced1",size:3}].forEach(a=>{e.fillStyle=a.color;for(let i=0;i<5;i++){const l=i*Math.PI*2/5,c=a.x+Math.cos(l)*a.size,s=a.y+Math.sin(l)*a.size;e.beginPath(),e.arc(c,s,a.size/2,0,Math.PI*2),e.fill()}e.fillStyle="#ffff00",e.beginPath(),e.arc(a.x,a.y,a.size/3,0,Math.PI*2),e.fill(),e.strokeStyle="#228b22",e.lineWidth=1,e.beginPath(),e.moveTo(a.x,a.y+a.size/3),e.lineTo(a.x,a.y+a.size+2),e.stroke()}));const o=new Image;o.src=t.toDataURL(),d.flower=o}function Ae(){return d}te.getAssets=Ae;const ie=32,le=32,z=64;function Dt(){const t=te.getAssets().player_sprite_sheet;function e(o,n){const a=document.createElement("canvas");a.width=z,a.height=z;const i=a.getContext("2d");if(!i)throw new Error("Failed to get 2D context");return i.drawImage(t,n*ie,o*le,ie,le,0,0,z,z),a}m.down_walk.push(e(0,0)),m.right_walk.push(e(1,1)),m.up_walk.push(e(2,1)),m.down_idle.push(m.down_walk[0]),m.right_idle.push(m.right_walk[0]),m.up_idle.push(m.up_walk[0])}let T=!1,C=null;const se={x:5,y:1},_t=1;function Lt(){Bt(),console.log("Boss interaction system initialized")}function Bt(){C=document.createElement("div"),C.id="boss-interaction-prompt",C.style.cssText=`
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 15px 25px;
    border-radius: 12px;
    font-family: Arial, sans-serif;
    font-size: 18px;
    font-weight: bold;
    display: none;
    z-index: 1500;
    border: 3px solid #FFD700;
    text-align: center;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.7);
    animation: pulse 2s infinite;
  `;const t=document.createElement("style");t.textContent=`
    @keyframes pulse {
      0% { border-color: #FFD700; }
      50% { border-color: #FFA500; }
      100% { border-color: #FFD700; }
    }
  `,document.head.appendChild(t),C.innerHTML=`
    <div>💬 Press SPACE to talk to Nicolo</div>
    <div style="font-size: 14px; margin-top: 5px; opacity: 0.8;">Ask questions about my CV and experience!</div>
  `,document.body.appendChild(C)}function Ut(){if(ee().id!=="room2")return T&&re(),!1;const o=Math.abs(h.x-se.x)+Math.abs(h.y-se.y)<=_t;return o&&!T?(Ft(),T=!0,console.log("Player is near boss - showing interaction prompt")):!o&&T&&(re(),T=!1,console.log("Player left boss proximity - hiding prompt")),o}function Ft(){me("💬 Press SPACE to talk to Nicolo - Ask about my CV!",4e3)}function re(){const t=document.getElementById("status-text");t&&t.textContent?.includes("talk to Nicolo")&&(t.textContent="")}function Nt(){return T}const Wt="modulepreload",zt=function(t){return"/MyImmersiveExperience/"+t},ce={},jt=function(e,o,n){let a=Promise.resolve();if(o&&o.length>0){let s=function(r){return Promise.all(r.map(f=>Promise.resolve(f).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");a=s(o.map(r=>{if(r=zt(r),r in ce)return;ce[r]=!0;const f=r.endsWith(".css"),g=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${g}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":Wt,f||(y.as="script"),y.crossOrigin="",y.href=r,c&&y.setAttribute("nonce",c),document.head.appendChild(y),f)return new Promise((Q,G)=>{y.addEventListener("load",Q),y.addEventListener("error",()=>G(new Error(`Unable to preload CSS for ${r}`)))})}))}function i(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})};let x=null,M=!1,A="",k="",b=null,Yt=null,v={},R={distilbert:"pending",qwen:"pending"},p=null;const O={distilbert:{name:"Xenova/distilbert-base-cased-distilled-squad",description:"DistilBERT model optimized for question-answering",size:"~65MB",type:"qa"},qwen:{name:"onnx-community/Qwen2.5-0.5B-Instruct",description:"Qwen 2.5 0.5B Instruct - Small conversational language model",size:"~500MB",type:"chat"}},q={preferredModel:"distilbert",fallbackModels:["distilbert"],enableModelFallback:!0,useOnlyFallback:!1},u={personalInfo:`
    Nicolo Pedrani is a professional with experience in Data Science and R&D System Engineering.
    He has worked in consulting, analytics, and infrared defense systems.
    
    Personal interests and hobbies:
    - Football: Passionate about playing and watching football, enjoys both recreational games and following professional leagues
    - Extensive Travel: Has visited 14 countries across 4 continents including Italy, France, Germany, United States, Japan, Australia, Vietnam, Maldives, Spain, United Kingdom, Netherlands, Switzerland, Morocco, and Egypt
    - Reading: Enjoys reading technical literature, business books, and staying updated with industry trends
    - Cultural exploration: Through travel experiences has gained appreciation for different cultures, cuisines, and perspectives
    - Sports and fitness: Maintains active lifestyle through football and other physical activities
    - International perspective: Travel experiences have provided global mindset and cultural adaptability valuable in professional settings
  `,workExperience:`
    Deloitte Consulting - Data Science Experience:
    - NPS (Net Promoter Score) analysis and customer satisfaction analytics
    - Energy cost optimization projects
    - Fashion retail time series analysis and forecasting
    - Supply chain and distribution network mapping
    - Statistical analysis including forecast histograms and box plot analysis
    - Power BI dashboard development for business intelligence
    - Advanced analytics using Python and scikit-learn
    - Machine learning projects with PyTorch and LangChain
    - Recommendation system development
    - Azure Machine Learning and Azure Data Factory implementation
    - AI chatbot development
    - Project management with Gantt charts and timeline planning

    Leonardo SpA - R&D System Engineer Experience:
    - Infrared (IR) spectrum visualization and analysis
    - Atmospheric transmission modeling and analysis
    - Multi-camera array positioning systems
    - Object detection with bounding boxes using computer vision
    - Kalman filter implementation for state estimation
    - Optical flow motion vector analysis
    - 360-degree missile warning coverage systems
    - Threat detection interface development
    - Multiple target tracking systems
    - MATLAB and Simulink development
    - IR system architecture design
    - Requirements specification and documentation
    - IR detector hardware integration
  `,education:`
    Technical background in Data Science, Machine Learning, and System Engineering.
    Expertise in statistical analysis, computer vision, and defense systems.
  `,skills:`
    Programming: Python, MATLAB, TypeScript, JavaScript
    Data Science: scikit-learn, PyTorch, statistical analysis, time series forecasting
    Machine Learning: LangChain, recommendation systems, predictive modeling
    Cloud Platforms: Azure Machine Learning, Azure Data Factory
    Business Intelligence: Power BI, dashboard development
    Computer Vision: Object detection, optical flow, Kalman filtering
    Defense Systems: Infrared systems, missile warning systems, threat detection
    Project Management: Agile methodologies, Gantt charts
    Tools: MATLAB/Simulink, Git, various analytics platforms
  `,projects:`
    - Customer satisfaction analytics using NPS methodology
    - Energy cost optimization for large enterprises
    - Fashion retail demand forecasting using time series analysis
    - Supply chain optimization and network analysis
    - Interactive portfolio game (current project) using TypeScript and HTML5 Canvas
    - AI-powered chatbot development
    - Infrared detection and tracking systems
    - Multi-camera surveillance systems
    - Real-time threat detection and tracking
  `};async function fe(t){const e=O[t];if(!e||!b)return console.error(`❌ Model key invalid or transformers not loaded: ${t}`),R[t]="error",!1;try{console.log(`🔄 Background loading ${t} model: ${e.name}`),R[t]="loading",p&&p(t,"loading",0);const o=e.type==="chat"?"text-generation":"question-answering",n={device:"webgpu",progress_callback:i=>{if(i.status==="downloading"){const l=Math.min(i.loaded?Math.floor(i.loaded/1048576):0,90);console.log(`📥 Background downloading ${t}: ~${l}MB loaded...`),p&&p(t,"downloading",l)}else i.status==="loading"&&(console.log(`🧠 Loading ${t} model into memory...`),p&&p(t,"finalizing",95))}};n.dtype="q4";const a=await b.pipeline(o,e.name,n);return v[t]={pipeline:a,modelInfo:e,loadTime:Date.now()},R[t]="completed",console.log(`✅ Background loading of ${t} completed!`),p&&p(t,"completed",100),!0}catch(o){return console.error(`❌ Failed to background load ${t} model:`,o),R[t]="error",p&&p(t,"error",0),!1}}async function Ot(t){const e=O[t];if(!e||!b)return console.error(`❌ Model key invalid or transformers not loaded: ${t}`),!1;try{console.log(`🤖 Loading ${t} model: ${e.name}`),console.log(`📦 Model info: ${e.description} (${e.size})`);const o=e.type==="chat"?"text-generation":"question-answering",n={device:"webgpu",progress_callback:i=>{if(i.status==="downloading"){const l=Math.round(i.progress||0),c=i.loaded||0,s=i.total||0,r=s-c;let f="";if(i.rate&&i.rate>0){const P=(i.rate/1048576).toFixed(1),N=r>0?Math.round(r/i.rate):0;f=` | ${P} MB/s | ${N}s remaining`}const g=P=>{if(P===0)return"0 B";const N=1024,Se=["B","KB","MB","GB"],oe=Math.floor(Math.log(P)/Math.log(N));return parseFloat((P/Math.pow(N,oe)).toFixed(1))+" "+Se[oe]},y=g(c),Q=g(s),G=g(r);console.log(`📥 Downloading ${t} model: ${l}% (${y}/${Q}, ${G} left)${f}`)}else i.status==="loading"&&console.log(`🧠 Loading ${t} model into memory...`)}};n.dtype="q4",x=await b.pipeline(o,e.name,n),console.log(`🧪 Testing ${t} model...`);let a;if(e.type==="chat"){let i;try{const l=[{role:"system",content:"You are a helpful assistant."},{role:"user",content:"What is your name?"}];i=x.tokenizer.apply_chat_template(l,{tokenize:!1,add_generation_prompt:!0})}catch{t==="qwen"?i=`<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
What is your name?<|im_end|>
<|im_start|>assistant
`:i=`System: You are a helpful assistant.
User: What is your name?
Assistant:`}if(a=await x(i,{max_new_tokens:20,do_sample:!1,return_full_text:!1}),console.log(`🔍 ${t} chat test result:`,a),!a||!a[0]?.generated_text||a[0].generated_text.length<3)return console.warn(`⚠️ ${t} model test failed`),!1}else if(a=await x("What is the name?","The name is Nicolo Pedrani. He is a professional."),console.log(`🔍 ${t} Q&A test result:`,a),!a.answer||a.score<.01)return console.warn(`⚠️ ${t} model test failed`),!1;return console.log(`✅ ${t} model test successful!`),A=`${t} (${e.name})`,k=e.type,console.log(`🔄 Model switched to: ${A}`),console.log(`📝 Model type: ${k}`),!0}catch(o){return console.error(`❌ Failed to load ${t} model:`,o),!1}}async function Qt(){try{console.log("🔧 Checking AI system initialization..."),q.useOnlyFallback;const t=q.preferredModel;return v[t]&&R[t]==="completed"?(console.log(`⚡ Using preloaded ${t} model for initialization!`),x=v[t].pipeline,A=`${t} (${v[t].modelInfo.name})`,k=v[t].modelInfo.type,M=!0,console.log(`✅ AI system ready with preloaded ${t}!`),console.log(`📋 Active model: ${A}`),!0):(console.log("🔄 No preloaded models available, using fallback responses for now"),M=!1,A="Loading in background...",k="fallback",!0)}catch(t){return console.error("💥 AI initialization error:",t),console.log("🔄 Falling back to scripted responses"),M=!1,A="Fallback System",k="fallback",!0}}function V(){const t=A.match(/^(\w+)\s*\(/);return t?t[1]:q.preferredModel}async function Gt(t){if(!O[t])return console.error(`❌ Invalid model key: ${t}. Available: ${Object.keys(O).join(", ")}`),!1;if(console.log(`🔄 Switching to ${t} model...`),v[t]&&R[t]==="completed")return console.log(`⚡ Using preloaded ${t} model - instant switch!`),x=v[t].pipeline,A=`${t} (${v[t].modelInfo.name})`,k=v[t].modelInfo.type,M=!0,console.log(`✅ Instantly switched to preloaded ${t} model!`),console.log(`🔄 Model switched to: ${A}`),console.log(`📝 Model type: ${k}`),!0;{console.log(`🔄 Model not preloaded, loading ${t} now...`);const e=await Ot(t);return e?(M=!0,console.log(`✅ Successfully switched to ${t} model!`)):console.error(`❌ Failed to switch to ${t} model`),e}}async function Ht(t){try{if((!x||!M)&&(console.log("🔄 AI pipeline not ready, attempting to initialize..."),!await Qt().catch(l=>(console.error("❌ Failed to initialize AI:",l),!1))))return"I'm sorry, the AI system is currently unavailable on this device. Please try again or switch to desktop.";const e=Jt(t);if(console.log("🔍 Context Selection:",{question:t,contextPreview:e.substring(0,200)+"...",contextLength:e.length}),!e)return"I'd be happy to answer questions about my professional experience, skills, projects, or background. Could you please ask something more specific about my CV or career?";let o;if(k==="chat"){const i=[{role:"system",content:`You ARE Nicolo Pedrani. You are NOT an AI assistant. You are a real person with real experiences. Never say "As an AI" or mention being an AI language model.

You are Nicolo Pedrani, a professional Data Scientist and R&D System Engineer with actual work experience at Deloitte and Leonardo SpA. When asked about YOUR experiences, talk about them in first person as if they are YOUR real professional background.

Your background: ${e}

IMPORTANT: Always respond as Nicolo Pedrani in first person (I, my, me). Keep responses to 2-3 clear sentences. Be direct and professional. Never break character or mention being an AI.`},{role:"user",content:t}];let l;try{l=x.tokenizer.apply_chat_template(i,{tokenize:!1,add_generation_prompt:!0})}catch{console.log("Chat template not available, using Qwen-specific format"),V()==="qwen"?l=`<|im_start|>system
You ARE Nicolo Pedrani. You are NOT an AI assistant. You are a real person with real experiences. Never say "As an AI" or mention being an AI language model.

You are Nicolo Pedrani, a professional Data Scientist and R&D System Engineer with actual work experience at Deloitte and Leonardo SpA. When asked about YOUR experiences, talk about them in first person as if they are YOUR real professional background.

Your background: ${e}

IMPORTANT: Always respond as Nicolo Pedrani in first person (I, my, me). Keep responses to 2-3 clear sentences. Be direct and professional. Never break character or mention being an AI.<|im_end|>
<|im_start|>user
${t}<|im_end|>
<|im_start|>assistant
`:l=`System: You ARE Nicolo Pedrani. You are NOT an AI assistant. You are a real person with real experiences. Never say "As an AI" or mention being an AI language model.

You are Nicolo Pedrani, a professional Data Scientist and R&D System Engineer with actual work experience at Deloitte and Leonardo SpA. When asked about YOUR experiences, talk about them in first person as if they are YOUR real professional background.

Your background: ${e}

IMPORTANT: Always respond as Nicolo Pedrani in first person (I, my, me). Keep responses to 2-3 clear sentences. Be direct and professional. Never break character or mention being an AI.

User: ${t}
Assistant: `}o={answer:(await x(l,{max_new_tokens:80,do_sample:!1,return_full_text:!1,temperature:.1}))[0]?.generated_text?.trim()||"",score:1}}else try{o=await x(t,e)}catch(i){return console.error("❌ Pipeline execution failed:",i),"I encountered an error processing your question. This might be due to device limitations. Please try a simpler question or use desktop."}console.log("🤖 AI Model Result:",{model:A,question:t,answer:o.answer,score:o.score,contextLength:e.length});const n=o.answer?.trim();let a="";if(n&&n.length>5&&o.score>.1)a=de(n,t);else{console.log("⚠️ AI model returned poor answer, using fallback");const i=qt(t);a=de(i,t)}return a||"I don't have specific information about that topic in my experience. Could you ask about my work at Deloitte, Leonardo SpA, or my technical skills?"}catch(e){return console.error("Error processing question:",e),"I apologize, but I'm having trouble processing your question right now. Please try rephrasing it or ask about my work experience, skills, or projects."}}function Jt(t){const e=t.toLowerCase();let o=[];const n=["work","job","experience","career","deloitte","leonardo","consulting","engineer","project","company","professional","employment"],a=["skill","technology","programming","python","matlab","machine learning","ai","data science","technical","expertise","tools","software"],i=["education","study","learn","degree","qualification","university","school","training"],l=["hobby","hobbies","travel","football","personal","interest","country","countries","visit","visited","fun","free time","leisure","sports","reading","books"],c=["project","projects","build","built","create","created","develop","developed","system","application","portfolio"],s=["travel","traveling","travelled","country","countries","visit","visited","culture","cultural","international","abroad","trip","vacation"],r=["football","soccer","sport","sports","play","playing","game","games","team","athletic"];n.some(f=>e.includes(f))&&o.push(u.workExperience),a.some(f=>e.includes(f))&&o.push(u.skills),i.some(f=>e.includes(f))&&o.push(u.education),(l.some(f=>e.includes(f))||s.some(f=>e.includes(f))||r.some(f=>e.includes(f)))&&o.push(u.personalInfo),c.some(f=>e.includes(f))&&o.push(u.projects),s.some(f=>e.includes(f))&&(o=[u.personalInfo,...o.filter(f=>f!==u.personalInfo)]),r.some(f=>e.includes(f))&&(o=[u.personalInfo,...o.filter(f=>f!==u.personalInfo)]),o.length===0&&(o=[u.workExperience,u.personalInfo,u.skills]);{const f=o.slice(0,2).join(" ").replace(/\n+/g," ").trim();return console.log("🔍 Using TARGETED context:",f.length,"characters"),f.length>800?f.substring(0,800)+"...":f}}function de(t,e){let o=t.trim();if(o.length>100)return o;const n=e.toLowerCase();if(n.includes("deloitte")&&!o.includes("Deloitte"))o+=o?" ":"",o+="At Deloitte, I focused on data science consulting, working with various analytics tools and helping clients optimize their business processes through data-driven insights.";else if(n.includes("leonardo")&&!o.includes("Leonardo"))o+=" At Leonardo SpA, I specialized in R&D for infrared and defense systems, working on cutting-edge technology for threat detection and tracking in mission-critical applications.";else if(n.includes("skill")||n.includes("technology"))o+=" I'm passionate about staying current with emerging technologies and applying them to solve complex problems across business and technical domains.";else if(n.includes("project"))o+=" I enjoy tackling diverse projects that challenge me to combine technical expertise with creative problem-solving approaches.";else if(n.includes("football")||n.includes("soccer")){const a=[" Football has been a lifelong passion - I love both playing recreationally and following professional leagues. It's taught me valuable lessons about teamwork and strategy."," Playing football keeps me active and helps me unwind from technical work. There's something special about the team dynamics and strategic thinking involved."," I've always been drawn to football for its combination of physical skill and tactical intelligence. It's a great way to stay fit and connect with people."];o+=a[Math.floor(Math.random()*a.length)]}else if(n.includes("travel")||n.includes("country")||n.includes("visit")){const a=[" Traveling has been incredibly enriching - each of the 14 countries I've visited has taught me something new about different cultures and perspectives."," My travel experiences across 4 continents have given me a global mindset that's valuable in today's interconnected world. From the technology hubs of Japan to the ancient cultures of Morocco."," I believe travel is one of the best forms of education. Each destination - whether it's the innovation in Australia or the efficiency in Germany - offers unique insights."," Exploring different countries has shaped my worldview and made me more adaptable. It's fascinating to see how different cultures approach similar challenges."];o+=a[Math.floor(Math.random()*a.length)]}else if(n.includes("reading")||n.includes("book")){const a=[" Reading helps me stay current with industry trends and broaden my perspective beyond just technical topics."," I enjoy reading both technical literature and books on business strategy - it helps me see the bigger picture in my work."," Books have always been a great way for me to learn new concepts and stay intellectually curious."];o+=a[Math.floor(Math.random()*a.length)]}else if(n.includes("hobby")||n.includes("personal")||n.includes("interest")){const a=[" My hobbies - football, travel, and reading - all contribute to who I am professionally. They've taught me teamwork, cultural awareness, and continuous learning."," I believe having diverse interests outside of work makes me a more well-rounded person and professional. Each hobby brings something unique to the table."," Balancing technical work with active hobbies like football and enriching experiences like travel helps me maintain creativity and fresh perspectives."];o+=a[Math.floor(Math.random()*a.length)]}return o}const D={deloitte:["At Deloitte Consulting, I worked on fascinating data science projects including NPS analysis, energy cost optimization, and fashion retail forecasting. I also developed AI chatbots and recommendation systems.","My time at Deloitte was focused on data science consulting, where I helped clients optimize their business processes through analytics. I worked with tools like Power BI and developed various ML solutions.","At Deloitte, I specialized in business analytics and data science. Some highlights include working on customer satisfaction analytics, supply chain optimization, and developing advanced forecasting models."],leonardo:["At Leonardo SpA, I was an R&D System Engineer working on cutting-edge infrared and defense systems. My work involved missile warning coverage, object detection, and multi-target tracking using advanced computer vision.","Leonardo SpA was where I dove deep into defense technology - specifically infrared systems for threat detection. I worked with MATLAB/Simulink on everything from atmospheric transmission modeling to Kalman filtering.","My R&D role at Leonardo involved developing sophisticated defense systems. I worked on 360-degree missile warning coverage, optical flow analysis, and multi-camera positioning systems for threat detection."],skills:["My technical skills span both data science and systems engineering: Python, MATLAB, machine learning, computer vision, and cloud platforms like Azure. I also have experience with Power BI and various analytics tools.","I work with a diverse tech stack including Python for data science, MATLAB for system modeling, and cloud platforms like Azure ML. My experience covers everything from statistical analysis to computer vision.","My expertise includes programming in Python and MATLAB, machine learning with PyTorch and scikit-learn, cloud computing with Azure, and business intelligence with Power BI. I enjoy working across the full technology stack."],football:["Football is one of my biggest passions! I love both playing recreationally with friends and following professional leagues. It's taught me valuable lessons about teamwork, strategy, and maintaining physical fitness.","I've been passionate about football since I was young. Whether I'm playing a casual game or watching the professionals, I love the combination of physical skill, tactical thinking, and team dynamics.","Football keeps me active and helps me unwind from technical work. There's something special about the sport's blend of individual skill and team strategy that I find really engaging."],travel:["I've been fortunate to travel to 14 countries across 4 continents - from the tech innovation in Japan and Australia to the rich cultures of Morocco and Vietnam. Each destination has broadened my perspective.","My travel experiences have taken me everywhere from the ancient cultures of Egypt to the modern efficiency of Germany. Visiting places like Japan, Maldives, and various European countries has given me a global mindset.","Traveling has been incredibly enriching - whether exploring the technological landscapes of Australia and Japan or the cultural heritage of Morocco and Egypt. Each country teaches you something new about approaching challenges."]};function qt(t){const e=t.toLowerCase();if(e.includes("deloitte")){const o=D.deloitte;return o[Math.floor(Math.random()*o.length)]}else if(e.includes("leonardo")){const o=D.leonardo;return o[Math.floor(Math.random()*o.length)]}else if(e.includes("skill")||e.includes("technology")){const o=D.skills;return o[Math.floor(Math.random()*o.length)]}else if(e.includes("football")||e.includes("soccer")){const o=D.football;return o[Math.floor(Math.random()*o.length)]}else if(e.includes("travel")||e.includes("country")||e.includes("visit")){const o=D.travel;return o[Math.floor(Math.random()*o.length)]}else return e.includes("experience")||e.includes("work")?"I have experience in both Data Science consulting at Deloitte and R&D System Engineering at Leonardo SpA. I've worked on projects ranging from business analytics and machine learning to infrared defense systems and computer vision.":e.includes("reading")||e.includes("book")?"I'm an avid reader who enjoys both technical literature and business books. Reading helps me stay current with industry trends and broaden my perspective beyond just technical topics.":e.includes("hobby")||e.includes("personal")||e.includes("interest")?"My main hobbies are football, traveling, and reading. These interests have shaped me both personally and professionally - football taught me teamwork, travel gave me cultural awareness, and reading keeps me intellectually curious.":e.includes("culture")||e.includes("international")?"My international travel experiences have given me a global perspective that's valuable in today's interconnected world. I've experienced everything from the tech innovation in Japan to the rich history of Morocco.":"I'm a professional with diverse experience in data science consulting and R&D engineering. Feel free to ask about my work at Deloitte, Leonardo SpA, my technical skills, my hobbies, or my travel experiences!"}function Vt(t){p=t}async function $t(){if(!b){console.log("🔧 Loading Transformers.js before starting background loading...");try{b=await jt(()=>import("https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.7.1"),[]),console.log("✅ Transformers.js loaded for background loading"),b.env&&(b.env.allowRemoteModels=!0,b.env.allowLocalModels=!1,b.env.useBrowserCache=!0)}catch(t){console.error("❌ Failed to load transformers for background loading:",t);return}}console.log("🚀 Starting background model preloading..."),fe("distilbert").then(t=>{t?(console.log("🎯 DistilBERT preloaded successfully! Starting Qwen preloading..."),fe("qwen").then(e=>{console.log(e?"🎉 All models preloaded successfully!":"⚠️ Qwen preloading failed, but DistilBERT is ready")})):console.log("⚠️ DistilBERT preloading failed, skipping Qwen")})}class Xt{state={isActive:!1,currentState:"input",currentResponse:""};messageArea=null;statusBar=null;modelSelector=null;inputArea=null;responseArea=null;textInput=null;closeButton=null;constructor(){this.initialize()}initialize(){if(this.statusBar=document.getElementById("status-bar"),!this.statusBar){console.error("Status bar not found");return}this.createMessageArea()}createMessageArea(){this.messageArea=document.createElement("div"),this.messageArea.id="gameboy-message-area",this.messageArea.style.cssText=`
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      color: #000;
      border: 2px solid #0a0a0a;
      border-bottom: none;
      border-radius: 8px 8px 0 0;
      font-family: 'Courier New', monospace;
      font-weight: bold;
      font-size: 14px;
      height: 0;
      overflow: hidden;
      transition: height 0.3s ease-in-out;
      z-index: 10;
      display: none;
    `,this.modelSelector=document.createElement("select"),this.modelSelector.id="conversation-model-selector",this.modelSelector.style.cssText=`
      position: absolute;
      top: 8px;
      left: 8px;
      background: #f0f0f0;
      color: #000;
      border: 1px solid #333;
      border-radius: 4px;
      padding: 2px 4px;
      font-size: 10px;
      font-family: 'Courier New', monospace;
      font-weight: bold;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.3s ease;
    `,this.modelSelector.innerHTML=`
      <option value="distilbert">❓ DistilBERT Q&A</option>
      <option value="qwen">💬 Qwen2.5 Chat</option>
    `,this.closeButton=document.createElement("button"),this.closeButton.id="conversation-close-button",this.closeButton.textContent="✕",this.closeButton.style.cssText=`
      position: absolute;
      top: 8px;
      right: 8px;
      background: #f44336;
      color: white;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 20;
    `,this.inputArea=document.createElement("div"),this.inputArea.id="conversation-input-area",this.inputArea.style.cssText=`
      position: absolute;
      bottom: 8px;
      left: 8px;
      right: 8px;
      height: 40px;
      display: flex;
      align-items: center;
      opacity: 0;
      transition: opacity 0.3s ease;
    `,this.textInput=document.createElement("input"),this.textInput.type="text",this.textInput.placeholder="Ask about my CV and experience...",this.textInput.style.cssText=`
      flex: 1;
      padding: 8px 12px;
      border: 2px solid #333;
      border-radius: 4px;
      background: white;
      color: #000;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      font-weight: bold;
      outline: none;
    `;const e=document.createElement("button");e.textContent="📤",e.style.cssText=`
      margin-left: 8px;
      padding: 8px 12px;
      border: 2px solid #333;
      border-radius: 4px;
      background: #f0f0f0;
      color: #000;
      font-size: 14px;
      cursor: pointer;
      font-weight: bold;
    `,this.responseArea=document.createElement("div"),this.responseArea.id="conversation-response-area",this.responseArea.style.cssText=`
      position: absolute;
      top: 35px;
      left: 8px;
      right: 8px;
      bottom: 60px;
      padding: 8px;
      overflow-y: auto;
      line-height: 1.4;
      opacity: 0;
      transition: opacity 0.3s ease;
      border-bottom: 1px solid #ccc;
    `,this.inputArea.appendChild(this.textInput),this.inputArea.appendChild(e),this.messageArea.appendChild(this.modelSelector),this.messageArea.appendChild(this.closeButton),this.messageArea.appendChild(this.inputArea),this.messageArea.appendChild(this.responseArea),this.statusBar?.parentNode&&this.messageArea&&this.statusBar.parentNode.insertBefore(this.messageArea,this.statusBar),e.addEventListener("click",()=>this.handleSendMessage()),this.textInput.addEventListener("keydown",o=>{o.stopPropagation(),o.key==="Enter"&&(o.preventDefault(),this.handleSendMessage())}),this.modelSelector.addEventListener("change",()=>this.handleModelChange()),this.closeButton.addEventListener("click",()=>this.hideConversation()),document.addEventListener("keydown",o=>{o.key==="Escape"&&this.state.isActive&&this.hideConversation()})}showConversation(){if(!this.messageArea)return;this.state.isActive=!0,this.state.currentState="input",this.messageArea.style.display="block",this.messageArea.style.height="150px",this.modelSelector&&(this.modelSelector.value=V()),this.modelSelector&&(this.modelSelector.style.opacity="1"),this.closeButton&&(this.closeButton.style.opacity="1"),this.inputArea&&(this.inputArea.style.opacity="1"),this.textInput&&this.textInput.focus();const e=document.getElementById("status-text");e&&(e.style.opacity="0")}hideConversation(){if(!this.messageArea)return;this.state.isActive=!1,this.modelSelector&&(this.modelSelector.style.opacity="0"),this.closeButton&&(this.closeButton.style.opacity="0"),this.inputArea&&(this.inputArea.style.opacity="0"),this.responseArea&&(this.responseArea.style.opacity="0"),this.textInput&&(this.textInput.value=""),this.responseArea&&(this.responseArea.textContent=""),this.messageArea.style.height="0",setTimeout(()=>{this.messageArea&&(this.messageArea.style.display="none")},300);const e=document.getElementById("status-text");e&&(e.style.opacity="1")}isConversationActive(){return this.state.isActive}async handleSendMessage(){if(!this.textInput||!this.textInput.value.trim())return;const e=this.textInput.value.trim();this.textInput.value="",this.state.currentState="loading",this.showLoadingState();try{const o=await Ht(e);this.showResponse(o)}catch(o){console.error("Error getting AI response:",o),this.showResponse("Sorry, I had trouble processing your question. Please try again.")}}showLoadingState(){!this.inputArea||!this.responseArea||(this.textInput&&(this.textInput.disabled=!0,this.textInput.placeholder="Thinking..."),this.responseArea.style.opacity="1",this.responseArea.textContent="Thinking...",this.state.currentState="loading")}showResponse(e){this.responseArea&&(this.state.currentResponse=e,this.responseArea.textContent=e,this.state.currentState="response",this.textInput&&(this.textInput.disabled=!1,this.textInput.placeholder="Ask about my CV and experience...",this.textInput.focus()),this.responseArea&&(this.responseArea.style.opacity="1"),this.inputArea&&(this.inputArea.style.opacity="1"))}handleSpaceInConversation(){}async handleModelChange(){if(!this.modelSelector)return;const e=this.modelSelector.value;console.log(`🔄 Switching to ${e} model...`),this.responseArea&&(this.responseArea.style.opacity="1",this.responseArea.textContent=`Switching to ${e==="qwen"?"Qwen Chat":"DistilBERT Q&A"}...`);try{await Gt(e)?(this.responseArea&&(this.responseArea.textContent=`✅ Switched to ${e==="qwen"?"Qwen Chat":"DistilBERT Q&A"}!`),setTimeout(()=>{this.responseArea&&(this.responseArea.style.opacity="0"),this.inputArea&&(this.inputArea.style.opacity="1")},1e3)):(this.responseArea&&(this.responseArea.textContent=`❌ Failed to switch to ${e}. Try again later.`),this.modelSelector.value=V())}catch(o){console.error("Error switching model:",o),this.responseArea&&(this.responseArea.textContent="❌ Error switching models. Try again later.")}}}const I=new Xt;let S={},$=null,j=null,Y=null;const Zt=200;function Kt(){document.addEventListener("keydown",oo),document.addEventListener("keyup",ao),eo()}function eo(){j=document.createElement("div"),j.id="door-message",j.style.cssText=`
    position: fixed;
    bottom: 120px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    font-family: Arial, sans-serif;
    font-size: 16px;
    display: none;
    z-index: 1000;
    border: 2px solid #fff;
    text-align: center;
    max-width: 300px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
  `,document.body.appendChild(j)}function to(t){me(t,5e3),$=t}function we(){const t=document.getElementById("status-text");t&&t.textContent===$&&(t.textContent=""),$=null}function oo(t){if(t.key==="Escape"&&I.isConversationActive()){I.hideConversation(),t.preventDefault();return}const e=document.activeElement;if(e&&(e.tagName==="INPUT"||e.tagName==="TEXTAREA"))return;let o=null;switch(t.key){case"ArrowUp":case"w":case"W":o="up";break;case"ArrowDown":case"s":case"S":o="down";break;case"ArrowLeft":case"a":case"A":o="left";break;case"ArrowRight":case"d":case"D":o="right";break;case" ":if(!S[" "]){if(console.log("Action button pressed!"),Nt()&&!I.isConversationActive())console.log("Starting GameBoy-style boss conversation!"),I.showConversation();else if(!I.isConversationActive()){const n=pe(h.x,h.y);n?(console.log(`Attempting to enter door to ${n.targetRoom}`),Te()&&(console.log("Successfully entered new room!"),we())):console.log("No door here to interact with.")}S[t.key]=!0}t.preventDefault();return}o&&!S[t.key]&&(S[t.key]=!0,no(o)),t.preventDefault()}function ao(t){const e=document.activeElement;if(!(e&&(e.tagName==="INPUT"||e.tagName==="TEXTAREA"))&&(S[t.key]=!1,["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","w","a","s","d","W","A","S","D"].includes(t.key)&&!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","w","a","s","d","W","A","S","D"].some(a=>S[a]))){X(),h.animationState="idle";const a=h.direction==="left"?"right":h.direction;h.currentAnimation=m[`${a}_idle`],h.frameIndex=0,h.animationTimer=0,ve()}}function no(t){X(),he(t),Y=window.setInterval(()=>{({up:["ArrowUp","w","W"],down:["ArrowDown","s","S"],left:["ArrowLeft","a","A"],right:["ArrowRight","d","D"]})[t].some(a=>S[a])?he(t):X()},Zt)}function X(){Y&&(clearInterval(Y),Y=null)}function he(t){const e=ee(),o=e.map[0].length,n=e.map.length;if(t!==h.direction){h.direction=t,h.animationState="idle";const i=h.direction==="left"?"right":h.direction;h.currentAnimation=m[`${i}_idle`],h.frameIndex=0,h.animationTimer=0}else{let i=h.x,l=h.y;if(t==="up"?l--:t==="down"?l++:t==="left"?i--:t==="right"&&i++,i>=0&&i<o&&l>=0&&l<n){const c=e.map[l][i];Ie.includes(c)?(h.x=i,h.y=l,h.animationState="walk",setTimeout(()=>ve(),100)):(h.animationState="idle",console.log(`Cannot walk on tile type ${c} at (${i}, ${l})`))}else h.animationState="idle",console.log("Cannot move outside map boundaries")}const a=h.direction==="left"?"right":h.direction;h.currentAnimation=m[`${a}_${h.animationState}`],h.frameIndex=0,h.animationTimer=0}function ve(){const t=pe(h.x,h.y);t&&t.description?to(t.description):we()}function io(){const t={"btn-up":"ArrowUp","btn-down":"ArrowDown","btn-left":"ArrowLeft","btn-right":"ArrowRight","btn-action":" "};for(const[e,o]of Object.entries(t)){const n=document.getElementById(e);n&&(n.addEventListener("touchstart",a=>{a.preventDefault(),ge(o)},{passive:!1}),n.addEventListener("touchend",a=>{a.preventDefault(),J(o)},{passive:!1}),n.addEventListener("mousedown",a=>{a.preventDefault(),ge(o)}),n.addEventListener("mouseup",a=>{a.preventDefault(),J(o)}),n.addEventListener("mouseleave",a=>{a.preventDefault(),J(o)}),n.addEventListener("contextmenu",a=>{a.preventDefault()}))}}function ge(t){const e=new KeyboardEvent("keydown",{key:t,bubbles:!0,cancelable:!0});document.dispatchEvent(e)}function J(t){const e=new KeyboardEvent("keyup",{key:t,bubbles:!0,cancelable:!0});document.dispatchEvent(e)}const lo=Array(ye).fill(null).map(()=>Array(be).fill(0)),{canvas:F,ctx:Z,TILE_SIZE:so,GAME_WIDTH:L,GAME_HEIGHT:B}=Re(lo);if(!F)throw console.error("Canvas element not found! Make sure there's a canvas with id='gameCanvas'"),new Error("Canvas not found");if(!Z)throw console.error("Could not get 2D context from canvas"),new Error("Canvas context not available");F.width=L;F.height=B;console.log(`Canvas initialized: ${L}x${B} (${be}x${ye} tiles)`);xe(F);window.addEventListener("resize",()=>xe(F));Vt((t,e,o)=>{console.log(`🔄 Background loading ${t}: ${e} ${o?`(${o}MB)`:""}`),e==="completed"&&console.log(`⚡ ${t} model ready for instant switching!`)});let ue=0,K=!1;function ro(){K||(K=!0,console.log("Game started!"),requestAnimationFrame(ke))}function ke(t){if(!K)return;const e=(t-ue)/1e3;ue=t,Pe(e),I.isConversationActive()||Ut(),Z&&co(Z,so),requestAnimationFrame(ke)}function co(t,e){t.clearRect(0,0,L,B);const o=Ae(),n=ee(),a=n.map;if(!o.grass){t.fillStyle="#333",t.fillRect(0,0,L,B),t.fillStyle="#fff",t.font="20px Arial",t.textAlign="center",t.fillText("Loading assets...",L/2,B/2);return}for(let i=0;i<a.length;i++)for(let l=0;l<a[0].length;l++){const c=a[i][l];let s=null;switch(c){case 0:s=o.grass;break;case 1:s=o.oak_tree;break;case 2:case 3:case 4:case 5:s=o.path;break;case 6:s=o.door;break;case 7:s=o.library_floor;break;case 8:s=o.library_bsA||o.library_bsB||o.library_bsC;break;case 9:s=o.football_center||o.football_0;break;case 10:s=o.flag_it||o.flag_fr||o.flag_de||o.flag_us;break;case 11:s=o.library_table;break;case 12:s=o.library_chair;break;case 13:s=o.library_rug;break;case 14:s=o.tree_t1||o.tree_t2||o.tree_t3;break;case 15:break;case 16:s=o.football_0;break;case 17:s=o.football_1;break;case 18:s=o.football_2;break;case 19:s=o.football_3;break;case 20:s=o.football_4;break;case 21:s=o.football_5;break;case 22:s=o.football_6;break;case 23:s=o.football_7;break;case 24:s=o.football_8;break;case 25:s=o.football_9;break;case 26:s=o.football_10;break;case 27:s=o.football_11;break;case 28:s=o.world_map;break;case 29:s=o.nps_chart;break;case 30:s=o.energy_cost_chart;break;case 31:s=o.fashion_retail_timeseries;break;case 32:s=o.distribution_network_map;break;case 33:s=o.forecast_histogram;break;case 34:s=o.box_plot;break;case 35:s=o.deloitte_consulting;break;case 36:s=o.powerbi_dashboard_left;break;case 37:s=o.powerbi_dashboard_right;break;case 38:s=o.python_sklearn;break;case 39:s=o.pytorch_langchain;break;case 40:s=o.recommendation_tree;break;case 41:s=o.azure_ml;break;case 42:s=o.azure_data_factory;break;case 43:s=o.chatbot_ai;break;case 44:s=o.gantt_chart;break;case 45:s=o.ir_spectrum;break;case 46:s=o.atmospheric_transmission;break;case 47:s=o.multi_camera_array;break;case 48:s=o.leonardo_spa;break;case 49:s=o.object_detection;break;case 50:s=o.kalman_filter;break;case 51:s=o.optical_flow;break;case 52:s=o.coverage_360;break;case 53:s=o.threat_interface;break;case 54:s=o.multi_target_tracking;break;case 55:s=o.matlab_simulink;break;case 56:s=o.system_architecture;break;case 57:s=o.requirements_specs;break;case 58:s=o.ir_detector;break;case 59:s=o.brick_wall;break;case 60:s=o.flag_au;break;case 61:s=o.flag_us;break;case 62:s=o.flag_jp;break;case 63:s=o.flag_vn;break;case 64:s=o.flag_mv;break;case 65:s=o.flag_it;break;case 66:s=o.flag_fr;break;case 67:s=o.flag_de;break;case 68:s=o.flag_es;break;case 69:s=o.flag_gb;break;case 70:s=o.flag_nl;break;case 71:s=o.flag_ch;break;case 72:s=o.flag_ma;break;case 73:s=o.flag_eg;break;case 74:s=o.main_guy;break;case 75:s=o.flower;break}if(s)t.drawImage(s,l*e,i*e,e,e);else{let r="#90EE90";switch(c){case 0:r="#228B22";break;case 1:r="#8B4513";break;case 6:r="#2C2C2C";break;case 7:r="#D2B48C";break;case 8:r="#8B4513";break;case 9:r="#32CD32";break;case 10:r="#FF6347";break;case 11:r="#A0522D";break;case 12:r="#CD853F";break;case 13:r="#DC143C";break;case 14:r="#654321";break;case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:r="#32CD32";break;case 28:r="#87CEEB";break;case 29:r="#1a202c";break;case 30:r="#ffa500";break;case 31:r="#e91e63";break;case 32:r="#1a202c";break;case 33:r="#3b82f6";break;case 34:r="#06b6d4";break;case 35:r="#86bc25";break;case 36:case 37:r="#f2c811";break;case 38:r="#3776ab";break;case 39:r="#ee4c2c";break;case 40:r="#1a202c";break;case 41:case 42:r="#0078d4";break;case 43:r="#2d3748";break;case 44:r="#1a202c";break;case 45:r="#1a1a1a";break;case 46:r="#1a1a1a";break;case 47:r="#1a1a1a";break;case 48:r="#C8102E";break;case 49:r="#1a1a1a";break;case 50:r="#1a1a1a";break;case 51:r="#1a1a1a";break;case 52:r="#1a1a1a";break;case 53:r="#1a1a1a";break;case 54:r="#1a1a1a";break;case 55:r="#e97627";break;case 56:r="#1a1a1a";break;case 57:r="#1a1a1a";break;case 58:r="#1a1a1a";break;case 59:r="#6e6e6e";break;case 60:r="#012169";break;case 61:r="#b22234";break;case 62:r="#bc002d";break;case 63:r="#da251d";break;case 64:r="#d21034";break;case 65:r="#009246";break;case 66:r="#0055a4";break;case 67:r="#000000";break;case 68:r="#aa151b";break;case 69:r="#012169";break;case 70:r="#21468b";break;case 71:r="#ff0000";break;case 72:r="#c1272d";break;case 73:r="#ce1126";break;case 74:r="#4169e1";break;case 75:r="#ff69b4";break}t.fillStyle=r,t.fillRect(l*e,i*e,e,e)}if((c===1||c===14)&&s){const r=s.naturalHeight||s.height;r>e&&t.drawImage(s,l*e,i*e-(r-e),e,r)}if((c===8||c===28)&&s){const r=s.naturalHeight||s.height;r>e&&t.drawImage(s,l*e,i*e-(r-e),e,r)}if(c===6&&(t.save(),t.globalAlpha=.3,t.fillStyle="#FFD700",t.fillRect(l*e+2,i*e+2,e-4,e-4),t.restore()),c===10&&n.id==="room4"){const r=[o.flag_it,o.flag_fr,o.flag_de,o.flag_us,o.flag_jp,o.flag_au,o.flag_es,o.flag_gb].filter(Boolean);if(r.length>0){const f=(l+i)%r.length,g=r[f];g&&t.drawImage(g,l*e,i*e,e,e)}}}Ee(t,e)}console.log("Loading assets...");te(()=>{console.log("Assets loaded, initializing sprites..."),Dt(),console.log("Initializing room system..."),Me(),console.log("Initializing boss interaction system..."),Lt(),console.log("Setting up input listeners..."),Kt(),io(),console.log("🚀 Starting background AI model preloading..."),console.log("🎮 Game will start immediately while models load in background!"),$t(),console.log("Starting game..."),ro()});
