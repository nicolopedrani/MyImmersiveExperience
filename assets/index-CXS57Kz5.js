import{p,g as oe,a as h,b as ye,c as Me,W as Re,M as be,d as xe,s as Ce,e as we,i as Pe,u as De,f as _e}from"./game-BARn0yUE.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=o(n);fetch(n.href,l)}})();const Le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAB1JREFUOI1jtOv0+M9AAWCiRPOoAaMGjBowmAwAAJhEAi4/QQzBAAAAAElFTkSuQmCC",Be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAB1JREFUOI1jfLKs6D8DBYCJEs2jBowaMGrAYDIAAFnyAxuTOlahAAAAAElFTkSuQmCC",Fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABQCAYAAACpv3NFAAAAAXNSR0IArs4c6QAABZFJREFUeJztW09PG0cU/zk1ogZFvbBFCjgXDgYipAYJRzKHXCLlGkeIT9EvkAMnH/oJ+iUsFM6VcokESBipiYRi44MPjUGVte6BVmDRWNCDmeXteHa9M/Nm6WF/Esrszuzse7/3Z97MOkCGDBkyZMiQIUOGdFFY8G4LC97tQ8uRczEpVWxw7ufE9eDcz4n+1Z0yAKBZa4COdSFPHPKckwlFhXIA0Kw1qLJj/fS6WWvcqghzCbYXCKs2aw1U6xUAQPtkCGBkZVnp0lo+NKa0lkf7ZBga26w1nJPwiGMS6vKrO2XsbR8CuFeyWq8EbXpfvlYR5TpXWLNbWPBuq/VKyHqyggLtk2Fkn2rM3vZh4E1724dOvIGNANcQXgXw5garEEh7GVvdKWN1p8z6XmMCRNITMd8+GQYJzQXk0OLKDSxJUE5y3FDlDi5vsCJAFDF0KXMBOq9YZrneZUQAdX9ayQFwGgrtkyG4E65RNqWlrAouw4GCY2UwXk4oCbSqS0t5OexM6wSrEKACuFwBVOB6rzYBctaVY56biLj5qPVNoeUy8jaWrs3U/blCIek8dNOlGwbGyyBdimRBOfNAlAdweZp20lDFPxcEkSrl6LtU/aZbZy0PUMV/EiQdR5WXyRW5hs5Ft9Gmy6B2CFTrlaD40fGApAVSaS0fzKs6N4g6SzAtibUJ2K/nxg4t4hQzLZPjCJPnqtYrqNYrRiRoETA493P+7kHonhBSJaysvA4JqqQqv4MjERolQWD8YDPuFCiuPykm1QOmlaCWVIUF79bb2oS38m3i2ElhoZs/gGhPsDkuM6oD/NZUaBeoUiaqLogKlUkx76rkNsoB/u4BvK1N5ZgkCVFuJ80RUeu/DbQ9QLiaKgxoQpSVpW48yZqTiBJo1hrwtjbhbW0aL4MspZxOoSOPj2tP2ltEeaEOjFYBkQj91tRIkJik6LemEiXNpJDn81tT8HcPjJOgsQeolJfvcSlP5xHEeyvfgvi3+U5glAPkYkgIKQRU3ZfbUfBbU8pn5Gc5lAcszgRFW45Dan0ZsrdEeYrKk1S47Axx9enIigSjEBCfsGeevwgJM7uUT2xlCurWceMuO/zHbtYfRi47Q/i7B5hdyo/dlxHl3lH9l53h2DxXn46Cf22tD1h+HBWhMPP8RUCAcEv5nkxQFOSxKiI5FBew8gAqhLBWnPJUmaj27FI+0uouwMIiTYoiLyQlQu6nJFJQEjg/j7P/4ICGhUCUQnFjhMKUUBc/kGD5OkwhCxmlfPlxMZTQ6DWdiyvZRcHZD5CiwgIAyo+LAIDGP93QNb2X1k/mnH3IIwosA0ct4F7Rjfnpu65i6JnR/SI+nv6+MnoOAHDqSkbAQQjcYZn8YXDurwzO/RUAePusEBq4MT8dEFKcU4oTmosb3ARMFLS06AWKbsxPRyltPL8uOEMgsWClRQ+Aj27/JmgD0+j2b3TexRIaXB6gZZX2ma9U1sAbrMFBgJYgHz73gvarn+ZTfbcKrpJgLIT122d+6PohYEuAtgWEmx/3rgHce4Sm+1vJQJGaB7xcXm+9e/0UwL2ywvLHveug/e71U7xcXm+lJZcNAUbMj7L+CMW5R4EnHPeuQ31pyAIA35k+CGAu6UBh/faZj7/+vsL7LwNszE/jh5kc3qw/wX7nAgCw37nAj9//izfrT9C9mPn5j/6fv2rI09dVAEg5CXb7N3j/ZRBcU4vflb/o9m/QPvNTCwWbQugUCVxPWP/D5x6Oe9eBosB6q3jmj5Hw0ay8MS6KbHdcxrEnrPv2WQGlRQ+//PaVkKONByMAcLRJ0YBVSfwghdD/CVyHDg/lBdYbIs5Tl7RJYNkNch87pUUC2ymRq3M3V0SwH4+lcfBoS4bTM8HU/7MyJhPiVOEMGTJkyJAhQwaB/wCcF1ybPAOXlAAAAABJRU5ErkJggg==",Ue="/MyImmersiveExperience/assets/Player-LaRVoEvR.png",We="/MyImmersiveExperience/assets/MainGuySpriteSheet-A_pLERVz.png",je="/MyImmersiveExperience/assets/assets-k1rCfwam.png",Ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABgCAYAAADVenpJAAAHZElEQVR4nO2dXUwUVxTH/zM7u8sCIoqCoKAJEo2FKFpM1VbLR6tNXxqrJSS1SQ1ttDURTW1KYh8aSbYpjaGJaY0hmugDoTW+NW0igta2ttLYWqlVwUSoroVKJVtYYb+mD7DTnWXW7c7eubPsvb9kkrkDnHPunT+79+PcGUGWZRkcZpEA4OClF8yOwxSa1n0FgO36SwBwf/S22bGYCsv1lwDAYZ1ldhymwnL9JQCQ5aDZcZgKy/UXzQ6AYy5cAIzDBcA4XACMwwXAOFwAjMMFwDhcAIzDBcA4XACMwwXAOFwAjCMBgCTaqDjzB71U/Mw0aLW/pm8AePDoLgKy31BHFkFCtj3XUB8zFRrtH4lFkABMCaCm6DVk2XIMdej2DuOnwa8N9TFTodH+kbi9wwCmBPD6CieGHg0Y6jDXUcQFEAUa7R9JrqMIwJQA/EEv9p5fa6jDU5vpVnAmQaP9Izm1eQCSaPuvEzjfUWioQzM7OskOjfbX8glMfQIAoN4J4agxq/35PADjcAEwDhcA43ABMA4XAONwATCOMgwMzQ3rgQ8h6ZHIfdJCsTY87tJlwCJYMIvyPDbLjEwMIiAHiNlTBFC5qE6XgTG/G7cedhMLiPN41uRtQYaURcyeIoC6ZQd1GciwZuPtrnJiAXEez95VxzDmGyFmTxHA7s6VugyceJ7dvfVmEJD9uu9VOCc39wMIE0CWfZ4uQ/F0SiK3YQsC3UFItG3gZscVDxZB0n2vtFDuHo098n7ZpyrbRAe1vfmCIMIXnND8mRlxJSIykrGRHVPE4NPKX1TlnWdLkG3PpZKONjIxhOPP9SZFXKF4kgGqAmj5uV5V/qzqKuo7liM3fbFhCaOSaMOQpx+tNTem+X9nzUnqcYXHkwxQFcC14W9U5babTfjk2cvYd+EpZNvziPuzija4xm7jSOUVtN1smuY/Vlx7ulajIKMYPkIiiIwnRH3px0Ts64GqALJs6s5L1902zElbgH3lx3HieiNRX1bRhnujvfjw6U5cvPc5uu62YW5aflxxOTd04L1vq7Aws4SICAY9A3Bu6FDiCWGmAKh2d4NyQHXkpBXgi95mPJm3hbivIc8AGiva0e/uwRe9zchJK5jmP1Zc/e4eNFa0Y8hDJp+xvvQjVTyhw0xMHe8EZD/y0pcY8v2/reQAAODotQbkpS+Jq0MXiuvotQaVrUSpLtyhiid0mInpA15/0GtIwujWpfvh7K5FQUaxLoH5g14UZBTD2V2LrUv3E4nJN2UzmXZImS4Ao/AFvY/97g4fh0cbk8eyES9W0UbMFilSVgCxGnvcP6p5Hokv6IU1hVPaU1YAsQjPw6edk59MMCsA54YOzXPWYFYAnEm4ABiHWQE0Xd6mec4aKSuAWL33vpErmueRJOPQjSQpK4DQWkA0EcyyzdU8j8dGKpCyAjjTdxiNFe1wjd3WnGmMXAuIRJpauWusaMeZvsOGxmomKSuA073NAIBdZS0Y9NyJK3XNIkgY9NzBrrIWla1ECch+4nn9iWK6AETBovkfmCi56UVwdtdicVYptpccwPC4C6JgUR3hMYQfw+MubC85gMVZpXB21yI3vYhITBZBUuJIFkyVoyCIcHsfGNIgoXn8xu9qcKTyCh6O/4mLrtOav+v2PlCVKxfV4ZmFr2BP12qiawG3HnajclEdLrpOJ81mGqoCECCoyo98/6AsZyPujxmTWu4LepGfUYy959eiteZG1Dy8spyNqnLdsoOo71iOfILZQABw6PLLOFr1K0YmhvD73z8Qs5sIVAXgjcjKLchciobyVrxxbgXSJWNe3eYPejHfUYjdnSujJoU2lLeqyjvPlmC+o5D4su0ce54Sxwc/vkTUtl6oCiA9YkvToXVf4s1zTyDDOtvQNOyA7EeWfR7e6lqlun6s+joATLueZZ9nSKJGeBzHqn8jbl8PdLOCN32vKjdcWA9JsFLZGyDLQUiCVfNnkdeNjCcUR8OF9cq1lk2XDPMXC6oCeP/Si6qyx++mOskSLfGD9k4gQRDh8bup+oyGIgAaz/Fzjfapyg4pEzLYfHm5TbTr/luS90oRgN6eeDy95Mh39LL8yla9wvcFvURHTYoA9CZFxPMRzvINJ4VVtBFNYFEE0O/u0WXg6l+dxILhxOZM32Eij90vnr0KQJgAQjnw8SIJVsxJW5BwQJz/x+ne5mm7mfVQVfgqgDABFGQU6zaWyuvlyQapdYkQigD4TZwZkL5Ppq8GcsyFC4BxuAAYhwuAcbgAGIcLgHGUYWAqpz7PBMxqfwmYHFveG9XOliEFn2eIDo321/JpDb02zira0FjRbqhD/gkTHRrtr+UTmOoDnPvjlOEOafiYqZjRNiGfEgC09rwLf5THqJJCEu2YyxeNNKHR/pFIoh3VhTsmBZBHeIEhGrwfoA2t9tdC6QRyzMPM9ufzAIzDBcA4XACMwwXAOFwAjMMFwDhcAIzDBcA4XACMwwXAOBKQ3C9KpAHL9ZeAyWf1sAzL9ZcAID9T/7awVIDl+guyLLP5hAYOAOBfSQHMHZJk+TkAAAAASUVORK5CYII=",ze="/MyImmersiveExperience/assets/library-BPiDb9BV.png",Oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAUCAYAAABGUvnzAAAC4ElEQVR4nO2av27bMBDGT4UeoIBSIJUrdGszeWqmCMgSDVliBMiUrRmSN/BDCOgDdMmYyUDgLB3UpYA6pROndiwSux3KoXtQZbBPpihS/CPaTm3/FkukSCn++N2d6Hj3ewdFJ88g6KVAaAbdIAFCM8A2WwjNGvs7eXN/E6M4sR7bhtMjv9b2pf+p1iZ6vm5Qb6PDvtbYdz9+6j5iDb8bJEDiBGiewSjOpOLSYV8oOLbzn20E3OAOH53GrpxRnACB6qqTuVkkLj+fCNkCYMfNc5GI3Cjj6uZhbs8xb/xukAAd9ssvtpNnMIoTYUgBqDvZpYP5RTGKE+N5wkEE45M743sDTMLtfnpoNXaefHv72nqsj+Ji7g16KdA8AzJt4wXlnYzn/Kepg2XX64ocDqLasYnQT1XctvhBLwWYuhVdy7aJ3Mqey2nqc8/45K4isq2LV41KIpIVUgjf16aa5V2JqUF1nQzWteEgMg7V++nhSrq4FBjdqBKZxXURxItsMj8rpq17n6q4bGQypRSYr4J5RH0uHaxqd83/XBmbUAnRJuEZYHFibLDHu987KGwHo8CiTRGsfvk+1Q7XqvLq62dvGffVf9sXgCGaSoRmQWFxUSxru3Hd8Nsk8K2LHQAAIJzQLLywuAiI9V3lsCljs4AmVByM1aeu6LP3YPk7L5+ndcaomJd4p0d+Y/HVVHMU17vgHd/KJ/eWEqFnAnvblwAw2zUqfp8pB6u+6KZ+lwWaaC6TVID70lc3D5VjHYrr3dpxo9AL5hl7Eg6itQxtKKapuMj4w3Pwjm8hPP/r/Nna4v379b4AmORTQjMIBxFsXezAn4/f1YO3L6V9Nj8U6CJbhLY5WNfBsr+HdbHMvZ63nBhdhuiJoBFzrAYLJsyr7C9SPNgn+5XKBNcFGitmk3tfvnijnuxc45oF4rfZlKf5xMG8eJS5plwEU9GJQ6F51jG9qHDyHqwjFi80tPh3oA36PAJWG3h2QapYCQAAAABJRU5ErkJggg==",d={};let U=0;const q=9;let j=null;const ie={objects:[{name:"Bookshelf_A",code:"bsA",x:120,y:360,width:96,height:120},{name:"Bookshelf_B",code:"bsB",x:240,y:360,width:96,height:120},{name:"Bookshelf_C",code:"bsC",x:360,y:360,width:96,height:120},{name:"table",code:"t",x:336,y:192,width:168,height:96},{name:"world_map",code:"wm",x:120,y:192,width:96,height:120},{name:"chair",code:"c",x:648,y:72,width:48,height:72},{name:"rug",code:"r",x:432,y:0,width:168,height:72}],paths:[{name:"path_walk",code:"pw",x:72,y:192,width:24,height:24}]},Ye={tilesheet:{columns:4,rows:3,tileWidth:32,tileHeight:32}},se={flags:[{name:"Australia",code:"au",x:0,y:0,width:15,height:10},{name:"United States",code:"us",x:15,y:0,width:15,height:10},{name:"Japan",code:"jp",x:30,y:0,width:15,height:10},{name:"Vietnam",code:"vn",x:45,y:0,width:15,height:10},{name:"Italy",code:"it",x:75,y:0,width:15,height:10},{name:"France",code:"fr",x:90,y:0,width:15,height:10},{name:"Germany",code:"de",x:105,y:0,width:15,height:10},{name:"Spain",code:"es",x:0,y:10,width:15,height:10},{name:"United Kingdom",code:"gb",x:15,y:10,width:15,height:10}]},He={trees:[{name:"tree_1",code:"t1",x:0,y:0,width:160,height:208},{name:"tree_2",code:"t2",x:176,y:32,width:160,height:176},{name:"tree_3",code:"t3",x:368,y:32,width:128,height:176}]};function ne(t){j=t,console.log("🚀 Starting asset loading..."),A("grass",Le),A("path",Be),A("oak_tree_original",Fe),A("player_sprite_sheet",Ue),A("main_guy_sprite_sheet",We),A("assets_tilesheet",je),A("football_tilesheet",Ne),A("library_tilesheet",ze),A("travel_flags_tilesheet",Oe)}function A(t,e){const o=new Image;o.onload=()=>{d[t]=o,U++,console.log(`✅ Loaded: ${t} (${U}/${q})`),U===q&&(console.log("🎯 All images loaded, starting tile extraction..."),Qe(),Ve(),j&&j())},o.onerror=()=>{console.error(`❌ Failed to load: ${t} from ${e}`),U++,U===q&&j&&j()},o.src=e}function Qe(){console.log("🔧 Extracting tiles..."),Ge(),$e(),qe(),Je(),Xe(),Ze()}function Ge(){const t=d.library_tilesheet;if(!t){console.error("❌ Library tilesheet not found");return}console.log("📚 Extracting library tiles..."),console.log("Library tilesheet size:",t.width,"x",t.height),ie.objects.forEach(o=>{console.log(`Extracting ${o.name} at (${o.x}, ${o.y}) size ${o.width}x${o.height}`);const a=z(t,o.x,o.y,o.width,o.height);o.name==="world_map"?(d.world_map=a,console.log("✅ World map extracted")):o.name==="chair"?(d.library_chair=a,console.log("✅ Chair extracted")):o.name.includes("Bookshelf")?(d[`library_${o.code}`]=a,console.log(`✅ Bookshelf ${o.code} extracted`)):o.name==="table"?(d.library_table=a,console.log("✅ Table extracted")):o.name==="rug"&&(d.library_rug=a,console.log("✅ Rug extracted"))});const e=ie.paths[0];d.library_floor=z(t,e.x,e.y,e.width,e.height),console.log("✅ Library floor extracted")}function $e(){const t=d.football_tilesheet;if(!t)return;console.log("⚽ Extracting football tiles...");const{tileWidth:e,tileHeight:o,columns:a,rows:n}=Ye.tilesheet;for(let l=0;l<n;l++)for(let i=0;i<a;i++){const c=l*a+i;d[`football_${c}`]=z(t,i*e,l*o,e,o)}console.log(`✅ Extracted ${n*a} football tiles`)}function qe(){const t=d.travel_flags_tilesheet;t&&(console.log("🏁 Extracting flags..."),se.flags.forEach(e=>{d[`flag_${e.code}`]=z(t,e.x,e.y,e.width,e.height)}),console.log(`✅ Extracted ${se.flags.length} flags`))}function Je(){const t=d.assets_tilesheet;t&&(console.log("🌳 Extracting trees..."),He.trees.forEach(e=>{d[`tree_${e.code}`]=z(t,e.x,e.y,e.width,e.height),console.log(`✅ Extracted tree ${e.code}`)}))}function z(t,e,o,a,n,l=64,i=64){const c=document.createElement("canvas");c.width=l,c.height=i;const s=c.getContext("2d");if(!s)return console.error("❌ Could not get canvas context"),new Image;s.clearRect(0,0,l,i),s.imageSmoothingEnabled=!1,s.drawImage(t,e,o,a,n,0,0,l,i);const r=new Image;return r.src=c.toDataURL(),r}function Ve(){console.log("🎨 Creating backgrounds for trees only...");const t=d.grass;if(!t){console.error("❌ Grass tile not available for backgrounds");return}H("oak_tree_original","oak_tree",t),H("tree_t1","tree_t1",t),H("tree_t2","tree_t2",t),H("tree_t3","tree_t3",t),console.log("✅ Tree backgrounds created, library items left as-is")}function H(t,e,o){const a=d[t];if(!a){console.warn(`⚠️ Source tile ${t} not found, skipping background`);return}const n=document.createElement("canvas");n.width=64,n.height=64;const l=n.getContext("2d");if(!l){console.error(`❌ Could not get canvas context for ${e}`);return}l.drawImage(o,0,0,64,64),l.drawImage(a,0,0,64,64);const i=new Image;i.src=n.toDataURL(),d[e]=i,console.log(`✅ Created background for ${e}`)}function Xe(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.strokeStyle="#444",e.lineWidth=3,e.strokeRect(4,4,56,56),e.strokeStyle="#666",e.lineWidth=1,e.strokeRect(8,8,24,24),e.strokeRect(32,8,24,24),e.strokeRect(8,32,24,24),e.strokeRect(32,32,24,24),e.fillStyle="#FFD700",e.beginPath(),e.arc(48,32,3,0,Math.PI*2),e.fill());const o=new Image;o.src=t.toDataURL(),d.door=o,console.log("✅ Door tile created")}function Ze(){console.log("📊 Creating diverse Data Science visualization tiles..."),Ke(),et(),tt(),ot(),nt(),at(),lt(),it(),st(),rt(),ct(),ft(),dt(),ht(),gt(),mt(),ut(),console.log("✅ Diverse Data Science and R&D visualization tiles created")}function Ke(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("NPS Analysis",5,12),e.strokeStyle="#00d084",e.lineWidth=2,e.beginPath();const a=[45,42,47,38,50,32,55];for(let n=0;n<a.length;n++){const l=8+n*8,i=a[n];n===0?e.moveTo(l,i):e.lineTo(l,i)}e.stroke(),e.fillStyle="#00d084";for(let n=0;n<a.length;n++)e.beginPath(),e.arc(8+n*8,a[n],2,0,Math.PI*2),e.fill();e.fillStyle="#ffd700",e.font="bold 10px Arial",e.fillText("73",45,58)}const o=new Image;o.src=t.toDataURL(),d.nps_chart=o}function et(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Energy Cost",5,12),e.fillStyle="rgba(255, 165, 0, 0.3)",e.beginPath(),e.moveTo(8,55);const a=[45,38,42,35,40,30,35];for(let n=0;n<a.length;n++)e.lineTo(8+n*8,a[n]);e.lineTo(56,55),e.closePath(),e.fill(),e.strokeStyle="#ffa500",e.lineWidth=2,e.beginPath();for(let n=0;n<a.length;n++){const l=8+n*8,i=a[n];n===0?e.moveTo(l,i):e.lineTo(l,i)}e.stroke(),e.fillStyle="#00ff88",e.font="bold 8px Arial",e.fillText("-23%",45,58)}const o=new Image;o.src=t.toDataURL(),d.energy_cost_chart=o}function tt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Fashion Sales",5,12),e.strokeStyle="#e91e63",e.lineWidth=2,e.beginPath();const a=[35,45,40,25,20,18,22,38,42,50,55,48];for(let n=0;n<a.length;n++){const l=8+n*4.5,i=a[n];n===0?e.moveTo(l,i):e.lineTo(l,i)}e.stroke(),e.fillStyle="#ffc107",e.beginPath(),e.arc(8+10*4.5,55,3,0,Math.PI*2),e.fill(),e.fillStyle="#ffc107",e.font="bold 7px Arial",e.fillText("Peak",38,58)}const o=new Image;o.src=t.toDataURL(),d.fashion_retail_timeseries=o}function ot(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Supply Chain",5,12);const a=[{x:15,y:25,color:"#00d084"},{x:35,y:20,color:"#ffc107"},{x:50,y:30,color:"#e91e63"},{x:25,y:45,color:"#9c27b0"},{x:45,y:50,color:"#2196f3"}];e.strokeStyle="#4a5568",e.lineWidth=1,e.beginPath(),e.moveTo(15,25),e.lineTo(35,20),e.moveTo(35,20),e.lineTo(50,30),e.moveTo(35,20),e.lineTo(25,45),e.moveTo(50,30),e.lineTo(45,50),e.moveTo(25,45),e.lineTo(45,50),e.stroke(),a.forEach(n=>{e.fillStyle=n.color,e.beginPath(),e.arc(n.x,n.y,4,0,Math.PI*2),e.fill()})}const o=new Image;o.src=t.toDataURL(),d.distribution_network_map=o}function nt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Forecast Dist",5,12),e.fillStyle="#3b82f6";const a=[15,25,35,40,35,25,20,15];for(let n=0;n<a.length;n++){const l=8+n*6,i=a[n];e.fillRect(l,55-i,5,i)}e.strokeStyle="#ef4444",e.lineWidth=2,e.beginPath();for(let n=0;n<50;n++){const l=8+n,i=55-(20+15*Math.exp(-Math.pow((n-25)/8,2)));n===0?e.moveTo(l,i):e.lineTo(l,i)}e.stroke()}const o=new Image;o.src=t.toDataURL(),d.forecast_histogram=o}function at(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Box Plot",5,12),e.strokeStyle="#06b6d4",e.fillStyle="rgba(6, 182, 212, 0.3)",e.lineWidth=2,e.fillRect(20,25,24,15),e.strokeRect(20,25,24,15),e.beginPath(),e.moveTo(30,25),e.lineTo(30,40),e.stroke(),e.beginPath(),e.moveTo(15,32.5),e.lineTo(20,32.5),e.moveTo(44,32.5),e.lineTo(50,32.5),e.moveTo(15,30),e.lineTo(15,35),e.moveTo(50,30),e.lineTo(50,35),e.stroke(),e.fillStyle="#ef4444",e.beginPath(),e.arc(12,20,2,0,Math.PI*2),e.arc(55,45,2,0,Math.PI*2),e.fill());const o=new Image;o.src=t.toDataURL(),d.box_plot=o}function lt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#f2c811",e.fillRect(0,0,64,64),e.fillStyle="#323130",e.font="bold 10px Arial",e.fillText("Dashboard",8,15);const a=32,n=35,l=15;[{angle:0,size:Math.PI*.6,color:"#0078d4"},{angle:Math.PI*.6,size:Math.PI*.8,color:"#00bcf2"},{angle:Math.PI*1.4,size:Math.PI*.6,color:"#40e0d0"}].forEach(c=>{e.fillStyle=c.color,e.beginPath(),e.moveTo(a,n),e.arc(a,n,l,c.angle,c.angle+c.size),e.closePath(),e.fill()}),e.fillStyle="#fff",e.fillRect(8,52,20,8),e.fillStyle="#323130",e.font="bold 8px Arial",e.fillText("87%",12,58)}const o=new Image;o.src=t.toDataURL(),d.powerbi_dashboard_left=o}function it(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#f2c811",e.fillRect(0,0,64,64),e.strokeStyle="#323130",e.lineWidth=2,e.beginPath();const a=[40,35,38,32,28,25,22];for(let n=0;n<a.length;n++){const l=8+n*8,i=a[n];n===0?e.moveTo(l,i):e.lineTo(l,i)}e.stroke(),e.fillStyle="#0078d4";for(let n=0;n<a.length;n++)e.beginPath(),e.arc(8+n*8,a[n],2,0,Math.PI*2),e.fill();e.fillStyle="#323130",e.font="bold 8px Arial",e.fillText("↑23%",8,55),e.fillText("$2.1M",38,55)}const o=new Image;o.src=t.toDataURL(),d.powerbi_dashboard_right=o}function st(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#3776ab",e.fillRect(0,0,64,32),e.fillStyle="#ffd343",e.fillRect(0,32,64,32),e.fillStyle="#fff",e.font="bold 10px Arial",e.fillText("Python",12,20),e.fillStyle="#000",e.font="bold 8px Arial",e.fillText("scikit",8,45),e.fillText("learn",8,55),e.fillStyle="#666",e.beginPath(),e.arc(50,45,8,0,Math.PI*2),e.fill(),e.fillStyle="#fff",e.fillText("ML",46,49));const o=new Image;o.src=t.toDataURL(),d.python_sklearn=o}function rt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#ee4c2c",e.fillRect(0,0,64,32),e.fillStyle="#1a1a1a",e.fillRect(0,32,64,32),e.fillStyle="#fff",e.font="bold 10px Arial",e.fillText("PyTorch",10,20),e.fillStyle="#00d084",e.font="bold 8px Arial",e.fillText("Lang",8,45),e.fillText("Chain",8,55),e.strokeStyle="#00d084",e.lineWidth=2,e.beginPath(),e.arc(45,45,4,0,Math.PI*2),e.stroke(),e.beginPath(),e.arc(52,45,4,0,Math.PI*2),e.stroke(),e.beginPath(),e.moveTo(49,45),e.lineTo(48,45),e.stroke());const o=new Image;o.src=t.toDataURL(),d.pytorch_langchain=o}function ct(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Rec Tree",5,12),e.strokeStyle="#4a5568",e.lineWidth=1,e.fillStyle="#e53e3e",e.fillRect(28,18,8,6),e.fillStyle="#3182ce",e.fillRect(18,30,8,6),e.fillRect(38,30,8,6),e.fillStyle="#38a169",e.fillRect(10,42,6,5),e.fillRect(20,42,6,5),e.fillRect(38,42,6,5),e.fillRect(48,42,6,5),e.beginPath(),e.moveTo(32,24),e.lineTo(22,30),e.moveTo(32,24),e.lineTo(42,30),e.moveTo(22,36),e.lineTo(13,42),e.moveTo(22,36),e.lineTo(23,42),e.moveTo(42,36),e.lineTo(41,42),e.moveTo(42,36),e.lineTo(51,42),e.stroke(),e.fillStyle="#ffd700",e.font="6px Arial",e.fillText("0.89",10,58),e.fillText("0.76",20,58),e.fillText("0.91",38,58),e.fillText("0.82",48,58));const o=new Image;o.src=t.toDataURL(),d.recommendation_tree=o}function ft(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#0078d4",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Azure",18,15),e.font="bold 7px Arial",e.fillText("Machine",12,28),e.fillText("Learning",12,38),e.strokeStyle="#fff",e.lineWidth=2,e.beginPath(),e.moveTo(10,50),e.lineTo(25,50),e.lineTo(40,50),e.lineTo(55,50),e.stroke(),e.fillStyle="#fff",e.beginPath(),e.arc(10,50,3,0,Math.PI*2),e.arc(25,50,3,0,Math.PI*2),e.arc(40,50,3,0,Math.PI*2),e.arc(55,50,3,0,Math.PI*2),e.fill());const o=new Image;o.src=t.toDataURL(),d.azure_ml=o}function dt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#0078d4",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Azure",18,15),e.font="bold 7px Arial",e.fillText("Data",20,28),e.fillText("Factory",16,38),e.strokeStyle="#fff",e.lineWidth=2,e.fillStyle="#fff",e.fillRect(8,45,8,6),e.beginPath(),e.moveTo(20,48),e.lineTo(35,48),e.stroke(),e.fillStyle="#ffd700",e.beginPath(),e.arc(35,48,4,0,Math.PI*2),e.fill(),e.strokeStyle="#fff",e.beginPath(),e.moveTo(39,48),e.lineTo(50,48),e.stroke(),e.fillStyle="#fff",e.fillRect(50,45,8,6));const o=new Image;o.src=t.toDataURL(),d.azure_data_factory=o}function ht(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){const a=e.createLinearGradient(0,0,0,64);a.addColorStop(0,"#1a202c"),a.addColorStop(1,"#2d3748"),e.fillStyle=a,e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Chatbot AI",5,12),e.fillStyle="#3182ce",e.fillRect(35,20,24,8),e.fillStyle="#fff",e.font="6px Arial",e.fillText("Hello!",38,26),e.fillStyle="#00d084",e.fillRect(5,32,30,8),e.fillStyle="#fff",e.fillText("How can I help?",7,38),e.fillStyle="#3182ce",e.fillRect(28,44,31,8),e.fillStyle="#fff",e.fillText("Recommend...",30,50),e.fillStyle="#ffd700",e.beginPath(),e.arc(12,58,6,0,Math.PI*2),e.fill(),e.fillStyle="#1a202c",e.beginPath(),e.arc(10,56,1,0,Math.PI*2),e.arc(14,56,1,0,Math.PI*2),e.fill(),e.strokeStyle="#1a202c",e.lineWidth=1,e.beginPath(),e.arc(12,58,3,0,Math.PI),e.stroke(),e.fillStyle="#9ca3af",e.font="6px Arial",e.fillText("●●●",45,58)}const o=new Image;o.src=t.toDataURL(),d.chatbot_ai=o}function gt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#000000",e.fillRect(0,0,64,64),e.fillStyle="#86bc25",e.font="bold 9px Arial",e.fillText("Deloitte",12,20),e.font="bold 8px Arial",e.fillText("Consulting",8,32),e.fillStyle="#86bc25",e.beginPath(),e.arc(56,16,2,0,Math.PI*2),e.fill(),e.font="6px Arial",e.fillText("2022-2023",15,55));const o=new Image;o.src=t.toDataURL(),d.deloitte_consulting=o}function mt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a202c",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Gantt Chart",5,12),e.fillStyle="#4a5568",e.fillRect(0,16,64,8),e.fillStyle="#fff",e.font="6px Arial",e.fillText("Q1",8,22),e.fillText("Q2",24,22),e.fillText("Q3",40,22),e.fillText("Q4",56,22),e.fillStyle="#3182ce",e.fillRect(6,28,18,4),e.fillStyle="#10b981",e.fillRect(14,36,24,4),e.fillStyle="#f59e0b",e.fillRect(32,44,20,4),e.fillStyle="#ef4444",e.fillRect(48,52,12,4),e.fillStyle="#86bc25",e.fillRect(6,28,12,4),e.fillRect(14,36,16,4),e.fillRect(32,44,8,4),e.strokeStyle="#dc2626",e.lineWidth=1,e.setLineDash([2,2]),e.beginPath(),e.moveTo(28,25),e.lineTo(28,58),e.stroke(),e.setLineDash([]));const o=new Image;o.src=t.toDataURL(),d.gantt_chart=o}function ut(){console.log("🔴 Creating R&D System Engineer visualization tiles..."),pt(),yt(),bt(),xt(),wt(),At(),vt(),kt(),St(),Tt(),It(),Et(),Mt(),Rt(),Ct(),Pt(),Dt(),console.log("✅ R&D System Engineer visualization tiles created")}function pt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("IR Spectrum",5,12),e.fillStyle="#ff4444",e.font="6px Arial",e.fillText("Hot",5,22),e.fillStyle="#4444ff",e.fillText("Cold",45,22);const a=e.createLinearGradient(0,25,64,25);a.addColorStop(0,"#000080"),a.addColorStop(.3,"#0080ff"),a.addColorStop(.5,"#00ff00"),a.addColorStop(.7,"#ffff00"),a.addColorStop(.9,"#ff8000"),a.addColorStop(1,"#ff0000"),e.fillStyle=a,e.fillRect(5,25,54,20),e.fillStyle="#fff",e.font="5px Arial",e.fillText("3-5μm",8,52),e.fillText("8-12μm",35,52),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(5,25,20,20),e.strokeRect(35,25,24,20)}const o=new Image;o.src=t.toDataURL(),d.ir_spectrum=o}function yt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 7px Arial",e.fillText("Atmos Trans",5,12),e.strokeStyle="#666",e.lineWidth=1,e.beginPath(),e.moveTo(10,55),e.lineTo(58,55),e.moveTo(10,55),e.lineTo(10,20),e.stroke(),e.fillStyle="#aaa",e.font="5px Arial",e.fillText("λ(μm)",45,60),e.fillText("T%",2,25),e.strokeStyle="#00ff88",e.lineWidth=2,e.beginPath();const a=[{x:12,y:45},{x:16,y:35},{x:20,y:25},{x:24,y:25},{x:28,y:25},{x:32,y:45},{x:36,y:45},{x:40,y:25},{x:44,y:25},{x:48,y:25},{x:52,y:45},{x:56,y:50}];for(let n=0;n<a.length;n++)n===0?e.moveTo(a[n].x,a[n].y):e.lineTo(a[n].x,a[n].y);e.stroke(),e.fillStyle="rgba(0, 255, 136, 0.2)",e.fillRect(20,20,8,35),e.fillRect(40,20,8,35)}const o=new Image;o.src=t.toDataURL(),d.atmospheric_transmission=o}function bt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Multi-Cam",12,12),e.fillStyle="#444",e.beginPath(),e.arc(32,32,12,0,Math.PI*2),e.fill(),[{angle:0,color:"#ff4444"},{angle:Math.PI/2,color:"#44ff44"},{angle:Math.PI,color:"#4444ff"},{angle:3*Math.PI/2,color:"#ffff44"},{angle:Math.PI/4,color:"#ff44ff"},{angle:3*Math.PI/4,color:"#44ffff"}].forEach(n=>{const l=32+Math.cos(n.angle)*18,i=32+Math.sin(n.angle)*18;e.fillStyle=n.color,e.fillRect(l-3,i-3,6,6),e.strokeStyle=n.color,e.lineWidth=1,e.globalAlpha=.3,e.beginPath(),e.moveTo(l,i),e.arc(l,i,12,n.angle-Math.PI/6,n.angle+Math.PI/6),e.closePath(),e.stroke(),e.globalAlpha=1}),e.fillStyle="#fff",e.font="6px Arial",e.fillText("360°",26,58));const o=new Image;o.src=t.toDataURL(),d.multi_camera_array=o}function xt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#C8102E",e.fillRect(0,0,64,64),e.fillStyle="#ffffff",e.font="bold 12px Arial",e.textAlign="center",e.fillText("Leonardo",32,26),e.font="bold 10px Arial",e.fillText("SpA",32,42),e.font="8px Arial",e.fillText("2024 - present",32,56));const o=new Image;o.src=t.toDataURL(),d.leonardo_spa=o}function wt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Detection",8,12),e.fillStyle="#333",e.fillRect(5,18,54,40),[{x:15,y:25,w:12,h:8,conf:"0.92",color:"#00ff88"},{x:35,y:30,w:10,h:10,conf:"0.87",color:"#ffaa00"},{x:45,y:40,w:8,h:6,conf:"0.76",color:"#ff4444"}].forEach(n=>{e.fillStyle=n.color,e.globalAlpha=.6,e.fillRect(n.x+2,n.y+2,n.w-4,n.h-4),e.globalAlpha=1,e.strokeStyle=n.color,e.lineWidth=1,e.strokeRect(n.x,n.y,n.w,n.h),e.fillStyle=n.color,e.font="5px Arial",e.fillText(n.conf,n.x,n.y-1)}));const o=new Image;o.src=t.toDataURL(),d.object_detection=o}function At(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Kalman",15,12),e.strokeStyle="#4444ff",e.lineWidth=2,e.setLineDash([3,3]),e.beginPath(),e.moveTo(10,50),e.quadraticCurveTo(25,30,50,25),e.stroke(),e.setLineDash([]),e.fillStyle="#ff4444";const a=[{x:12,y:48},{x:20,y:38},{x:30,y:32},{x:42,y:28},{x:48,y:26}];a.forEach(n=>{e.beginPath(),e.arc(n.x,n.y,2,0,Math.PI*2),e.fill()}),e.strokeStyle="#00ff88",e.lineWidth=1,a.forEach((n,l)=>{const i=4+l*1.5;e.beginPath(),e.ellipse(n.x,n.y,i,i*.6,0,0,Math.PI*2),e.stroke()}),e.font="5px Arial",e.fillStyle="#4444ff",e.fillText("Pred",5,20),e.fillStyle="#ff4444",e.fillText("Meas",5,28),e.fillStyle="#00ff88",e.fillText("Uncert",5,36)}const o=new Image;o.src=t.toDataURL(),d.kalman_filter=o}function vt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Opt Flow",12,12),e.strokeStyle="#00ffaa",e.lineWidth=1;for(let a=15;a<55;a+=12)for(let n=20;n<55;n+=12){const l=(a-32)*.1+Math.sin(a*.1)*3,i=(n-35)*.1+Math.cos(n*.1)*2;e.beginPath(),e.moveTo(a,n),e.lineTo(a+l,n+i),e.stroke();const c=Math.atan2(i,l);e.beginPath(),e.moveTo(a+l,n+i),e.lineTo(a+l-3*Math.cos(c-Math.PI/6),n+i-3*Math.sin(c-Math.PI/6)),e.moveTo(a+l,n+i),e.lineTo(a+l-3*Math.cos(c+Math.PI/6),n+i-3*Math.sin(c+Math.PI/6)),e.stroke()}}const o=new Image;o.src=t.toDataURL(),d.optical_flow=o}function kt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("360° Warn",8,12),e.fillStyle="#444",e.beginPath(),e.arc(32,32,8,0,Math.PI*2),e.fill(),[{start:0,end:Math.PI/2,color:"#00ff88"},{start:Math.PI/2,end:Math.PI,color:"#ffaa00"},{start:Math.PI,end:3*Math.PI/2,color:"#ff4444"},{start:3*Math.PI/2,end:2*Math.PI,color:"#4488ff"}].forEach(n=>{e.fillStyle=n.color,e.globalAlpha=.3,e.beginPath(),e.moveTo(32,32),e.arc(32,32,25,n.start,n.end),e.closePath(),e.fill(),e.globalAlpha=1,e.strokeStyle=n.color,e.lineWidth=2,e.beginPath(),e.moveTo(32,32),e.lineTo(32+Math.cos(n.start)*25,32+Math.sin(n.start)*25),e.stroke()}),e.strokeStyle="#666",e.lineWidth=1,e.beginPath(),e.arc(32,32,15,0,Math.PI*2),e.stroke(),e.beginPath(),e.arc(32,32,25,0,Math.PI*2),e.stroke(),e.fillStyle="#aaa",e.font="5px Arial",e.fillText("20km",5,58),e.fillText("40km",45,58));const o=new Image;o.src=t.toDataURL(),d.coverage_360=o}function St(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Threats",15,12),e.strokeStyle="#00ff88",e.lineWidth=1,e.strokeRect(5,16,54,42),[{x:15,y:25,level:"HIGH",color:"#ff4444"},{x:35,y:30,level:"MED",color:"#ffaa00"},{x:45,y:40,level:"LOW",color:"#44ff44"}].forEach((n,l)=>{e.fillStyle=n.color,e.beginPath(),e.moveTo(n.x,n.y-3),e.lineTo(n.x-3,n.y+3),e.lineTo(n.x+3,n.y+3),e.closePath(),e.fill(),e.font="5px Arial",e.fillText(n.level,n.x-6,n.y+8),e.fillStyle="#aaa",e.font="4px Arial",e.fillText(`${15+l*5}km`,n.x-8,n.y+12),e.fillText(`${45+l*30}°`,n.x-6,n.y+16)}),e.fillStyle="#00ff88",e.fillRect(8,52,6,4),e.fillStyle="#fff",e.font="5px Arial",e.fillText("ACTIVE",16,55));const o=new Image;o.src=t.toDataURL(),d.threat_interface=o}function Tt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("MTT",25,12),[{x:15,y:25,id:"T1",color:"#ff4444",history:[{x:10,y:30},{x:12,y:28},{x:15,y:25}]},{x:40,y:35,id:"T2",color:"#44ff44",history:[{x:35,y:30},{x:38,y:32},{x:40,y:35}]},{x:25,y:45,id:"T3",color:"#4444ff",history:[{x:20,y:50},{x:22,y:48},{x:25,y:45}]}].forEach(n=>{e.strokeStyle=n.color,e.lineWidth=1,e.globalAlpha=.5,e.beginPath(),n.history.forEach((l,i)=>{i===0?e.moveTo(l.x,l.y):e.lineTo(l.x,l.y)}),e.stroke(),e.globalAlpha=1,e.fillStyle=n.color,e.beginPath(),e.arc(n.x,n.y,3,0,Math.PI*2),e.fill(),e.font="6px Arial",e.fillText(n.id,n.x+5,n.y-2),e.strokeStyle=n.color,e.lineWidth=2,e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(n.x+8,n.y-3),e.stroke()}),e.fillStyle="#fff",e.font="5px Arial",e.fillText("3 TRACKS",5,58));const o=new Image;o.src=t.toDataURL(),d.multi_target_tracking=o}function It(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#e97627",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 10px Arial",e.fillText("MATLAB",8,18),e.font="bold 8px Arial",e.fillText("Simulink",10,30),e.strokeStyle="#fff",e.fillStyle="rgba(255, 255, 255, 0.2)",e.lineWidth=1,e.fillRect(8,38,12,8),e.strokeRect(8,38,12,8),e.fillStyle="#fff",e.font="5px Arial",e.fillText("In",12,44),e.fillStyle="rgba(255, 255, 255, 0.2)",e.fillRect(25,36,14,12),e.strokeRect(25,36,14,12),e.fillStyle="#fff",e.fillText("Filter",27,43),e.fillStyle="rgba(255, 255, 255, 0.2)",e.fillRect(44,38,12,8),e.strokeRect(44,38,12,8),e.fillStyle="#fff",e.fillText("Out",47,44),e.strokeStyle="#fff",e.beginPath(),e.moveTo(20,42),e.lineTo(25,42),e.moveTo(39,42),e.lineTo(44,42),e.stroke(),e.font="6px Arial",e.fillText("R2023b",18,58));const o=new Image;o.src=t.toDataURL(),d.matlab_simulink=o}function Et(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("IR System",8,12),[{x:8,y:18,w:16,h:8,label:"IR Sensor",color:"#ff4444"},{x:40,y:18,w:16,h:8,label:"ADC",color:"#44ff44"},{x:8,y:32,w:16,h:8,label:"DSP",color:"#4444ff"},{x:40,y:32,w:16,h:8,label:"CPU",color:"#ffaa00"},{x:24,y:46,w:16,h:8,label:"Display",color:"#aa44ff"}].forEach(n=>{e.fillStyle=n.color,e.globalAlpha=.3,e.fillRect(n.x,n.y,n.w,n.h),e.globalAlpha=1,e.strokeStyle=n.color,e.lineWidth=1,e.strokeRect(n.x,n.y,n.w,n.h),e.fillStyle="#fff",e.font="5px Arial",e.fillText(n.label,n.x+2,n.y+6)}),e.strokeStyle="#666",e.lineWidth=1,e.beginPath(),e.moveTo(24,22),e.lineTo(40,22),e.moveTo(16,26),e.lineTo(16,32),e.moveTo(48,26),e.lineTo(48,32),e.moveTo(24,36),e.lineTo(32,46),e.moveTo(40,36),e.lineTo(32,46),e.stroke());const o=new Image;o.src=t.toDataURL(),d.system_architecture=o}function Mt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("Specs",18,12),e.strokeStyle="#666",e.lineWidth=1;const a=5,n=3,l=16,i=7,c=6,s=18;for(let f=0;f<=a;f++)e.beginPath(),e.moveTo(c,s+f*i),e.lineTo(c+n*l,s+f*i),e.stroke();for(let f=0;f<=n;f++)e.beginPath(),e.moveTo(c+f*l,s),e.lineTo(c+f*l,s+a*i),e.stroke();e.fillStyle="#4a5568",e.fillRect(c+1,s+1,n*l-2,i-2),[{r:1,c:0,color:"#00ff88"},{r:1,c:1,color:"#ffaa00"},{r:2,c:0,color:"#00ff88"},{r:2,c:2,color:"#ff4444"},{r:3,c:1,color:"#00ff88"}].forEach(f=>{e.fillStyle=f.color,e.globalAlpha=.6,e.fillRect(c+f.c*l+1,s+f.r*i+1,l-2,i-2),e.globalAlpha=1}),e.font="4px Arial",e.fillStyle="#00ff88",e.fillText("✓ PASS",6,58),e.fillStyle="#ff4444",e.fillText("✗ FAIL",30,58)}const o=new Image;o.src=t.toDataURL(),d.requirements_specs=o}function Rt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#1a1a1a",e.fillRect(0,0,64,64),e.fillStyle="#fff",e.font="bold 8px Arial",e.fillText("IR Detector",8,12),e.fillStyle="#444",e.fillRect(18,20,28,20),e.strokeStyle="#666",e.lineWidth=1,e.strokeRect(18,20,28,20),e.fillStyle="#2a2a2a",e.beginPath(),e.arc(32,30,8,0,Math.PI*2),e.fill(),e.strokeStyle="#888",e.stroke(),e.strokeStyle="#666",e.lineWidth=.5,e.beginPath(),e.arc(32,30,6,0,Math.PI*2),e.stroke(),e.beginPath(),e.arc(32,30,4,0,Math.PI*2),e.stroke(),e.strokeStyle="#666",e.lineWidth=1;for(let a=0;a<5;a++){const n=20+a*5;e.beginPath(),e.moveTo(n,42),e.lineTo(n,48),e.stroke()}e.fillStyle="#aaa",e.font="5px Arial",e.fillText("MWIR/LWIR",15,52),e.fillText("InSb/MCT",18,58),e.fillStyle="#d4af37";for(let a=0;a<3;a++)e.fillRect(46+a*2,35,1,4)}const o=new Image;o.src=t.toDataURL(),d.ir_detector=o}function Ct(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#6e6e6e",e.fillRect(0,0,64,64);const a=16,n=8,l=1;e.fillStyle="#5a5a5a";for(let i=0;i<64;i+=n+l)e.fillRect(0,i,64,l);for(let i=0;i<Math.ceil(64/(n+l));i++){const c=i*(n+l),s=i%2*(a/2);for(let r=s;r<64+a;r+=a+l)e.fillRect(r,c,l,n+l)}e.globalAlpha=.1;for(let i=0;i<Math.ceil(64/(n+l));i++)for(let c=0;c<Math.ceil(64/(a+l));c++){const s=c*(a+l)+i%2*(a/2),r=i*(n+l),f=Math.random()*.3-.15;e.fillStyle=f>0?"#ffffff":"#000000",e.fillRect(s+l,r+l,a-l,n-l)}e.globalAlpha=1,e.fillStyle="rgba(0, 0, 0, 0.1)",e.fillRect(62,0,2,64),e.fillRect(0,62,64,2)}const o=new Image;o.src=t.toDataURL(),d.brick_wall=o}function Pt(){[{name:"flag_au",code:"AU",colors:["#012169","#ffffff","#ff0000"]},{name:"flag_us",code:"US",colors:["#b22234","#ffffff","#3c3b6e"]},{name:"flag_jp",code:"JP",colors:["#ffffff","#bc002d"]},{name:"flag_vn",code:"VN",colors:["#da251d","#ffff00"]},{name:"flag_mv",code:"MV",colors:["#d21034","#007e3a","#ffffff"]},{name:"flag_it",code:"IT",colors:["#009246","#ffffff","#ce2b37"]},{name:"flag_fr",code:"FR",colors:["#0055a4","#ffffff","#ef4135"]},{name:"flag_de",code:"DE",colors:["#000000","#dd0000","#ffce00"]},{name:"flag_es",code:"ES",colors:["#aa151b","#f1bf00","#aa151b"]},{name:"flag_gb",code:"GB",colors:["#012169","#ffffff","#c8102e"]},{name:"flag_nl",code:"NL",colors:["#21468b","#ffffff","#ae1c28"]},{name:"flag_ch",code:"CH",colors:["#ff0000","#ffffff"]},{name:"flag_ma",code:"MA",colors:["#c1272d","#006233"]},{name:"flag_eg",code:"EG",colors:["#ce1126","#ffffff","#000000"]}].forEach(e=>{const o=document.createElement("canvas");o.width=64,o.height=64;const a=o.getContext("2d");if(a){if(a.fillStyle=e.colors[0],a.fillRect(0,0,64,64),e.colors.length>=2)if(e.code==="IT"||e.code==="FR"||e.code==="NL")a.fillStyle=e.colors[1],a.fillRect(21,0,22,64),e.colors[2]&&(a.fillStyle=e.colors[2],a.fillRect(43,0,21,64));else if(e.code==="DE"||e.code==="EG")a.fillStyle=e.colors[1],a.fillRect(0,21,64,22),e.colors[2]&&(a.fillStyle=e.colors[2],a.fillRect(0,43,64,21));else if(e.code==="US"){a.fillStyle=e.colors[1],a.fillRect(0,0,64,64),a.fillStyle=e.colors[0];for(let l=0;l<7;l++)a.fillRect(0,l*10+2,64,5);a.fillStyle=e.colors[2],a.fillRect(0,0,28,36),a.fillStyle=e.colors[1],a.font="4px Arial";for(let l=0;l<5;l++)for(let i=0;i<6;i++)(l+i)%2===0&&a.fillText("★",3+i*4,6+l*6)}else if(e.code==="AU"){a.fillStyle=e.colors[0],a.fillRect(0,0,64,64);const l=32,i=32;a.fillStyle=e.colors[1],a.fillRect(0,0,l,i),a.fillStyle=e.colors[0],a.fillRect(0,0,l,i),a.fillStyle=e.colors[1],a.lineWidth=4,a.beginPath(),a.moveTo(0,0),a.lineTo(l,i),a.moveTo(0,i),a.lineTo(l,0),a.stroke(),a.fillStyle=e.colors[1],a.fillRect(0,i/2-2,l,4),a.fillRect(l/2-2,0,4,i),a.fillStyle=e.colors[2],a.fillRect(0,i/2-1,l,2),a.fillRect(l/2-1,0,2,i),a.strokeStyle=e.colors[2],a.lineWidth=2,a.beginPath(),a.moveTo(2,0),a.lineTo(l,i-2),a.moveTo(0,2),a.lineTo(l-2,i),a.moveTo(l-2,0),a.lineTo(0,i-2),a.moveTo(l,2),a.lineTo(2,i),a.stroke(),a.fillStyle=e.colors[1],a.font="6px Arial",a.fillText("★",40,20),a.fillText("★",50,30),a.fillText("★",45,40),a.fillText("★",55,50),a.fillText("★",35,55)}else e.code==="GB"?(a.fillStyle=e.colors[0],a.fillRect(0,0,64,64),a.fillStyle=e.colors[1],a.fillRect(0,28,64,8),a.fillRect(28,0,8,64),a.fillStyle=e.colors[2],a.fillRect(0,30,64,4),a.fillRect(30,0,4,64)):e.code==="JP"?(a.fillStyle=e.colors[0],a.fillRect(0,0,64,64),a.fillStyle=e.colors[1],a.beginPath(),a.arc(32,32,16,0,Math.PI*2),a.fill()):e.code==="ES"?(a.fillStyle=e.colors[0],a.fillRect(0,0,64,16),a.fillStyle=e.colors[1],a.fillRect(0,16,64,32),a.fillStyle=e.colors[2],a.fillRect(0,48,64,16)):e.code==="CH"?(a.fillStyle=e.colors[0],a.fillRect(0,0,64,64),a.fillStyle=e.colors[1],a.fillRect(0,24,64,16),a.fillRect(24,0,16,64)):(a.fillStyle=e.colors[1],a.fillRect(0,32,64,32));a.fillStyle="#000000",a.font="bold 8px Arial",a.textAlign="center",a.strokeStyle="#ffffff",a.lineWidth=2,a.strokeText(e.code,32,58),a.fillText(e.code,32,58)}const n=new Image;n.src=o.toDataURL(),d[e.name]=n})}function Dt(){console.log("🎯 Creating Boss Room tiles..."),_t(),Lt(),console.log("✅ Boss Room tiles created")}function _t(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");if(e){e.fillStyle="#228B22",e.fillRect(0,0,64,64);const a=d.main_guy_sprite_sheet;a?e.drawImage(a,0,0,36,36,5,5,54,54):(e.fillStyle="#fff",e.font="12px Arial",e.textAlign="center",e.fillText("BOSS",32,35))}const o=new Image;o.src=t.toDataURL(),d.main_guy=o}function Lt(){const t=document.createElement("canvas");t.width=64,t.height=64;const e=t.getContext("2d");e&&(e.fillStyle="#228B22",e.fillRect(0,0,64,64),[{x:15,y:20,color:"#ff69b4",size:4},{x:35,y:15,color:"#ffd700",size:3},{x:45,y:35,color:"#ff6347",size:4},{x:20,y:45,color:"#9370db",size:3},{x:50,y:50,color:"#00ced1",size:3}].forEach(n=>{e.fillStyle=n.color;for(let l=0;l<5;l++){const i=l*Math.PI*2/5,c=n.x+Math.cos(i)*n.size,s=n.y+Math.sin(i)*n.size;e.beginPath(),e.arc(c,s,n.size/2,0,Math.PI*2),e.fill()}e.fillStyle="#ffff00",e.beginPath(),e.arc(n.x,n.y,n.size/3,0,Math.PI*2),e.fill(),e.strokeStyle="#228b22",e.lineWidth=1,e.beginPath(),e.moveTo(n.x,n.y+n.size/3),e.lineTo(n.x,n.y+n.size+2),e.stroke()}));const o=new Image;o.src=t.toDataURL(),d.flower=o}function Ae(){return d}ne.getAssets=Ae;const re=32,ce=32,Q=64;function Bt(){const t=ne.getAssets().player_sprite_sheet;function e(o,a){const n=document.createElement("canvas");n.width=Q,n.height=Q;const l=n.getContext("2d");if(!l)throw new Error("Failed to get 2D context");return l.drawImage(t,a*re,o*ce,re,ce,0,0,Q,Q),n}p.down_walk.push(e(0,0)),p.right_walk.push(e(1,1)),p.up_walk.push(e(2,1)),p.down_idle.push(p.down_walk[0]),p.right_idle.push(p.right_walk[0]),p.up_idle.push(p.up_walk[0])}let C=!1,v=null,D=null;const fe={x:5,y:1},Ft=1,Ut=2e3;function Wt(){jt(),console.log("Boss interaction system initialized")}function jt(){v=document.createElement("div"),v.id="boss-interaction-prompt",v.style.cssText=`
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 15px 25px;
    border-radius: 12px;
    font-family: Arial, sans-serif;
    font-size: 18px;
    font-weight: bold;
    display: none;
    z-index: 1500;
    border: 3px solid #FFD700;
    text-align: center;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.7);
    animation: pulse 2s infinite;
  `;const t=document.createElement("style");t.textContent=`
    @keyframes pulse {
      0% { border-color: #FFD700; }
      50% { border-color: #FFA500; }
      100% { border-color: #FFD700; }
    }
  `,document.head.appendChild(t),v.innerHTML=`
    <div>💬 Press SPACE to talk to Nicolo</div>
    <div style="font-size: 14px; margin-top: 5px; opacity: 0.8;">Ask questions about my CV and experience!</div>
  `,document.body.appendChild(v)}function Nt(){if(oe().id!=="room2")return C&&V(),!1;const o=Math.abs(h.x-fe.x)+Math.abs(h.y-fe.y)<=Ft;return o&&!C?(zt(),C=!0,console.log("Player is near boss - showing interaction prompt")):!o&&C&&(V(),C=!1,console.log("Player left boss proximity - hiding prompt")),o}function zt(){v&&(v.style.display="block",D&&clearTimeout(D),D=window.setTimeout(()=>{V(),console.log("Boss interaction prompt auto-dismissed after timeout")},Ut))}function V(){v&&(v.style.display="none"),D&&(clearTimeout(D),D=null)}function Ot(){return C}let M={},k=null,G=null,_=null;const Yt=200,Ht=2e3;function Qt(){document.addEventListener("keydown",qt),document.addEventListener("keyup",Jt),Gt()}function Gt(){k=document.createElement("div"),k.id="door-message",k.style.cssText=`
    position: fixed;
    bottom: 120px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    font-family: Arial, sans-serif;
    font-size: 16px;
    display: none;
    z-index: 1000;
    border: 2px solid #fff;
    text-align: center;
    max-width: 300px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
  `,document.body.appendChild(k)}function $t(t){k&&(k.textContent=t,k.style.display="block",_&&clearTimeout(_),_=window.setTimeout(()=>{ae()},Ht))}function ae(){k&&(k.style.display="none"),_&&(clearTimeout(_),_=null)}function qt(t){const e=document.activeElement;if(e&&(e.tagName==="INPUT"||e.tagName==="TEXTAREA"))return;let o=null;switch(t.key){case"ArrowUp":case"w":case"W":o="up";break;case"ArrowDown":case"s":case"S":o="down";break;case"ArrowLeft":case"a":case"A":o="left";break;case"ArrowRight":case"d":case"D":o="right";break;case" ":if(!M[" "]){if(console.log("Action button pressed!"),Ot()){console.log("Starting boss conversation!");const a=new CustomEvent("startBossConversation");document.dispatchEvent(a)}else{const a=ye(h.x,h.y);a?(console.log(`Attempting to enter door to ${a.targetRoom}`),Me()&&(console.log("Successfully entered new room!"),ae())):console.log("No door here to interact with.")}M[t.key]=!0}t.preventDefault();return}o&&!M[t.key]&&(M[t.key]=!0,Vt(o)),t.preventDefault()}function Jt(t){const e=document.activeElement;if(!(e&&(e.tagName==="INPUT"||e.tagName==="TEXTAREA"))&&(M[t.key]=!1,["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","w","a","s","d","W","A","S","D"].includes(t.key)&&!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","w","a","s","d","W","A","S","D"].some(n=>M[n]))){X(),h.animationState="idle";const n=h.direction==="left"?"right":h.direction;h.currentAnimation=p[`${n}_idle`],h.frameIndex=0,h.animationTimer=0,ve()}}function Vt(t){X(),de(t),G=window.setInterval(()=>{({up:["ArrowUp","w","W"],down:["ArrowDown","s","S"],left:["ArrowLeft","a","A"],right:["ArrowRight","d","D"]})[t].some(n=>M[n])?de(t):X()},Yt)}function X(){G&&(clearInterval(G),G=null)}function de(t){const e=oe(),o=e.map[0].length,a=e.map.length;if(t!==h.direction){h.direction=t,h.animationState="idle";const l=h.direction==="left"?"right":h.direction;h.currentAnimation=p[`${l}_idle`],h.frameIndex=0,h.animationTimer=0}else{let l=h.x,i=h.y;if(t==="up"?i--:t==="down"?i++:t==="left"?l--:t==="right"&&l++,l>=0&&l<o&&i>=0&&i<a){const c=e.map[i][l];Re.includes(c)?(h.x=l,h.y=i,h.animationState="walk",setTimeout(()=>ve(),100)):(h.animationState="idle",console.log(`Cannot walk on tile type ${c} at (${l}, ${i})`))}else h.animationState="idle",console.log("Cannot move outside map boundaries")}const n=h.direction==="left"?"right":h.direction;h.currentAnimation=p[`${n}_${h.animationState}`],h.frameIndex=0,h.animationTimer=0}function ve(){const t=ye(h.x,h.y);t&&t.description?$t(t.description):ae()}function Xt(){const t={"btn-up":"ArrowUp","btn-down":"ArrowDown","btn-left":"ArrowLeft","btn-right":"ArrowRight","btn-action":" "};for(const[e,o]of Object.entries(t)){const a=document.getElementById(e);a&&(a.addEventListener("touchstart",n=>{n.preventDefault(),he(o)},{passive:!1}),a.addEventListener("touchend",n=>{n.preventDefault(),J(o)},{passive:!1}),a.addEventListener("mousedown",n=>{n.preventDefault(),he(o)}),a.addEventListener("mouseup",n=>{n.preventDefault(),J(o)}),a.addEventListener("mouseleave",n=>{n.preventDefault(),J(o)}),a.addEventListener("contextmenu",n=>{n.preventDefault()}))}}function he(t){const e=new KeyboardEvent("keydown",{key:t,bubbles:!0,cancelable:!0});document.dispatchEvent(e)}function J(t){const e=new KeyboardEvent("keyup",{key:t,bubbles:!0,cancelable:!0});document.dispatchEvent(e)}class Zt{isActive=!1;conversationHistory=[];modalElement=null;inputElement=null;messagesContainer=null;onAnswerCallback;onModelSwitchCallback;constructor(){this.createConversationUI()}createConversationUI(){this.modalElement=document.createElement("div"),this.modalElement.id="conversation-modal",this.modalElement.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      z-index: 2000;
      justify-content: center;
      align-items: center;
    `;const e=document.createElement("div");e.style.cssText=`
      background: linear-gradient(135deg, #1a1a2e, #16213e);
      border-radius: 20px;
      width: 90%;
      max-width: 600px;
      height: 80%;
      max-height: 500px;
      display: flex;
      flex-direction: column;
      border: 4px solid #FFD700;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
    `;const o=document.createElement("div");o.style.cssText=`
      background: linear-gradient(90deg, #FFD700, #FFA500);
      color: #1a1a2e;
      padding: 15px 20px;
      border-radius: 16px 16px 0 0;
      font-family: Arial, sans-serif;
      font-weight: bold;
      font-size: 18px;
      text-align: center;
      position: relative;
    `,o.innerHTML=`
      <div>💼 Chat with Nicolo Pedrani</div>
      <div style="font-size: 12px; font-weight: normal; margin-top: 3px;">Ask me about my professional experience and skills</div>
      <div style="font-size: 11px; margin-top: 5px; display: flex; align-items: center; gap: 10px;">
        <span>🤖 AI Model:</span>
        <select id="model-selector" style="
          background: rgba(26,26,46,0.3);
          color: #1a1a2e;
          border: 1px solid rgba(26,26,46,0.3);
          border-radius: 4px;
          padding: 2px 4px;
          font-size: 10px;
          font-weight: bold;
          cursor: pointer;
        ">
          <option value="qwen">💬 Qwen 2.5 Chat (~500MB)</option>
          <option value="distilbert">❓ DistilBERT Q&A (~65MB)</option>
        </select>
      </div>
      <button id="close-conversation" style="
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;
        color: #1a1a2e;
        font-weight: bold;
        width: 25px;
        height: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: background 0.2s;
      " onmouseover="this.style.background='rgba(26,26,46,0.1)'" onmouseout="this.style.background='none'">×</button>
    `,this.messagesContainer=document.createElement("div"),this.messagesContainer.style.cssText=`
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
    `;const a=document.createElement("div");a.style.cssText=`
      padding: 20px;
      border-top: 2px solid #333;
      display: flex;
      gap: 10px;
      align-items: center;
    `,this.inputElement=document.createElement("input"),this.inputElement.type="text",this.inputElement.placeholder="Ask me about my experience, skills, projects...",this.inputElement.style.cssText=`
      flex: 1;
      padding: 12px 15px;
      border: 2px solid #444;
      border-radius: 25px;
      background: #2a2a3e;
      color: white;
      font-family: Arial, sans-serif;
      font-size: 14px;
      outline: none;
      transition: border-color 0.3s;
    `;const n=document.createElement("button");n.textContent="Send",n.style.cssText=`
      padding: 12px 20px;
      background: linear-gradient(90deg, #FFD700, #FFA500);
      color: #1a1a2e;
      border: none;
      border-radius: 25px;
      font-family: Arial, sans-serif;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s;
    `,e.appendChild(o),e.appendChild(this.messagesContainer),a.appendChild(this.inputElement),a.appendChild(n),e.appendChild(a),this.modalElement.appendChild(e),document.body.appendChild(this.modalElement),o.querySelector("#close-conversation").addEventListener("click",()=>this.closeConversation()),n.addEventListener("click",()=>this.handleSendMessage()),this.inputElement.addEventListener("keydown",c=>{c.stopPropagation(),c.key==="Enter"&&(c.preventDefault(),this.handleSendMessage())}),this.inputElement.addEventListener("keyup",c=>{c.stopPropagation()}),this.inputElement.addEventListener("focus",()=>{this.inputElement.style.borderColor="#FFD700"}),this.inputElement.addEventListener("blur",()=>{this.inputElement.style.borderColor="#444"}),n.addEventListener("mouseenter",()=>{n.style.transform="scale(1.05)"}),n.addEventListener("mouseleave",()=>{n.style.transform="scale(1)"});const i=o.querySelector("#model-selector");i.addEventListener("change",async c=>{const s=c.target.value;if(console.log(`🔄 Player selected AI model: ${s}`),this.onModelSwitchCallback){this.inputElement&&(this.inputElement.disabled=!0,this.inputElement.placeholder="Model loading, please wait..."),i.disabled=!0;const r=this.addLoadingMessage(s);try{const f=await this.onModelSwitchCallback(s);this.removeMessage(r),f?this.addMessage({type:"ai",content:`✅ Successfully switched to ${s==="qwen"?"Qwen Chat model! I can now have more natural conversations with you.":"DistilBERT Q&A model! I can now answer your questions more precisely."}`,timestamp:new Date}):(this.addMessage({type:"ai",content:`❌ Failed to switch to ${s} model. I'll continue using the current model.`,timestamp:new Date}),i.value=s==="qwen"?"distilbert":"qwen")}catch(f){console.error("Error switching model:",f),this.removeMessage(r),this.addMessage({type:"ai",content:"❌ Error occurred while switching models. I'll continue using the current model.",timestamp:new Date}),i.value=s==="qwen"?"distilbert":"qwen"}this.inputElement&&(this.inputElement.disabled=!1,this.inputElement.placeholder="Ask me about my experience, skills, or interests..."),i.disabled=!1}}),this.modalElement.addEventListener("click",c=>{c.target===this.modalElement&&this.closeConversation()}),document.addEventListener("keydown",c=>{c.key==="Escape"&&this.isActive&&this.closeConversation()})}showConversation(){this.modalElement&&(this.modalElement.style.display="flex",this.isActive=!0,setTimeout(()=>{this.inputElement&&(this.inputElement.focus(),this.inputElement.click())},200),this.conversationHistory.length===0&&this.addMessage({type:"ai",content:"Hello! I'm Nicolo Pedrani. Feel free to ask me anything about my professional experience, technical skills, projects, or career background. You can also choose which AI model to use from the dropdown above! What would you like to know?",timestamp:new Date}))}closeConversation(){this.modalElement&&(this.modalElement.style.display="none",this.isActive=!1)}isConversationActive(){return this.isActive}setAnswerCallback(e){this.onAnswerCallback=e}setModelSwitchCallback(e){this.onModelSwitchCallback=e}updateModelSelector(e){const o=document.querySelector("#model-selector");o&&(o.value=e)}async handleSendMessage(){if(!this.inputElement||!this.inputElement.value.trim())return;const e=this.inputElement.value.trim();this.inputElement.value="",this.addMessage({type:"user",content:e,timestamp:new Date}),this.showTypingIndicator();try{const o=this.onAnswerCallback?await this.onAnswerCallback(e):"I'm sorry, the AI system is not yet connected. Please try again later.";this.hideTypingIndicator(),this.addMessage({type:"ai",content:o,timestamp:new Date})}catch(o){console.error("Error getting AI response:",o),this.hideTypingIndicator(),this.addMessage({type:"ai",content:"I apologize, but I'm having trouble processing your question right now. Please try asking something else.",timestamp:new Date})}}addMessage(e){if(this.conversationHistory.push(e),!this.messagesContainer)return;const o=document.createElement("div");o.style.cssText=`
      display: flex;
      ${e.type==="user"?"justify-content: flex-end;":"justify-content: flex-start;"}
      margin-bottom: 10px;
    `;const a=document.createElement("div");a.style.cssText=`
      max-width: 80%;
      padding: 12px 16px;
      border-radius: 18px;
      font-family: Arial, sans-serif;
      font-size: 14px;
      line-height: 1.4;
      ${e.type==="user"?"background: linear-gradient(135deg, #FFD700, #FFA500); color: #1a1a2e; border-bottom-right-radius: 6px;":"background: #2a2a3e; color: white; border-bottom-left-radius: 6px; border: 1px solid #444;"}
    `,a.textContent=e.content,o.appendChild(a),this.messagesContainer.appendChild(o),this.messagesContainer.scrollTop=this.messagesContainer.scrollHeight}addLoadingMessage(e){if(!this.messagesContainer)return"";const o=`loading-${Date.now()}`,a=document.createElement("div");a.id=o,a.style.cssText=`
      display: flex;
      justify-content: flex-start;
      margin-bottom: 10px;
    `;const n=document.createElement("div");n.style.cssText=`
      max-width: 80%;
      padding: 12px 16px;
      border-radius: 18px;
      font-family: Arial, sans-serif;
      font-size: 14px;
      line-height: 1.4;
      background: #2a2a3e;
      color: white;
      border-bottom-left-radius: 6px;
      border: 1px solid #444;
    `;const l=e==="qwen"?"Qwen 2.5 0.5B Instruct (~500MB)":"DistilBERT Q&A (~65MB)";return n.innerHTML=`
      <div id="loading-title-${o}">🔄 Loading ${l}...</div>
      <div style="margin-top: 8px;">
        <div style="width: 100%; background: #444; border-radius: 10px; height: 6px;">
          <div id="progress-bar-${o}" style="width: 0%; background: linear-gradient(90deg, #FFD700, #FFA500); height: 100%; border-radius: 10px; transition: width 0.3s ease;"></div>
        </div>
        <div id="progress-info-${o}" style="font-size: 11px; color: #888; margin-top: 4px; display: flex; justify-content: space-between;">
          <span>Initializing download...</span>
          <span>0%</span>
        </div>
        <div id="speed-info-${o}" style="font-size: 10px; color: #aaa; margin-top: 2px; text-align: center;">
          Preparing to download model files...
        </div>
      </div>
    `,a.appendChild(n),this.messagesContainer.appendChild(a),this.messagesContainer.scrollTop=this.messagesContainer.scrollHeight,a.loadingId=o,o}removeMessage(e){const o=document.getElementById(e);o&&o.remove()}updateRealProgress(e,o,a,n,l,i){const s=Array.from(document.querySelectorAll('[id^="loading-"]')).reverse().find(T=>T.id.includes("loading-"));if(!s)return;const r=s.id,f=document.getElementById(`progress-bar-${r}`),g=document.getElementById(`progress-info-${r}`),m=document.getElementById(`speed-info-${r}`);if(f&&(f.style.width=`${Math.min(o,100)}%`),g&&(g.innerHTML=`
        <span>${a}/${n} (${l} left)</span>
        <span>${o}%</span>
      `),m&&i&&i>0){const T=(i/1048576).toFixed(1),R=n.includes("MB")?parseFloat(l.replace(" MB",""))*1024*1024:parseFloat(l.replace(" KB",""))*1024,E=Math.round(R/i);m.textContent=`📊 ${T} MB/s • ETA: ${E}s`}else m&&(m.textContent="Downloading model files...")}showTypingIndicator(){if(!this.messagesContainer)return;const e=document.createElement("div");e.id="typing-indicator",e.style.cssText=`
      display: flex;
      justify-content: flex-start;
      margin-bottom: 10px;
    `;const o=document.createElement("div");o.style.cssText=`
      background: #2a2a3e;
      color: #888;
      padding: 12px 16px;
      border-radius: 18px;
      border-bottom-left-radius: 6px;
      border: 1px solid #444;
      font-family: Arial, sans-serif;
      font-size: 14px;
      animation: typingPulse 1.5s infinite;
    `,o.textContent="Nicolo is typing...";const a=document.createElement("style");a.textContent=`
      @keyframes typingPulse {
        0%, 100% { opacity: 0.5; }
        50% { opacity: 1; }
      }
    `,document.head.querySelector("style[data-typing]")||(a.setAttribute("data-typing","true"),document.head.appendChild(a)),e.appendChild(o),this.messagesContainer.appendChild(e),this.messagesContainer.scrollTop=this.messagesContainer.scrollHeight}hideTypingIndicator(){const e=document.getElementById("typing-indicator");e&&e.remove()}getConversationHistory(){return[...this.conversationHistory]}clearConversation(){this.conversationHistory=[],this.messagesContainer&&(this.messagesContainer.innerHTML="")}}const Kt="modulepreload",eo=function(t){return"/MyImmersiveExperience/"+t},ge={},to=function(e,o,a){let n=Promise.resolve();if(o&&o.length>0){let s=function(r){return Promise.all(r.map(f=>Promise.resolve(f).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");n=s(o.map(r=>{if(r=eo(r),r in ge)return;ge[r]=!0;const f=r.endsWith(".css"),g=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${g}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":Kt,f||(m.as="script"),m.crossOrigin="",m.href=r,c&&m.setAttribute("nonce",c),document.head.appendChild(m),f)return new Promise((T,R)=>{m.addEventListener("load",T),m.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${r}`)))})}))}function l(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return n.then(i=>{for(const c of i||[])c.status==="rejected"&&l(c.reason);return e().catch(l)})};let x=null,L=!1,w="",I="",b=null,Z=null,S={},P={distilbert:"pending",qwen:"pending"},y=null;const $={distilbert:{name:"Xenova/distilbert-base-cased-distilled-squad",description:"DistilBERT model optimized for question-answering",size:"~65MB",type:"qa"},qwen:{name:"onnx-community/Qwen2.5-0.5B-Instruct",description:"Qwen 2.5 0.5B Instruct - Small conversational language model",size:"~500MB",type:"chat"}},K={preferredModel:"distilbert",fallbackModels:["distilbert"],enableModelFallback:!0,useOnlyFallback:!1},u={personalInfo:`
    Nicolo Pedrani is a professional with experience in Data Science and R&D System Engineering.
    He has worked in consulting, analytics, and infrared defense systems.
    
    Personal interests and hobbies:
    - Football: Passionate about playing and watching football, enjoys both recreational games and following professional leagues
    - Extensive Travel: Has visited 14 countries across 4 continents including Italy, France, Germany, United States, Japan, Australia, Vietnam, Maldives, Spain, United Kingdom, Netherlands, Switzerland, Morocco, and Egypt
    - Reading: Enjoys reading technical literature, business books, and staying updated with industry trends
    - Cultural exploration: Through travel experiences has gained appreciation for different cultures, cuisines, and perspectives
    - Sports and fitness: Maintains active lifestyle through football and other physical activities
    - International perspective: Travel experiences have provided global mindset and cultural adaptability valuable in professional settings
  `,workExperience:`
    Deloitte Consulting - Data Science Experience:
    - NPS (Net Promoter Score) analysis and customer satisfaction analytics
    - Energy cost optimization projects
    - Fashion retail time series analysis and forecasting
    - Supply chain and distribution network mapping
    - Statistical analysis including forecast histograms and box plot analysis
    - Power BI dashboard development for business intelligence
    - Advanced analytics using Python and scikit-learn
    - Machine learning projects with PyTorch and LangChain
    - Recommendation system development
    - Azure Machine Learning and Azure Data Factory implementation
    - AI chatbot development
    - Project management with Gantt charts and timeline planning

    Leonardo SpA - R&D System Engineer Experience:
    - Infrared (IR) spectrum visualization and analysis
    - Atmospheric transmission modeling and analysis
    - Multi-camera array positioning systems
    - Object detection with bounding boxes using computer vision
    - Kalman filter implementation for state estimation
    - Optical flow motion vector analysis
    - 360-degree missile warning coverage systems
    - Threat detection interface development
    - Multiple target tracking systems
    - MATLAB and Simulink development
    - IR system architecture design
    - Requirements specification and documentation
    - IR detector hardware integration
  `,education:`
    Technical background in Data Science, Machine Learning, and System Engineering.
    Expertise in statistical analysis, computer vision, and defense systems.
  `,skills:`
    Programming: Python, MATLAB, TypeScript, JavaScript
    Data Science: scikit-learn, PyTorch, statistical analysis, time series forecasting
    Machine Learning: LangChain, recommendation systems, predictive modeling
    Cloud Platforms: Azure Machine Learning, Azure Data Factory
    Business Intelligence: Power BI, dashboard development
    Computer Vision: Object detection, optical flow, Kalman filtering
    Defense Systems: Infrared systems, missile warning systems, threat detection
    Project Management: Agile methodologies, Gantt charts
    Tools: MATLAB/Simulink, Git, various analytics platforms
  `,projects:`
    - Customer satisfaction analytics using NPS methodology
    - Energy cost optimization for large enterprises
    - Fashion retail demand forecasting using time series analysis
    - Supply chain optimization and network analysis
    - Interactive portfolio game (current project) using TypeScript and HTML5 Canvas
    - AI-powered chatbot development
    - Infrared detection and tracking systems
    - Multi-camera surveillance systems
    - Real-time threat detection and tracking
  `};async function me(t){const e=$[t];if(!e||!b)return console.error(`❌ Model key invalid or transformers not loaded: ${t}`),P[t]="error",!1;try{console.log(`🔄 Background loading ${t} model: ${e.name}`),P[t]="loading",y&&y(t,"loading",0);const o=e.type==="chat"?"text-generation":"question-answering",a={device:"webgpu",progress_callback:l=>{if(l.status==="downloading"){const i=Math.min(l.loaded?Math.floor(l.loaded/1048576):0,90);console.log(`📥 Background downloading ${t}: ~${i}MB loaded...`),y&&y(t,"downloading",i)}else l.status==="loading"&&(console.log(`🧠 Loading ${t} model into memory...`),y&&y(t,"finalizing",95))}};a.dtype="q4";const n=await b.pipeline(o,e.name,a);return S[t]={pipeline:n,modelInfo:e,loadTime:Date.now()},P[t]="completed",console.log(`✅ Background loading of ${t} completed!`),y&&y(t,"completed",100),!0}catch(o){return console.error(`❌ Failed to background load ${t} model:`,o),P[t]="error",y&&y(t,"error",0),!1}}async function oo(t){const e=$[t];if(!e||!b)return console.error(`❌ Model key invalid or transformers not loaded: ${t}`),!1;try{console.log(`🤖 Loading ${t} model: ${e.name}`),console.log(`📦 Model info: ${e.description} (${e.size})`);const o=e.type==="chat"?"text-generation":"question-answering",a={device:"webgpu",progress_callback:l=>{if(l.status==="downloading"){const i=Math.round(l.progress||0),c=l.loaded||0,s=l.total||0,r=s-c;let f="";if(l.rate&&l.rate>0){const E=(l.rate/1048576).toFixed(1),Y=r>0?Math.round(r/l.rate):0;f=` | ${E} MB/s | ${Y}s remaining`}const g=E=>{if(E===0)return"0 B";const Y=1024,Ee=["B","KB","MB","GB"],le=Math.floor(Math.log(E)/Math.log(Y));return parseFloat((E/Math.pow(Y,le)).toFixed(1))+" "+Ee[le]},m=g(c),T=g(s),R=g(r);console.log(`📥 Downloading ${t} model: ${i}% (${m}/${T}, ${R} left)${f}`),Z&&Z(t,i,m,T,R,l.rate)}else l.status==="loading"&&console.log(`🧠 Loading ${t} model into memory...`)}};a.dtype="q4",x=await b.pipeline(o,e.name,a),console.log(`🧪 Testing ${t} model...`);let n;if(e.type==="chat"){let l;try{const i=[{role:"system",content:"You are a helpful assistant."},{role:"user",content:"What is your name?"}];l=x.tokenizer.apply_chat_template(i,{tokenize:!1,add_generation_prompt:!0})}catch{t==="qwen"?l=`<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
What is your name?<|im_end|>
<|im_start|>assistant
`:l=`System: You are a helpful assistant.
User: What is your name?
Assistant:`}if(n=await x(l,{max_new_tokens:20,do_sample:!1,return_full_text:!1}),console.log(`🔍 ${t} chat test result:`,n),!n||!n[0]?.generated_text||n[0].generated_text.length<3)return console.warn(`⚠️ ${t} model test failed`),!1}else if(n=await x("What is the name?","The name is Nicolo Pedrani. He is a professional."),console.log(`🔍 ${t} Q&A test result:`,n),!n.answer||n.score<.01)return console.warn(`⚠️ ${t} model test failed`),!1;return console.log(`✅ ${t} model test successful!`),w=`${t} (${e.name})`,I=e.type,console.log(`🔄 Model switched to: ${w}`),console.log(`📝 Model type: ${I}`),!0}catch(o){return console.error(`❌ Failed to load ${t} model:`,o),!1}}async function no(){try{console.log("🔧 Checking AI system initialization..."),K.useOnlyFallback;const t=K.preferredModel;return S[t]&&P[t]==="completed"?(console.log(`⚡ Using preloaded ${t} model for initialization!`),x=S[t].pipeline,w=`${t} (${S[t].modelInfo.name})`,I=S[t].modelInfo.type,L=!0,console.log(`✅ AI system ready with preloaded ${t}!`),console.log(`📋 Active model: ${w}`),!0):(console.log("🔄 No preloaded models available, using fallback responses for now"),L=!1,w="Loading in background...",I="fallback",!0)}catch(t){return console.error("💥 AI initialization error:",t),console.log("🔄 Falling back to scripted responses"),L=!1,w="Fallback System",I="fallback",!0}}function ke(){return L&&x!==null}function Se(){const t=w.match(/^(\w+)\s*\(/);return t?t[1]:K.preferredModel}function ao(t){Z=t}async function lo(t){if(!$[t])return console.error(`❌ Invalid model key: ${t}. Available: ${Object.keys($).join(", ")}`),!1;if(console.log(`🔄 Switching to ${t} model...`),S[t]&&P[t]==="completed")return console.log(`⚡ Using preloaded ${t} model - instant switch!`),x=S[t].pipeline,w=`${t} (${S[t].modelInfo.name})`,I=S[t].modelInfo.type,L=!0,console.log(`✅ Instantly switched to preloaded ${t} model!`),console.log(`🔄 Model switched to: ${w}`),console.log(`📝 Model type: ${I}`),!0;{console.log(`🔄 Model not preloaded, loading ${t} now...`);const e=await oo(t);return e?(L=!0,console.log(`✅ Successfully switched to ${t} model!`)):console.error(`❌ Failed to switch to ${t} model`),e}}async function io(t){try{if(!ke()&&!await no())return"I'm sorry, the AI system is currently unavailable. Please try again later.";const e=so(t);if(console.log("🔍 Context Selection:",{question:t,contextPreview:e.substring(0,200)+"...",contextLength:e.length}),!e)return"I'd be happy to answer questions about my professional experience, skills, projects, or background. Could you please ask something more specific about my CV or career?";let o;if(I==="chat"){const l=[{role:"system",content:`You ARE Nicolo Pedrani. You are NOT an AI assistant. You are a real person with real experiences. Never say "As an AI" or mention being an AI language model.

You are Nicolo Pedrani, a professional Data Scientist and R&D System Engineer with actual work experience at Deloitte and Leonardo SpA. When asked about YOUR experiences, talk about them in first person as if they are YOUR real professional background.

Your background: ${e}

IMPORTANT: Always respond as Nicolo Pedrani in first person (I, my, me). Keep responses to 2-3 clear sentences. Be direct and professional. Never break character or mention being an AI.`},{role:"user",content:t}];let i;try{i=x.tokenizer.apply_chat_template(l,{tokenize:!1,add_generation_prompt:!0})}catch{console.log("Chat template not available, using Qwen-specific format"),Se()==="qwen"?i=`<|im_start|>system
You ARE Nicolo Pedrani. You are NOT an AI assistant. You are a real person with real experiences. Never say "As an AI" or mention being an AI language model.

You are Nicolo Pedrani, a professional Data Scientist and R&D System Engineer with actual work experience at Deloitte and Leonardo SpA. When asked about YOUR experiences, talk about them in first person as if they are YOUR real professional background.

Your background: ${e}

IMPORTANT: Always respond as Nicolo Pedrani in first person (I, my, me). Keep responses to 2-3 clear sentences. Be direct and professional. Never break character or mention being an AI.<|im_end|>
<|im_start|>user
${t}<|im_end|>
<|im_start|>assistant
`:i=`System: You ARE Nicolo Pedrani. You are NOT an AI assistant. You are a real person with real experiences. Never say "As an AI" or mention being an AI language model.

You are Nicolo Pedrani, a professional Data Scientist and R&D System Engineer with actual work experience at Deloitte and Leonardo SpA. When asked about YOUR experiences, talk about them in first person as if they are YOUR real professional background.

Your background: ${e}

IMPORTANT: Always respond as Nicolo Pedrani in first person (I, my, me). Keep responses to 2-3 clear sentences. Be direct and professional. Never break character or mention being an AI.

User: ${t}
Assistant: `}o={answer:(await x(i,{max_new_tokens:80,do_sample:!1,return_full_text:!1,temperature:.1}))[0]?.generated_text?.trim()||"",score:1}}else o=await x(t,e);console.log("🤖 AI Model Result:",{model:w,question:t,answer:o.answer,score:o.score,contextLength:e.length});const a=o.answer?.trim();let n="";if(a&&a.length>5&&o.score>.1)n=ue(a,t);else{console.log("⚠️ AI model returned poor answer, using fallback");const l=Te(t);n=ue(l,t)}return n||"I don't have specific information about that topic in my experience. Could you ask about my work at Deloitte, Leonardo SpA, or my technical skills?"}catch(e){return console.error("Error processing question:",e),"I apologize, but I'm having trouble processing your question right now. Please try rephrasing it or ask about my work experience, skills, or projects."}}function so(t){const e=t.toLowerCase();let o=[];const a=["work","job","experience","career","deloitte","leonardo","consulting","engineer","project","company","professional","employment"],n=["skill","technology","programming","python","matlab","machine learning","ai","data science","technical","expertise","tools","software"],l=["education","study","learn","degree","qualification","university","school","training"],i=["hobby","hobbies","travel","football","personal","interest","country","countries","visit","visited","fun","free time","leisure","sports","reading","books"],c=["project","projects","build","built","create","created","develop","developed","system","application","portfolio"],s=["travel","traveling","travelled","country","countries","visit","visited","culture","cultural","international","abroad","trip","vacation"],r=["football","soccer","sport","sports","play","playing","game","games","team","athletic"];a.some(f=>e.includes(f))&&o.push(u.workExperience),n.some(f=>e.includes(f))&&o.push(u.skills),l.some(f=>e.includes(f))&&o.push(u.education),(i.some(f=>e.includes(f))||s.some(f=>e.includes(f))||r.some(f=>e.includes(f)))&&o.push(u.personalInfo),c.some(f=>e.includes(f))&&o.push(u.projects),s.some(f=>e.includes(f))&&(o=[u.personalInfo,...o.filter(f=>f!==u.personalInfo)]),r.some(f=>e.includes(f))&&(o=[u.personalInfo,...o.filter(f=>f!==u.personalInfo)]),o.length===0&&(o=[u.workExperience,u.personalInfo,u.skills]);{const f=o.slice(0,2).join(" ").replace(/\n+/g," ").trim();return console.log("🔍 Using TARGETED context:",f.length,"characters"),f.length>800?f.substring(0,800)+"...":f}}function ue(t,e){let o=t.trim();if(o.length>100)return o;const a=e.toLowerCase();if(a.includes("deloitte")&&!o.includes("Deloitte"))o+=o?" ":"",o+="At Deloitte, I focused on data science consulting, working with various analytics tools and helping clients optimize their business processes through data-driven insights.";else if(a.includes("leonardo")&&!o.includes("Leonardo"))o+=" At Leonardo SpA, I specialized in R&D for infrared and defense systems, working on cutting-edge technology for threat detection and tracking in mission-critical applications.";else if(a.includes("skill")||a.includes("technology"))o+=" I'm passionate about staying current with emerging technologies and applying them to solve complex problems across business and technical domains.";else if(a.includes("project"))o+=" I enjoy tackling diverse projects that challenge me to combine technical expertise with creative problem-solving approaches.";else if(a.includes("football")||a.includes("soccer")){const n=[" Football has been a lifelong passion - I love both playing recreationally and following professional leagues. It's taught me valuable lessons about teamwork and strategy."," Playing football keeps me active and helps me unwind from technical work. There's something special about the team dynamics and strategic thinking involved."," I've always been drawn to football for its combination of physical skill and tactical intelligence. It's a great way to stay fit and connect with people."];o+=n[Math.floor(Math.random()*n.length)]}else if(a.includes("travel")||a.includes("country")||a.includes("visit")){const n=[" Traveling has been incredibly enriching - each of the 14 countries I've visited has taught me something new about different cultures and perspectives."," My travel experiences across 4 continents have given me a global mindset that's valuable in today's interconnected world. From the technology hubs of Japan to the ancient cultures of Morocco."," I believe travel is one of the best forms of education. Each destination - whether it's the innovation in Australia or the efficiency in Germany - offers unique insights."," Exploring different countries has shaped my worldview and made me more adaptable. It's fascinating to see how different cultures approach similar challenges."];o+=n[Math.floor(Math.random()*n.length)]}else if(a.includes("reading")||a.includes("book")){const n=[" Reading helps me stay current with industry trends and broaden my perspective beyond just technical topics."," I enjoy reading both technical literature and books on business strategy - it helps me see the bigger picture in my work."," Books have always been a great way for me to learn new concepts and stay intellectually curious."];o+=n[Math.floor(Math.random()*n.length)]}else if(a.includes("hobby")||a.includes("personal")||a.includes("interest")){const n=[" My hobbies - football, travel, and reading - all contribute to who I am professionally. They've taught me teamwork, cultural awareness, and continuous learning."," I believe having diverse interests outside of work makes me a more well-rounded person and professional. Each hobby brings something unique to the table."," Balancing technical work with active hobbies like football and enriching experiences like travel helps me maintain creativity and fresh perspectives."];o+=n[Math.floor(Math.random()*n.length)]}return o}const W={deloitte:["At Deloitte Consulting, I worked on fascinating data science projects including NPS analysis, energy cost optimization, and fashion retail forecasting. I also developed AI chatbots and recommendation systems.","My time at Deloitte was focused on data science consulting, where I helped clients optimize their business processes through analytics. I worked with tools like Power BI and developed various ML solutions.","At Deloitte, I specialized in business analytics and data science. Some highlights include working on customer satisfaction analytics, supply chain optimization, and developing advanced forecasting models."],leonardo:["At Leonardo SpA, I was an R&D System Engineer working on cutting-edge infrared and defense systems. My work involved missile warning coverage, object detection, and multi-target tracking using advanced computer vision.","Leonardo SpA was where I dove deep into defense technology - specifically infrared systems for threat detection. I worked with MATLAB/Simulink on everything from atmospheric transmission modeling to Kalman filtering.","My R&D role at Leonardo involved developing sophisticated defense systems. I worked on 360-degree missile warning coverage, optical flow analysis, and multi-camera positioning systems for threat detection."],skills:["My technical skills span both data science and systems engineering: Python, MATLAB, machine learning, computer vision, and cloud platforms like Azure. I also have experience with Power BI and various analytics tools.","I work with a diverse tech stack including Python for data science, MATLAB for system modeling, and cloud platforms like Azure ML. My experience covers everything from statistical analysis to computer vision.","My expertise includes programming in Python and MATLAB, machine learning with PyTorch and scikit-learn, cloud computing with Azure, and business intelligence with Power BI. I enjoy working across the full technology stack."],football:["Football is one of my biggest passions! I love both playing recreationally with friends and following professional leagues. It's taught me valuable lessons about teamwork, strategy, and maintaining physical fitness.","I've been passionate about football since I was young. Whether I'm playing a casual game or watching the professionals, I love the combination of physical skill, tactical thinking, and team dynamics.","Football keeps me active and helps me unwind from technical work. There's something special about the sport's blend of individual skill and team strategy that I find really engaging."],travel:["I've been fortunate to travel to 14 countries across 4 continents - from the tech innovation in Japan and Australia to the rich cultures of Morocco and Vietnam. Each destination has broadened my perspective.","My travel experiences have taken me everywhere from the ancient cultures of Egypt to the modern efficiency of Germany. Visiting places like Japan, Maldives, and various European countries has given me a global mindset.","Traveling has been incredibly enriching - whether exploring the technological landscapes of Australia and Japan or the cultural heritage of Morocco and Egypt. Each country teaches you something new about approaching challenges."]};function Te(t){const e=t.toLowerCase();if(e.includes("deloitte")){const o=W.deloitte;return o[Math.floor(Math.random()*o.length)]}else if(e.includes("leonardo")){const o=W.leonardo;return o[Math.floor(Math.random()*o.length)]}else if(e.includes("skill")||e.includes("technology")){const o=W.skills;return o[Math.floor(Math.random()*o.length)]}else if(e.includes("football")||e.includes("soccer")){const o=W.football;return o[Math.floor(Math.random()*o.length)]}else if(e.includes("travel")||e.includes("country")||e.includes("visit")){const o=W.travel;return o[Math.floor(Math.random()*o.length)]}else return e.includes("experience")||e.includes("work")?"I have experience in both Data Science consulting at Deloitte and R&D System Engineering at Leonardo SpA. I've worked on projects ranging from business analytics and machine learning to infrared defense systems and computer vision.":e.includes("reading")||e.includes("book")?"I'm an avid reader who enjoys both technical literature and business books. Reading helps me stay current with industry trends and broaden my perspective beyond just technical topics.":e.includes("hobby")||e.includes("personal")||e.includes("interest")?"My main hobbies are football, traveling, and reading. These interests have shaped me both personally and professionally - football taught me teamwork, travel gave me cultural awareness, and reading keeps me intellectually curious.":e.includes("culture")||e.includes("international")?"My international travel experiences have given me a global perspective that's valuable in today's interconnected world. I've experienced everything from the tech innovation in Japan to the rich history of Morocco.":"I'm a professional with diverse experience in data science consulting and R&D engineering. Feel free to ask about my work at Deloitte, Leonardo SpA, my technical skills, my hobbies, or my travel experiences!"}function ro(t){y=t}async function co(){if(!b){console.log("🔧 Loading Transformers.js before starting background loading...");try{b=await to(()=>import("https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.7.1"),[]),console.log("✅ Transformers.js loaded for background loading"),b.env&&(b.env.allowRemoteModels=!0,b.env.allowLocalModels=!1,b.env.useBrowserCache=!0)}catch(t){console.error("❌ Failed to load transformers for background loading:",t);return}}console.log("🚀 Starting background model preloading..."),me("distilbert").then(t=>{t?(console.log("🎯 DistilBERT preloaded successfully! Starting Qwen preloading..."),me("qwen").then(e=>{console.log(e?"🎉 All models preloaded successfully!":"⚠️ Qwen preloading failed, but DistilBERT is ready")})):console.log("⚠️ DistilBERT preloading failed, skipping Qwen")})}const fo=Array(be).fill(null).map(()=>Array(xe).fill(0)),{canvas:O,ctx:ee,TILE_SIZE:ho,GAME_WIDTH:B,GAME_HEIGHT:N}=Ce(fo);if(!O)throw console.error("Canvas element not found! Make sure there's a canvas with id='gameCanvas'"),new Error("Canvas not found");if(!ee)throw console.error("Could not get 2D context from canvas"),new Error("Canvas context not available");O.width=B;O.height=N;console.log(`Canvas initialized: ${B}x${N} (${xe}x${be} tiles)`);we(O);window.addEventListener("resize",()=>we(O));const F=new Zt;document.addEventListener("startBossConversation",()=>{F.showConversation(),setTimeout(()=>{F.updateModelSelector(Se())},300)});F.setAnswerCallback(async t=>ke()?await io(t):Te(t));F.setModelSwitchCallback(async t=>{console.log(`🔄 Switching to ${t} model...`);try{const e=await lo(t);return e?console.log(`✅ Successfully switched to ${t} model!`):console.error(`❌ Failed to switch to ${t} model`),e}catch(e){return console.error(`💥 Error switching to ${t} model:`,e),!1}});ao((t,e,o,a,n,l)=>{F.updateRealProgress(t,e,o,a,n,l)});ro((t,e,o)=>{console.log(`🔄 Background loading ${t}: ${e} ${o?`(${o}MB)`:""}`),e==="completed"&&console.log(`⚡ ${t} model ready for instant switching!`)});let pe=0,te=!1;function go(){te||(te=!0,console.log("Game started!"),requestAnimationFrame(Ie))}function Ie(t){if(!te)return;const e=(t-pe)/1e3;pe=t,De(e),F.isConversationActive()||Nt(),ee&&mo(ee,ho),requestAnimationFrame(Ie)}function mo(t,e){t.clearRect(0,0,B,N);const o=Ae(),a=oe(),n=a.map;if(!o.grass){t.fillStyle="#333",t.fillRect(0,0,B,N),t.fillStyle="#fff",t.font="20px Arial",t.textAlign="center",t.fillText("Loading assets...",B/2,N/2);return}for(let l=0;l<n.length;l++)for(let i=0;i<n[0].length;i++){const c=n[l][i];let s=null;switch(c){case 0:s=o.grass;break;case 1:s=o.oak_tree;break;case 2:case 3:case 4:case 5:s=o.path;break;case 6:s=o.door;break;case 7:s=o.library_floor;break;case 8:s=o.library_bsA||o.library_bsB||o.library_bsC;break;case 9:s=o.football_center||o.football_0;break;case 10:s=o.flag_it||o.flag_fr||o.flag_de||o.flag_us;break;case 11:s=o.library_table;break;case 12:s=o.library_chair;break;case 13:s=o.library_rug;break;case 14:s=o.tree_t1||o.tree_t2||o.tree_t3;break;case 15:break;case 16:s=o.football_0;break;case 17:s=o.football_1;break;case 18:s=o.football_2;break;case 19:s=o.football_3;break;case 20:s=o.football_4;break;case 21:s=o.football_5;break;case 22:s=o.football_6;break;case 23:s=o.football_7;break;case 24:s=o.football_8;break;case 25:s=o.football_9;break;case 26:s=o.football_10;break;case 27:s=o.football_11;break;case 28:s=o.world_map;break;case 29:s=o.nps_chart;break;case 30:s=o.energy_cost_chart;break;case 31:s=o.fashion_retail_timeseries;break;case 32:s=o.distribution_network_map;break;case 33:s=o.forecast_histogram;break;case 34:s=o.box_plot;break;case 35:s=o.deloitte_consulting;break;case 36:s=o.powerbi_dashboard_left;break;case 37:s=o.powerbi_dashboard_right;break;case 38:s=o.python_sklearn;break;case 39:s=o.pytorch_langchain;break;case 40:s=o.recommendation_tree;break;case 41:s=o.azure_ml;break;case 42:s=o.azure_data_factory;break;case 43:s=o.chatbot_ai;break;case 44:s=o.gantt_chart;break;case 45:s=o.ir_spectrum;break;case 46:s=o.atmospheric_transmission;break;case 47:s=o.multi_camera_array;break;case 48:s=o.leonardo_spa;break;case 49:s=o.object_detection;break;case 50:s=o.kalman_filter;break;case 51:s=o.optical_flow;break;case 52:s=o.coverage_360;break;case 53:s=o.threat_interface;break;case 54:s=o.multi_target_tracking;break;case 55:s=o.matlab_simulink;break;case 56:s=o.system_architecture;break;case 57:s=o.requirements_specs;break;case 58:s=o.ir_detector;break;case 59:s=o.brick_wall;break;case 60:s=o.flag_au;break;case 61:s=o.flag_us;break;case 62:s=o.flag_jp;break;case 63:s=o.flag_vn;break;case 64:s=o.flag_mv;break;case 65:s=o.flag_it;break;case 66:s=o.flag_fr;break;case 67:s=o.flag_de;break;case 68:s=o.flag_es;break;case 69:s=o.flag_gb;break;case 70:s=o.flag_nl;break;case 71:s=o.flag_ch;break;case 72:s=o.flag_ma;break;case 73:s=o.flag_eg;break;case 74:s=o.main_guy;break;case 75:s=o.flower;break}if(s)t.drawImage(s,i*e,l*e,e,e);else{let r="#90EE90";switch(c){case 0:r="#228B22";break;case 1:r="#8B4513";break;case 6:r="#2C2C2C";break;case 7:r="#D2B48C";break;case 8:r="#8B4513";break;case 9:r="#32CD32";break;case 10:r="#FF6347";break;case 11:r="#A0522D";break;case 12:r="#CD853F";break;case 13:r="#DC143C";break;case 14:r="#654321";break;case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:r="#32CD32";break;case 28:r="#87CEEB";break;case 29:r="#1a202c";break;case 30:r="#ffa500";break;case 31:r="#e91e63";break;case 32:r="#1a202c";break;case 33:r="#3b82f6";break;case 34:r="#06b6d4";break;case 35:r="#86bc25";break;case 36:case 37:r="#f2c811";break;case 38:r="#3776ab";break;case 39:r="#ee4c2c";break;case 40:r="#1a202c";break;case 41:case 42:r="#0078d4";break;case 43:r="#2d3748";break;case 44:r="#1a202c";break;case 45:r="#1a1a1a";break;case 46:r="#1a1a1a";break;case 47:r="#1a1a1a";break;case 48:r="#C8102E";break;case 49:r="#1a1a1a";break;case 50:r="#1a1a1a";break;case 51:r="#1a1a1a";break;case 52:r="#1a1a1a";break;case 53:r="#1a1a1a";break;case 54:r="#1a1a1a";break;case 55:r="#e97627";break;case 56:r="#1a1a1a";break;case 57:r="#1a1a1a";break;case 58:r="#1a1a1a";break;case 59:r="#6e6e6e";break;case 60:r="#012169";break;case 61:r="#b22234";break;case 62:r="#bc002d";break;case 63:r="#da251d";break;case 64:r="#d21034";break;case 65:r="#009246";break;case 66:r="#0055a4";break;case 67:r="#000000";break;case 68:r="#aa151b";break;case 69:r="#012169";break;case 70:r="#21468b";break;case 71:r="#ff0000";break;case 72:r="#c1272d";break;case 73:r="#ce1126";break;case 74:r="#4169e1";break;case 75:r="#ff69b4";break}t.fillStyle=r,t.fillRect(i*e,l*e,e,e)}if((c===1||c===14)&&s){const r=s.naturalHeight||s.height;r>e&&t.drawImage(s,i*e,l*e-(r-e),e,r)}if((c===8||c===28)&&s){const r=s.naturalHeight||s.height;r>e&&t.drawImage(s,i*e,l*e-(r-e),e,r)}if(c===6&&(t.save(),t.globalAlpha=.3,t.fillStyle="#FFD700",t.fillRect(i*e+2,l*e+2,e-4,e-4),t.restore()),c===10&&a.id==="room4"){const r=[o.flag_it,o.flag_fr,o.flag_de,o.flag_us,o.flag_jp,o.flag_au,o.flag_es,o.flag_gb].filter(Boolean);if(r.length>0){const f=(i+l)%r.length,g=r[f];g&&t.drawImage(g,i*e,l*e,e,e)}}}_e(t,e),uo(t,a)}function uo(t,e){if(t.fillStyle="#fff",t.font="bold 18px Arial",t.textAlign="left",t.strokeStyle="#000",t.lineWidth=3,t.strokeText(e.name,15,35),t.fillText(e.name,15,35),e.description&&e.id!=="room1"){t.font="12px Arial",t.fillStyle="#E0E0E0";const o=B-30,a=e.description.split(" ");let n="",l=55;for(let i=0;i<a.length;i++){const c=n+a[i]+" ";t.measureText(c).width>o&&i>0?(t.strokeText(n,15,l),t.fillText(n,15,l),n=a[i]+" ",l+=16):n=c}n&&(t.strokeText(n,15,l),t.fillText(n,15,l))}}console.log("Loading assets...");ne(()=>{console.log("Assets loaded, initializing sprites..."),Bt(),console.log("Initializing room system..."),Pe(),console.log("Initializing boss interaction system..."),Wt(),console.log("Setting up input listeners..."),Qt(),Xt(),console.log("🚀 Starting background AI model preloading..."),console.log("🎮 Game will start immediately while models load in background!"),co(),console.log("Starting game..."),go()});
